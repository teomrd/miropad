import{K as _t,M as vt,P as bt,Q as St,R as wt,S as Lt,T as Et,U as At,V as Tt,W as tt,Y as Ct}from"./chunk-MBS5FVM4.js";import{G as Ot,b as m,j as J,o as Mt}from"./chunk-RKLTPE72.js";import"./chunk-IPLMSLEG.js";function Q(t,n){let o;if(n===void 0)for(let a of t)a!=null&&(o<a||o===void 0&&a>=a)&&(o=a);else{let a=-1;for(let f of t)(f=n(f,++a,t))!=null&&(o<f||o===void 0&&f>=f)&&(o=f)}return o}function W(t,n){let o;if(n===void 0)for(let a of t)a!=null&&(o>a||o===void 0&&a>=a)&&(o=a);else{let a=-1;for(let f of t)(f=n(f,++a,t))!=null&&(o>f||o===void 0&&f>=f)&&(o=f)}return o}function H(t,n){let o=0;if(n===void 0)for(let a of t)(a=+a)&&(o+=a);else{let a=-1;for(let f of t)(f=+n(f,++a,t))&&(o+=f)}return o}function Vt(t){return t.target.depth}function lt(t){return t.depth}function ut(t,n){return n-1-t.height}function K(t,n){return t.sourceLinks.length?t.depth:n-1}function ft(t){return t.targetLinks.length?t.depth:t.sourceLinks.length?W(t.sourceLinks,Vt)-1:0}function Y(t){return function(){return t}}function It(t,n){return et(t.source,n.source)||t.index-n.index}function Nt(t,n){return et(t.target,n.target)||t.index-n.index}function et(t,n){return t.y0-n.y0}function ct(t){return t.value}function Ft(t){return t.index}function Wt(t){return t.nodes}function Ht(t){return t.links}function Pt(t,n){let o=t.get(n);if(!o)throw new Error("missing: "+n);return o}function Rt({nodes:t}){for(let n of t){let o=n.y0,a=o;for(let f of n.sourceLinks)f.y0=o+f.width/2,o+=f.width;for(let f of n.targetLinks)f.y1=a+f.width/2,a+=f.width}}function nt(){let t=0,n=0,o=1,a=1,f=24,p=8,g,k=Ft,r=K,i,l,_=Wt,v=Ht,d=6;function b(){let e={nodes:_.apply(null,arguments),links:v.apply(null,arguments)};return C(e),T(e),M(e),P(e),z(e),Rt(e),e}b.update=function(e){return Rt(e),e},b.nodeId=function(e){return arguments.length?(k=typeof e=="function"?e:Y(e),b):k},b.nodeAlign=function(e){return arguments.length?(r=typeof e=="function"?e:Y(e),b):r},b.nodeSort=function(e){return arguments.length?(i=e,b):i},b.nodeWidth=function(e){return arguments.length?(f=+e,b):f},b.nodePadding=function(e){return arguments.length?(p=g=+e,b):p},b.nodes=function(e){return arguments.length?(_=typeof e=="function"?e:Y(e),b):_},b.links=function(e){return arguments.length?(v=typeof e=="function"?e:Y(e),b):v},b.linkSort=function(e){return arguments.length?(l=e,b):l},b.size=function(e){return arguments.length?(t=n=0,o=+e[0],a=+e[1],b):[o-t,a-n]},b.extent=function(e){return arguments.length?(t=+e[0][0],o=+e[1][0],n=+e[0][1],a=+e[1][1],b):[[t,n],[o,a]]},b.iterations=function(e){return arguments.length?(d=+e,b):d};function C({nodes:e,links:u}){for(let[h,s]of e.entries())s.index=h,s.sourceLinks=[],s.targetLinks=[];let c=new Map(e.map((h,s)=>[k(h,s,e),h]));for(let[h,s]of u.entries()){s.index=h;let{source:x,target:S}=s;typeof x!="object"&&(x=s.source=Pt(c,x)),typeof S!="object"&&(S=s.target=Pt(c,S)),x.sourceLinks.push(s),S.targetLinks.push(s)}if(l!=null)for(let{sourceLinks:h,targetLinks:s}of e)h.sort(l),s.sort(l)}function T({nodes:e}){for(let u of e)u.value=u.fixedValue===void 0?Math.max(H(u.sourceLinks,ct),H(u.targetLinks,ct)):u.fixedValue}function M({nodes:e}){let u=e.length,c=new Set(e),h=new Set,s=0;for(;c.size;){for(let x of c){x.depth=s;for(let{target:S}of x.sourceLinks)h.add(S)}if(++s>u)throw new Error("circular link");c=h,h=new Set}}function P({nodes:e}){let u=e.length,c=new Set(e),h=new Set,s=0;for(;c.size;){for(let x of c){x.height=s;for(let{source:S}of x.targetLinks)h.add(S)}if(++s>u)throw new Error("circular link");c=h,h=new Set}}function B({nodes:e}){let u=Q(e,s=>s.depth)+1,c=(o-t-f)/(u-1),h=new Array(u);for(let s of e){let x=Math.max(0,Math.min(u-1,Math.floor(r.call(null,s,u))));s.layer=x,s.x0=t+x*c,s.x1=s.x0+f,h[x]?h[x].push(s):h[x]=[s]}if(i)for(let s of h)s.sort(i);return h}function $(e){let u=W(e,c=>(a-n-(c.length-1)*g)/H(c,ct));for(let c of e){let h=n;for(let s of c){s.y0=h,s.y1=h+s.value*u,h=s.y1+g;for(let x of s.sourceLinks)x.width=x.value*u}h=(a-h+g)/(c.length+1);for(let s=0;s<c.length;++s){let x=c[s];x.y0+=h*(s+1),x.y1+=h*(s+1)}Z(c)}}function z(e){let u=B(e);g=Math.min(p,(a-n)/(Q(u,c=>c.length)-1)),$(u);for(let c=0;c<d;++c){let h=Math.pow(.99,c),s=Math.max(1-h,(c+1)/d);O(u,h,s),w(u,h,s)}}function w(e,u,c){for(let h=1,s=e.length;h<s;++h){let x=e[h];for(let S of x){let V=0,N=0;for(let{source:L,value:at}of S.targetLinks){let G=at*(S.layer-L.layer);V+=E(L,S)*G,N+=G}if(!(N>0))continue;let D=(V/N-S.y0)*u;S.y0+=D,S.y1+=D,A(S)}i===void 0&&x.sort(et),R(x,c)}}function O(e,u,c){for(let h=e.length,s=h-2;s>=0;--s){let x=e[s];for(let S of x){let V=0,N=0;for(let{target:L,value:at}of S.sourceLinks){let G=at*(L.layer-S.layer);V+=X(S,L)*G,N+=G}if(!(N>0))continue;let D=(V/N-S.y0)*u;S.y0+=D,S.y1+=D,A(S)}i===void 0&&x.sort(et),R(x,c)}}function R(e,u){let c=e.length>>1,h=e[c];y(e,h.y0-g,c-1,u),I(e,h.y1+g,c+1,u),y(e,a,e.length-1,u),I(e,n,0,u)}function I(e,u,c,h){for(;c<e.length;++c){let s=e[c],x=(u-s.y0)*h;x>1e-6&&(s.y0+=x,s.y1+=x),u=s.y1+g}}function y(e,u,c,h){for(;c>=0;--c){let s=e[c],x=(s.y1-u)*h;x>1e-6&&(s.y0-=x,s.y1-=x),u=s.y0-g}}function A({sourceLinks:e,targetLinks:u}){if(l===void 0){for(let{source:{sourceLinks:c}}of u)c.sort(Nt);for(let{target:{targetLinks:c}}of e)c.sort(It)}}function Z(e){if(l===void 0)for(let{sourceLinks:u,targetLinks:c}of e)u.sort(Nt),c.sort(It)}function E(e,u){let c=e.y0-(e.sourceLinks.length-1)*g/2;for(let{target:h,width:s}of e.sourceLinks){if(h===u)break;c+=s+g}for(let{source:h,width:s}of u.targetLinks){if(h===e)break;c-=s}return c}function X(e,u){let c=u.y0-(u.targetLinks.length-1)*g/2;for(let{source:h,width:s}of u.targetLinks){if(h===e)break;c+=s+g}for(let{target:h,width:s}of e.sourceLinks){if(h===u)break;c-=s}return c}return b}var ht=Math.PI,dt=2*ht,F=1e-6,Yt=dt-F;function pt(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function zt(){return new pt}pt.prototype=zt.prototype={constructor:pt,moveTo:function(t,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,n){this._+="L"+(this._x1=+t)+","+(this._y1=+n)},quadraticCurveTo:function(t,n,o,a){this._+="Q"+ +t+","+ +n+","+(this._x1=+o)+","+(this._y1=+a)},bezierCurveTo:function(t,n,o,a,f,p){this._+="C"+ +t+","+ +n+","+ +o+","+ +a+","+(this._x1=+f)+","+(this._y1=+p)},arcTo:function(t,n,o,a,f){t=+t,n=+n,o=+o,a=+a,f=+f;var p=this._x1,g=this._y1,k=o-t,r=a-n,i=p-t,l=g-n,_=i*i+l*l;if(f<0)throw new Error("negative radius: "+f);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=n);else if(_>F)if(!(Math.abs(l*k-r*i)>F)||!f)this._+="L"+(this._x1=t)+","+(this._y1=n);else{var v=o-p,d=a-g,b=k*k+r*r,C=v*v+d*d,T=Math.sqrt(b),M=Math.sqrt(_),P=f*Math.tan((ht-Math.acos((b+_-C)/(2*T*M)))/2),B=P/M,$=P/T;Math.abs(B-1)>F&&(this._+="L"+(t+B*i)+","+(n+B*l)),this._+="A"+f+","+f+",0,0,"+ +(l*v>i*d)+","+(this._x1=t+$*k)+","+(this._y1=n+$*r)}},arc:function(t,n,o,a,f,p){t=+t,n=+n,o=+o,p=!!p;var g=o*Math.cos(a),k=o*Math.sin(a),r=t+g,i=n+k,l=1^p,_=p?a-f:f-a;if(o<0)throw new Error("negative radius: "+o);this._x1===null?this._+="M"+r+","+i:(Math.abs(this._x1-r)>F||Math.abs(this._y1-i)>F)&&(this._+="L"+r+","+i),o&&(_<0&&(_=_%dt+dt),_>Yt?this._+="A"+o+","+o+",0,1,"+l+","+(t-g)+","+(n-k)+"A"+o+","+o+",0,1,"+l+","+(this._x1=r)+","+(this._y1=i):_>F&&(this._+="A"+o+","+o+",0,"+ +(_>=ht)+","+l+","+(this._x1=t+o*Math.cos(f))+","+(this._y1=n+o*Math.sin(f))))},rect:function(t,n,o,a){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)+"h"+ +o+"v"+ +a+"h"+-o+"Z"},toString:function(){return this._}};var yt=zt;function mt(t){return function(){return t}}function Dt(t){return t[0]}function jt(t){return t[1]}var Bt=Array.prototype.slice;function qt(t){return t.source}function Ut(t){return t.target}function Xt(t){var n=qt,o=Ut,a=Dt,f=jt,p=null;function g(){var k,r=Bt.call(arguments),i=n.apply(this,r),l=o.apply(this,r);if(p||(p=k=yt()),t(p,+a.apply(this,(r[0]=i,r)),+f.apply(this,r),+a.apply(this,(r[0]=l,r)),+f.apply(this,r)),k)return p=null,k+""||null}return g.source=function(k){return arguments.length?(n=k,g):n},g.target=function(k){return arguments.length?(o=k,g):o},g.x=function(k){return arguments.length?(a=typeof k=="function"?k:mt(+k),g):a},g.y=function(k){return arguments.length?(f=typeof k=="function"?k:mt(+k),g):f},g.context=function(k){return arguments.length?(p=k??null,g):p},g}function Gt(t,n,o,a,f){t.moveTo(n,o),t.bezierCurveTo(n=(n+a)/2,o,n,f,a,f)}function gt(){return Xt(Gt)}function Jt(t){return[t.source.x1,t.y0]}function Qt(t){return[t.target.x0,t.y1]}function xt(){return gt().source(Jt).target(Qt)}var kt=function(){var t=m(function(k,r,i,l){for(i=i||{},l=k.length;l--;i[k[l]]=r);return i},"o"),n=[1,9],o=[1,10],a=[1,5,10,12],f={trace:m(function(){},"trace"),yy:{},symbols_:{error:2,start:3,SANKEY:4,NEWLINE:5,csv:6,opt_eof:7,record:8,csv_tail:9,EOF:10,"field[source]":11,COMMA:12,"field[target]":13,"field[value]":14,field:15,escaped:16,non_escaped:17,DQUOTE:18,ESCAPED_TEXT:19,NON_ESCAPED_TEXT:20,$accept:0,$end:1},terminals_:{2:"error",4:"SANKEY",5:"NEWLINE",10:"EOF",11:"field[source]",12:"COMMA",13:"field[target]",14:"field[value]",18:"DQUOTE",19:"ESCAPED_TEXT",20:"NON_ESCAPED_TEXT"},productions_:[0,[3,4],[6,2],[9,2],[9,0],[7,1],[7,0],[8,5],[15,1],[15,1],[16,3],[17,1]],performAction:m(function(r,i,l,_,v,d,b){var C=d.length-1;switch(v){case 7:let T=_.findOrCreateNode(d[C-4].trim().replaceAll('""','"')),M=_.findOrCreateNode(d[C-2].trim().replaceAll('""','"')),P=parseFloat(d[C].trim());_.addLink(T,M,P);break;case 8:case 9:case 11:this.$=d[C];break;case 10:this.$=d[C-1];break}},"anonymous"),table:[{3:1,4:[1,2]},{1:[3]},{5:[1,3]},{6:4,8:5,15:6,16:7,17:8,18:n,20:o},{1:[2,6],7:11,10:[1,12]},t(o,[2,4],{9:13,5:[1,14]}),{12:[1,15]},t(a,[2,8]),t(a,[2,9]),{19:[1,16]},t(a,[2,11]),{1:[2,1]},{1:[2,5]},t(o,[2,2]),{6:17,8:5,15:6,16:7,17:8,18:n,20:o},{15:18,16:7,17:8,18:n,20:o},{18:[1,19]},t(o,[2,3]),{12:[1,20]},t(a,[2,10]),{15:21,16:7,17:8,18:n,20:o},t([1,5,10],[2,7])],defaultActions:{11:[2,1],12:[2,5]},parseError:m(function(r,i){if(i.recoverable)this.trace(r);else{var l=new Error(r);throw l.hash=i,l}},"parseError"),parse:m(function(r){var i=this,l=[0],_=[],v=[null],d=[],b=this.table,C="",T=0,M=0,P=0,B=2,$=1,z=d.slice.call(arguments,1),w=Object.create(this.lexer),O={yy:{}};for(var R in this.yy)Object.prototype.hasOwnProperty.call(this.yy,R)&&(O.yy[R]=this.yy[R]);w.setInput(r,O.yy),O.yy.lexer=w,O.yy.parser=this,typeof w.yylloc>"u"&&(w.yylloc={});var I=w.yylloc;d.push(I);var y=w.options&&w.options.ranges;typeof O.yy.parseError=="function"?this.parseError=O.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function A(L){l.length=l.length-2*L,v.length=v.length-L,d.length=d.length-L}m(A,"popStack");function Z(){var L;return L=_.pop()||w.lex()||$,typeof L!="number"&&(L instanceof Array&&(_=L,L=_.pop()),L=i.symbols_[L]||L),L}m(Z,"lex");for(var E,X,e,u,c,h,s={},x,S,V,N;;){if(e=l[l.length-1],this.defaultActions[e]?u=this.defaultActions[e]:((E===null||typeof E>"u")&&(E=Z()),u=b[e]&&b[e][E]),typeof u>"u"||!u.length||!u[0]){var D="";N=[];for(x in b[e])this.terminals_[x]&&x>B&&N.push("'"+this.terminals_[x]+"'");w.showPosition?D="Parse error on line "+(T+1)+`:
`+w.showPosition()+`
Expecting `+N.join(", ")+", got '"+(this.terminals_[E]||E)+"'":D="Parse error on line "+(T+1)+": Unexpected "+(E==$?"end of input":"'"+(this.terminals_[E]||E)+"'"),this.parseError(D,{text:w.match,token:this.terminals_[E]||E,line:w.yylineno,loc:I,expected:N})}if(u[0]instanceof Array&&u.length>1)throw new Error("Parse Error: multiple actions possible at state: "+e+", token: "+E);switch(u[0]){case 1:l.push(E),v.push(w.yytext),d.push(w.yylloc),l.push(u[1]),E=null,X?(E=X,X=null):(M=w.yyleng,C=w.yytext,T=w.yylineno,I=w.yylloc,P>0&&P--);break;case 2:if(S=this.productions_[u[1]][1],s.$=v[v.length-S],s._$={first_line:d[d.length-(S||1)].first_line,last_line:d[d.length-1].last_line,first_column:d[d.length-(S||1)].first_column,last_column:d[d.length-1].last_column},y&&(s._$.range=[d[d.length-(S||1)].range[0],d[d.length-1].range[1]]),h=this.performAction.apply(s,[C,M,T,O.yy,u[1],v,d].concat(z)),typeof h<"u")return h;S&&(l=l.slice(0,-1*S*2),v=v.slice(0,-1*S),d=d.slice(0,-1*S)),l.push(this.productions_[u[1]][0]),v.push(s.$),d.push(s._$),V=b[l[l.length-2]][l[l.length-1]],l.push(V);break;case 3:return!0}}return!0},"parse")},p=function(){var k={EOF:1,parseError:m(function(i,l){if(this.yy.parser)this.yy.parser.parseError(i,l);else throw new Error(i)},"parseError"),setInput:m(function(r,i){return this.yy=i||this.yy||{},this._input=r,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},"setInput"),input:m(function(){var r=this._input[0];this.yytext+=r,this.yyleng++,this.offset++,this.match+=r,this.matched+=r;var i=r.match(/(?:\r\n?|\n).*/g);return i?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),r},"input"),unput:m(function(r){var i=r.length,l=r.split(/(?:\r\n?|\n)/g);this._input=r+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-i),this.offset-=i;var _=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),l.length-1&&(this.yylineno-=l.length-1);var v=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:l?(l.length===_.length?this.yylloc.first_column:0)+_[_.length-l.length].length-l[0].length:this.yylloc.first_column-i},this.options.ranges&&(this.yylloc.range=[v[0],v[0]+this.yyleng-i]),this.yyleng=this.yytext.length,this},"unput"),more:m(function(){return this._more=!0,this},"more"),reject:m(function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},"reject"),less:m(function(r){this.unput(this.match.slice(r))},"less"),pastInput:m(function(){var r=this.matched.substr(0,this.matched.length-this.match.length);return(r.length>20?"...":"")+r.substr(-20).replace(/\n/g,"")},"pastInput"),upcomingInput:m(function(){var r=this.match;return r.length<20&&(r+=this._input.substr(0,20-r.length)),(r.substr(0,20)+(r.length>20?"...":"")).replace(/\n/g,"")},"upcomingInput"),showPosition:m(function(){var r=this.pastInput(),i=new Array(r.length+1).join("-");return r+this.upcomingInput()+`
`+i+"^"},"showPosition"),test_match:m(function(r,i){var l,_,v;if(this.options.backtrack_lexer&&(v={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(v.yylloc.range=this.yylloc.range.slice(0))),_=r[0].match(/(?:\r\n?|\n).*/g),_&&(this.yylineno+=_.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:_?_[_.length-1].length-_[_.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+r[0].length},this.yytext+=r[0],this.match+=r[0],this.matches=r,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(r[0].length),this.matched+=r[0],l=this.performAction.call(this,this.yy,this,i,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),l)return l;if(this._backtrack){for(var d in v)this[d]=v[d];return!1}return!1},"test_match"),next:m(function(){if(this.done)return this.EOF;this._input||(this.done=!0);var r,i,l,_;this._more||(this.yytext="",this.match="");for(var v=this._currentRules(),d=0;d<v.length;d++)if(l=this._input.match(this.rules[v[d]]),l&&(!i||l[0].length>i[0].length)){if(i=l,_=d,this.options.backtrack_lexer){if(r=this.test_match(l,v[d]),r!==!1)return r;if(this._backtrack){i=!1;continue}else return!1}else if(!this.options.flex)break}return i?(r=this.test_match(i,v[_]),r!==!1?r:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},"next"),lex:m(function(){var i=this.next();return i||this.lex()},"lex"),begin:m(function(i){this.conditionStack.push(i)},"begin"),popState:m(function(){var i=this.conditionStack.length-1;return i>0?this.conditionStack.pop():this.conditionStack[0]},"popState"),_currentRules:m(function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},"_currentRules"),topState:m(function(i){return i=this.conditionStack.length-1-Math.abs(i||0),i>=0?this.conditionStack[i]:"INITIAL"},"topState"),pushState:m(function(i){this.begin(i)},"pushState"),stateStackSize:m(function(){return this.conditionStack.length},"stateStackSize"),options:{"case-insensitive":!0},performAction:m(function(i,l,_,v){var d=v;switch(_){case 0:return this.pushState("csv"),4;break;case 1:return this.pushState("csv"),4;break;case 2:return 10;case 3:return 5;case 4:return 12;case 5:return this.pushState("escaped_text"),18;break;case 6:return 20;case 7:return this.popState("escaped_text"),18;break;case 8:return 19}},"anonymous"),rules:[/^(?:sankey-beta\b)/i,/^(?:sankey\b)/i,/^(?:$)/i,/^(?:((\u000D\u000A)|(\u000A)))/i,/^(?:(\u002C))/i,/^(?:(\u0022))/i,/^(?:([\u0020-\u0021\u0023-\u002B\u002D-\u007E])*)/i,/^(?:(\u0022)(?!(\u0022)))/i,/^(?:(([\u0020-\u0021\u0023-\u002B\u002D-\u007E])|(\u002C)|(\u000D)|(\u000A)|(\u0022)(\u0022))*)/i],conditions:{csv:{rules:[2,3,4,5,6,7,8],inclusive:!1},escaped_text:{rules:[7,8],inclusive:!1},INITIAL:{rules:[0,1,2,3,4,5,6,7,8],inclusive:!0}}};return k}();f.lexer=p;function g(){this.yy={}}return m(g,"Parser"),g.prototype=f,f.Parser=g,new g}();kt.parser=kt;var rt=kt,st=[],it=[],ot=new Map,Kt=m(()=>{st=[],it=[],ot=new Map,bt()},"clear"),q,Zt=(q=class{constructor(n,o,a=0){this.source=n,this.target=o,this.value=a}},m(q,"SankeyLink"),q),te=m((t,n,o)=>{st.push(new Zt(t,n,o))},"addLink"),U,ee=(U=class{constructor(n){this.ID=n}},m(U,"SankeyNode"),U),ne=m(t=>{t=_t.sanitizeText(t,tt());let n=ot.get(t);return n===void 0&&(n=new ee(t),ot.set(t,n),it.push(n)),n},"findOrCreateNode"),re=m(()=>it,"getNodes"),oe=m(()=>st,"getLinks"),se=m(()=>({nodes:it.map(t=>({id:t.ID})),links:st.map(t=>({source:t.source.ID,target:t.target.ID,value:t.value}))}),"getGraph"),ie={nodesMap:ot,getConfig:m(()=>tt().sankey,"getConfig"),getNodes:re,getLinks:oe,getGraph:se,addLink:te,findOrCreateNode:ne,getAccTitle:wt,setAccTitle:St,getAccDescription:Et,setAccDescription:Lt,getDiagramTitle:Tt,setDiagramTitle:At,clear:Kt},j,$t=(j=class{static next(n){return new j(n+ ++j.count)}constructor(n){this.id=n,this.href=`#${n}`}toString(){return"url("+this.href+")"}},m(j,"Uid"),j.count=0,j),ae={left:lt,right:ut,center:ft,justify:K},le=m(function(t,n,o,a){let{securityLevel:f,sankey:p}=tt(),g=Ct.sankey,k;f==="sandbox"&&(k=J("#i"+n));let r=f==="sandbox"?J(k.nodes()[0].contentDocument.body):J("body"),i=f==="sandbox"?r.select(`[id="${n}"]`):J(`[id="${n}"]`),l=(p==null?void 0:p.width)??g.width,_=(p==null?void 0:p.height)??g.width,v=(p==null?void 0:p.useMaxWidth)??g.useMaxWidth,d=(p==null?void 0:p.nodeAlignment)??g.nodeAlignment,b=(p==null?void 0:p.prefix)??g.prefix,C=(p==null?void 0:p.suffix)??g.suffix,T=(p==null?void 0:p.showValues)??g.showValues,M=a.db.getGraph(),P=ae[d];nt().nodeId(y=>y.id).nodeWidth(10).nodePadding(10+(T?15:0)).nodeAlign(P).extent([[0,0],[l,_]])(M);let z=Mt(Ot);i.append("g").attr("class","nodes").selectAll(".node").data(M.nodes).join("g").attr("class","node").attr("id",y=>(y.uid=$t.next("node-")).id).attr("transform",function(y){return"translate("+y.x0+","+y.y0+")"}).attr("x",y=>y.x0).attr("y",y=>y.y0).append("rect").attr("height",y=>y.y1-y.y0).attr("width",y=>y.x1-y.x0).attr("fill",y=>z(y.id));let w=m(({id:y,value:A})=>T?`${y}
${b}${Math.round(A*100)/100}${C}`:y,"getText");i.append("g").attr("class","node-labels").attr("font-size",14).selectAll("text").data(M.nodes).join("text").attr("x",y=>y.x0<l/2?y.x1+6:y.x0-6).attr("y",y=>(y.y1+y.y0)/2).attr("dy",`${T?"0":"0.35"}em`).attr("text-anchor",y=>y.x0<l/2?"start":"end").text(w);let O=i.append("g").attr("class","links").attr("fill","none").attr("stroke-opacity",.5).selectAll(".link").data(M.links).join("g").attr("class","link").style("mix-blend-mode","multiply"),R=(p==null?void 0:p.linkColor)??"gradient";if(R==="gradient"){let y=O.append("linearGradient").attr("id",A=>(A.uid=$t.next("linearGradient-")).id).attr("gradientUnits","userSpaceOnUse").attr("x1",A=>A.source.x1).attr("x2",A=>A.target.x0);y.append("stop").attr("offset","0%").attr("stop-color",A=>z(A.source.id)),y.append("stop").attr("offset","100%").attr("stop-color",A=>z(A.target.id))}let I;switch(R){case"gradient":I=m(y=>y.uid,"coloring");break;case"source":I=m(y=>z(y.source.id),"coloring");break;case"target":I=m(y=>z(y.target.id),"coloring");break;default:I=R}O.append("path").attr("d",xt()).attr("stroke",I).attr("stroke-width",y=>Math.max(1,y.width)),vt(void 0,i,0,v)},"draw"),ue={draw:le},fe=m(t=>t.replaceAll(/^[^\S\n\r]+|[^\S\n\r]+$/g,"").replaceAll(/([\n\r])+/g,`
`).trim(),"prepareTextForParsing"),ce=m(t=>`.label {
      font-family: ${t.fontFamily};
    }`,"getStyles"),he=ce,de=rt.parse.bind(rt);rt.parse=t=>de(fe(t));var Ze={styles:he,parser:rt,db:ie,renderer:ue};export{Ze as diagram};
