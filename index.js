import{a as hr}from"./chunk-O6K42FSI.js";import{a as Fn}from"./chunk-SFY74CKZ.js";import{a as Nn,b as En}from"./chunk-LUVVOBMV.js";import{a as Bn}from"./chunk-2QN55WGH.js";import"./chunk-QMX6DSRS.js";import"./chunk-U7JUGVPM.js";import"./chunk-DZ3GRGYJ.js";import"./chunk-SRM5CHDV.js";import{b as In}from"./chunk-YW5DPG3L.js";import{a as zn}from"./chunk-SO7LSWKM.js";import{b as Pn,j as lr,l as Dn,m as It,n as Ln,o as On}from"./chunk-MGXIVZEI.js";import"./chunk-TSL5KNHW.js";import{A as Cn,B as cr,C as Sn,D as Et,E as _n,F as Yt,I as Tn,O as An,Q as Mn,ca as Jt,da as he,g as gn,h as w,ia as gt,j as H,k as nr,l as bn,n as wn,o as or,p as ir,q as sr,r as yn,s as vn,u as de,x as ar,y as xn,z as kn}from"./chunk-HJPNRYHP.js";import{d as dr}from"./chunk-EQENVWAF.js";import"./chunk-FFNH7GCV.js";import{a as tt,d as mn,e as F}from"./chunk-OHVK2FCB.js";var jt=tt(Ce=>{"use strict";Object.defineProperty(Ce,"__esModule",{value:!0});Ce.Warning=void 0;var Sr=class{constructor(t,r){this.message=t,typeof r=="number"?this.offset=r:r&&"line"in r&&(this.sourceLoc=r,this.offset=r.offset)}render(){let t=this.message;return this.sourceLoc?t+=` at line ${this.sourceLoc.line}, col ${this.sourceLoc.col}`:this.offset&&(t+=` at offset ${this.offset}`),t}};Ce.Warning=Sr});var Tr=tt(Se=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});Se.AttributeParser=void 0;var A;(function(e){e[e.SCANNING=0]="SCANNING",e[e.SCANNING_ID=1]="SCANNING_ID",e[e.SCANNING_CLASS=2]="SCANNING_CLASS",e[e.SCANNING_KEY=3]="SCANNING_KEY",e[e.SCANNING_VALUE=4]="SCANNING_VALUE",e[e.SCANNING_BARE_VALUE=5]="SCANNING_BARE_VALUE",e[e.SCANNING_QUOTED_VALUE=6]="SCANNING_QUOTED_VALUE",e[e.SCANNING_QUOTED_VALUE_CONTINUATION=7]="SCANNING_QUOTED_VALUE_CONTINUATION",e[e.SCANNING_ESCAPED=8]="SCANNING_ESCAPED",e[e.SCANNING_ESCAPED_IN_CONTINUATION=9]="SCANNING_ESCAPED_IN_CONTINUATION",e[e.SCANNING_COMMENT=10]="SCANNING_COMMENT",e[e.FAIL=11]="FAIL",e[e.DONE=12]="DONE",e[e.START=13]="START"})(A||(A={}));var Va=/^[a-zA-Z0-9_:-]/,qa=function(e){return Va.exec(e)!==null},Q=[];Q[A.START]=function(e,t){return e.subject.charAt(t)==="{"?A.SCANNING:A.FAIL};Q[A.FAIL]=function(e,t){return A.FAIL};Q[A.DONE]=function(e,t){return A.DONE};Q[A.SCANNING]=function(e,t){let r=e.subject.charAt(t);return r===`
`||r==="\r"?A.SCANNING:r===" "||r==="	"?(e.addEvent(t,t,"attr_space"),A.SCANNING):r==="}"?A.DONE:r==="#"?(e.begin=t,e.addEvent(t,t,"attr_id_marker"),A.SCANNING_ID):r==="%"?(e.begin=t,A.SCANNING_COMMENT):r==="."?(e.begin=t,e.addEvent(t,t,"attr_class_marker"),A.SCANNING_CLASS):qa(r)?(e.begin=t,A.SCANNING_KEY):A.FAIL};Q[A.SCANNING_COMMENT]=function(e,t){let r=e.subject.charAt(t);return r==="%"?(e.begin&&t>e.begin&&e.addEvent(e.begin,t,"comment"),A.SCANNING):r=="}"?A.DONE:A.SCANNING_COMMENT};Q[A.SCANNING_ID]=function(e,t){let r=e.subject.charAt(t);return/^[^\]\[~!@#$%^&*(){}`,.<>\\|=+/?\s]/.exec(r)!==null?A.SCANNING_ID:r==="}"?(e.begin&&e.lastpos&&e.lastpos>e.begin&&e.addEvent(e.begin+1,e.lastpos,"id"),e.begin=null,A.DONE):/^\s/.exec(r)!==null?(e.begin&&e.lastpos&&e.lastpos>e.begin&&e.addEvent(e.begin+1,e.lastpos,"id"),r==="\r"||r===`
`||e.addEvent(t,t,"attr_space"),e.begin=null,A.SCANNING):A.FAIL};Q[A.SCANNING_CLASS]=function(e,t){let r=e.subject.charAt(t);return/^\w/.exec(r)!==null||r==="_"||r==="-"||r===":"?A.SCANNING_CLASS:r==="}"?(e.begin&&e.lastpos&&e.lastpos>e.begin&&e.addEvent(e.begin+1,e.lastpos,"class"),e.begin=null,A.DONE):/^\s/.exec(r)!==null?(e.begin&&e.lastpos&&e.lastpos>e.begin&&e.addEvent(e.begin+1,e.lastpos,"class"),r==="\r"||r===`
`||e.addEvent(t,t,"attr_space"),e.begin=null,A.SCANNING):A.FAIL};Q[A.SCANNING_KEY]=function(e,t){let r=e.subject.charAt(t);return r==="="&&e.begin&&e.lastpos?(e.addEvent(e.begin,e.lastpos,"key"),e.addEvent(t,t,"attr_equal_marker"),e.begin=null,A.SCANNING_VALUE):/^[a-zA-Z0-9_:-]/.exec(r)!==null?A.SCANNING_KEY:A.FAIL};Q[A.SCANNING_VALUE]=function(e,t){let r=e.subject.charAt(t);return r==='"'?(e.begin=t,e.addEvent(t,t,"attr_quote_marker"),A.SCANNING_QUOTED_VALUE):/^[a-zA-Z0-9_:-]/.exec(r)!==null?(e.begin=t,A.SCANNING_BARE_VALUE):A.FAIL};Q[A.SCANNING_BARE_VALUE]=function(e,t){let r=e.subject.charAt(t);return/^[a-zA-Z0-9_:-]/.exec(r)!==null?A.SCANNING_BARE_VALUE:r==="}"&&e.begin&&e.lastpos?(e.addEvent(e.begin,e.lastpos,"value"),e.begin=null,A.DONE):/^\s/.exec(r)&&e.begin&&e.lastpos?(e.addEvent(e.begin,e.lastpos,"value"),r==="\r"||r===`
`||e.addEvent(t,t,"attr_space"),e.begin=null,A.SCANNING):A.FAIL};Q[A.SCANNING_ESCAPED]=function(e,t){return A.SCANNING_QUOTED_VALUE};Q[A.SCANNING_ESCAPED_IN_CONTINUATION]=function(e,t){return A.SCANNING_QUOTED_VALUE_CONTINUATION};Q[A.SCANNING_QUOTED_VALUE]=function(e,t){let r=e.subject.charAt(t);return r==='"'&&e.begin&&e.lastpos?(e.addEvent(e.begin+1,e.lastpos,"value"),e.addEvent(t,t,"attr_quote_marker"),e.begin=null,A.SCANNING):r===`
`&&e.begin&&e.lastpos?(e.addEvent(e.begin+1,t,"value"),e.begin=null,A.SCANNING_QUOTED_VALUE_CONTINUATION):r==="\\"?A.SCANNING_ESCAPED:A.SCANNING_QUOTED_VALUE};Q[A.SCANNING_QUOTED_VALUE_CONTINUATION]=function(e,t){let r=e.subject.charAt(t);return e.begin===null&&(e.begin=t),r==='"'&&e.begin&&e.lastpos?(e.addEvent(t,t,"attr_quote_marker"),e.addEvent(e.begin,e.lastpos,"value"),e.begin=null,A.SCANNING):r===`
`&&e.begin&&e.lastpos?(e.addEvent(e.begin,t,"value"),e.begin=null,A.SCANNING_QUOTED_VALUE_CONTINUATION):r==="\\"?A.SCANNING_ESCAPED_IN_CONTINUATION:A.SCANNING_QUOTED_VALUE_CONTINUATION};var _r=class{constructor(t){this.subject=t,this.state=A.START,this.begin=null,this.lastpos=null,this.matches=[]}addEvent(t,r,n){this.matches.push({startpos:t,endpos:r,annot:n})}feed(t,r){let n=t;for(;n<=r;){if(this.state=Q[this.state](this,n),this.state===A.DONE)return{status:"done",position:n};if(this.state===A.FAIL)return this.lastpos=n,{status:"fail",position:n};this.lastpos=n,n=n+1}return{status:"continue",position:r}}};Se.AttributeParser=_r});var Ar=tt($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.find=$t.pattern=void 0;var Wa=function(e){return new RegExp(e,"yd")};$t.pattern=Wa;var Ha=function(e,t,r,n){t.lastIndex=r;let o;n!==void 0?o=e.substring(0,n+1):o=e;let i=t.exec(o);if(i!==null){let s=1,c=[];if(i.indices.length>1)for(let l=1;l<i.indices.length;l++){let[d,m]=i.indices[l];c.push(o.substring(d,m))}return{startpos:i.indices[0][0],endpos:i.indices[0][1]-1,captures:c}}else return null};$t.find=Ha});var Do=tt(Ae=>{"use strict";Object.defineProperty(Ae,"__esModule",{value:!0});Ae.InlineParser=void 0;var Ya=Tr(),Ja=jt(),G=Ar(),To=9,Lr=10,Or=13,Mr=32,Ao=33,Mo=34,No=39,Nr=40,Ka=41,Xa=42,Qa=43,Er=45,Za=46,tc=58,ec=60,rc=61,Ir=91,Pr=92,nc=93,oc=94,ic=95,sc=96,_e=123,Te=125,ac=126,Eo=/[\r\n"'()*+.:<=[\\\]^_`${}~-]/g,Io=function(e,t,r){Eo.lastIndex=t;let n=Eo.exec(e);return n&&n.index<=r?n.index:null},Po=(0,G.pattern)(`[^ 	\r
]`),cc=(0,G.pattern)("[ \\t]*\\r?\\n"),lc=(0,G.pattern)("['!\"#$%&\\\\'()\\*+,\\-\\.\\/:;<=>?@\\[\\]\\^_`{|}~']"),dc=(0,G.pattern)("\\<([^<>\\s]+)\\>"),hc=(0,G.pattern)(`[_*~^+='"-]`),uc=(0,G.pattern)(":[\\w_+-]+:"),pc=(0,G.pattern)("\\.\\."),fc=(0,G.pattern)("`*"),mc=(0,G.pattern)("`+"),gc=(0,G.pattern)("\\$\\$"),bc=(0,G.pattern)("\\$"),wc=(0,G.pattern)("\\\\"),yc=(0,G.pattern)("\\{=[^\\s{}`]+\\}"),vc=(0,G.pattern)("\\^([^\\]]+)\\]"),Dr=function(e,t){return t>0&&e.subject.codePointAt(t-1)===_e||e.subject.codePointAt(t+1)===Te},re=function(){return!0},yt=function(e,t,r,n){return function(o,i,s){let c=o.subject,l=(0,G.find)(c,Po,i+1)!==null&&n(o,i),d=(0,G.find)(c,Po,i-1)!==null,m=o.matches[o.matches.length-1],y=m&&m.annot==="open_marker",C=i+1<=s&&c.codePointAt(i+1)===Te,P=i,N=i;y&&(l=!0,d=!1,N=i-1),!y&&C&&(d=!0,l=!1,P=i+1),y&&r.match(/^right/)?r=r.replace(/^right/,"left"):C&&r.match(/^left/)&&(r=r.replace(/^left/,"right"));let E=e;C&&(E="{"+E);let _=o.openers[E];if(d&&_&&_.length>0){let x=_[_.length-1];if(x.endpos!==i-1)return o.clearOpeners(x.startpos,i),o.addMatch(x.startpos,x.endpos,"+"+t,x.matchIndex),o.addMatch(i,P,"-"+t),P+1}if(l){let x=e;return y&&(x="{"+x),o.addOpener(x,N,i,r),i+1}else return o.addMatch(i,P,r),P+1}},xc={[sc]:function(e,t,r){let n=e.subject,o=(0,G.find)(n,fc,t,r);if(o===null)return null;let i=o.endpos;return(0,G.find)(n,gc,t-2)&&!(0,G.find)(n,wc,t-3)?(e.matches.pop(),e.matches.pop(),e.addMatch(t-2,i,"+display_math"),e.verbatimType="display_math"):(0,G.find)(n,bc,t-1)?(e.matches.pop(),e.addMatch(t-1,i,"+inline_math"),e.verbatimType="inline_math"):(e.addMatch(t,i,"+verbatim"),e.verbatimType="verbatim"),e.verbatim=i-t+1,i+1},[Pr]:function(e,t,r){let n=e.subject,o=(0,G.find)(n,cc,t+1,r);if(o!==null){if(e.matches.length>0){let i=e.matches[e.matches.length-1];if(i.annot==="str"){let s=i.endpos,c=i.startpos;for(;s>=c&&(n.codePointAt(s)===Mr||n.codePointAt(s)===To);)s=s-1;s<c?e.matches.pop():i.endpos=s}}return e.addMatch(t,t,"escape"),e.addMatch(t+1,o.endpos,"hard_break"),o.endpos+1}else{let i=(0,G.find)(n,lc,t+1,r);return i!==null?(e.addMatch(t,t,"escape"),e.addMatch(i.startpos,i.endpos,"str"),i.endpos+1):t+1<=r&&n.codePointAt(t+1)===Mr?(e.addMatch(t,t,"escape"),e.addMatch(t+1,t+1,"non_breaking_space"),t+2):(e.addMatch(t,t,"str"),t+1)}},[ec]:function(e,t,r){let n=e.subject,o=(0,G.find)(n,dc,t,r);if(o===null)return null;let i=o.endpos,s=o.startpos,c=o.captures[0];return c.match(/[^:]@/)?(e.addMatch(s,s,"+email"),e.addMatch(s+1,i-1,"str"),e.addMatch(i,i,"-email"),i+1):c.match(/[a-zA-Z]:/)?(e.addMatch(s,s,"+url"),e.addMatch(s+1,i-1,"str"),e.addMatch(i,i,"-url"),i+1):null},[ac]:yt("~","subscript","str",re),[oc]:yt("^","superscript","str",re),[ic]:yt("_","emph","str",re),[Xa]:yt("*","strong","str",re),[Qa]:yt("+","insert","str",Dr),[rc]:yt("=","mark","str",Dr),[No]:yt("'","single_quoted","right_single_quote",function(e,t){if(t===0)return!0;{let r=e.subject.codePointAt(t-1);return r===Mr||r===To||r===Or||r===Lr||r===Mo||r===No||r===Er||r===Nr||r===Ir}}),[Mo]:yt('"',"double_quoted","left_double_quote",re),[_e]:function(e,t,r){return(0,G.find)(e.subject,hc,t+1,r)?(e.addMatch(t,t,"open_marker"),t+1):e.allowAttributes?(e.attributeParser=new Ya.AttributeParser(e.subject),e.attributeStart=t,e.attributeSlices=[],t):(e.addMatch(t,t,"str"),t+1)},[tc]:function(e,t,r){let n=(0,G.find)(e.subject,uc,t,r);return n?(e.addMatch(n.startpos,n.endpos,"symb"),n.endpos+1):(e.addMatch(t,t,"str"),t+1)},[Za]:function(e,t,r){return(0,G.find)(e.subject,pc,t+1,r)?(e.addMatch(t,t+2,"ellipses"),t+3):null},[Ir]:function(e,t,r){let n=(0,G.find)(e.subject,vc,t+1,r);return n?(e.addMatch(t,n.endpos,"footnote_reference"),n.endpos+1):(e.addOpener("[",t,t,"str"),t+1)},[nc]:function(e,t,r){let n=e.openers["["],o=e.subject;if(n&&n.length>0){let i=n[n.length-1];if(i.annot==="reference_link")return e.strMatches((i.subendpos||i.endpos)+1,t-1),o.codePointAt(i.startpos-1)===Ao&&o.codePointAt(i.startpos-2)!==Pr?(e.addMatch(i.startpos-1,i.startpos-1,"image_marker",i.matchIndex-1),e.addMatch(i.startpos,i.endpos,"+imagetext",i.matchIndex),e.addMatch(i.substartpos||i.startpos,i.substartpos||i.startpos,"-imagetext",i.subMatchIndex)):(e.addMatch(i.startpos,i.endpos,"+linktext",i.matchIndex),e.addMatch(i.substartpos||i.startpos,i.substartpos||i.startpos,"-linktext",i.subMatchIndex)),e.addMatch(i.subendpos||i.endpos,i.subendpos||i.endpos,"+reference",i.subMatchIndex+1),e.addMatch(t,t,"-reference"),e.clearOpeners(i.startpos,t),t+1;if(t+1<=r&&o.codePointAt(t+1)===Ir)return i.annot="reference_link",e.addMatch(t,t,"str"),i.subMatchIndex=e.matches.length-1,e.addMatch(t+1,t+1,"str"),i.substartpos=t,i.subendpos=t+1,e.clearOpeners(i.startpos+1,t-1),t+2;if(t+1<=r&&o.codePointAt(t+1)===Nr)return e.openers["("]=[],i.annot="explicit_link",e.addMatch(t,t,"str"),i.subMatchIndex=e.matches.length-1,e.addMatch(t+1,t+1,"str"),i.substartpos=t,i.subendpos=t+1,e.destination=!0,e.clearOpeners(i.startpos+1,t-1),t+2;if(t+1<=r&&o.codePointAt(t+1)===_e)return e.addMatch(i.startpos,i.endpos,"+span",i.matchIndex),e.addMatch(t,t,"-span"),e.clearOpeners(i.startpos,t),t+1}return null},[Nr]:function(e,t,r){return e.destination?(e.addOpener("(",t,t,"str"),t+1):null},[Ka]:function(e,t,r){if(!e.destination)return null;let n=e.openers["("];if(n&&n.length>0)return n.pop(),e.addMatch(t,t,"str"),t+1;{let o=e.subject,i=e.openers["["],s=i[i.length-1];if(i&&i.length>0&&s.annot==="explicit_link")return e.strMatches((s.subendpos||s.endpos)+1,t-1),o.codePointAt(s.startpos-1)===Ao&&o.codePointAt(s.startpos-2)!==Pr?(e.addMatch(s.startpos-1,s.startpos-1,"image_marker",s.matchIndex-1),e.addMatch(s.startpos,s.endpos,"+imagetext",s.matchIndex),e.addMatch(s.substartpos||s.startpos,s.substartpos||s.startpos,"-imagetext",s.subMatchIndex)):(e.addMatch(s.startpos,s.endpos,"+linktext",s.matchIndex),e.addMatch(s.substartpos||s.startpos,s.substartpos||s.startpos,"-linktext",s.subMatchIndex)),e.addMatch(s.subendpos||s.endpos,s.subendpos||s.endpos,"+destination",s.subMatchIndex+1),e.addMatch(t,t,"-destination"),e.destination=!1,e.clearOpeners(s.startpos,t),t+1}return null},[Er]:function(e,t,r){let n=e.subject;if(n.codePointAt(t-1)===_e||n.codePointAt(t+1)===Te){let l=yt("-","delete","str",Dr)(e,t,r);if(l)return l}let o=t,i=0;for(;o<=r&&n.codePointAt(o)===Er;)o++,i++;if(n.codePointAt(o)===Te&&i--,i===0)return e.addMatch(t,t+1,"str"),t+2;let s=i%3===0,c=i%2===0;for(;i>0;)s?(e.addMatch(t,t+2,"em_dash"),t=t+3,i=i-3):c?(e.addMatch(t,t+1,"en_dash"),t=t+2,i=i-2):i>=3&&(i%2!==0||i>4)?(e.addMatch(t,t+2,"em_dash"),t=t+3,i=i-3):i>=2?(e.addMatch(t,t+1,"en_dash"),t=t+2,i=i-2):(e.addMatch(t,t,"str"),t=t+1,i=i-1);return t}},zr=class{constructor(t,r={}){this.options=r,this.warn=r.warn||(()=>{}),this.subject=t,this.matches=[],this.openers={},this.verbatim=0,this.verbatimType="",this.destination=!1,this.firstpos=-1,this.lastpos=0,this.allowAttributes=!0,this.attributeParser=null,this.attributeStart=null,this.attributeSlices=null,this.matchers=xc}addMatch(t,r,n,o){let i={startpos:t,endpos:r,annot:n};o!==void 0?this.matches.splice(o,1,i):this.matches.push(i)}inVerbatim(){return this.verbatim>0}singleChar(t){return this.addMatch(t,t,"str"),t+1}reparseAttributes(){let t=this.attributeSlices;if(t!==null){if(this.allowAttributes=!1,this.attributeParser=null,this.attributeStart=null,t!==null)for(let r of t)this.feed(r.startpos,r.endpos);this.allowAttributes=!0,this.attributeSlices=null}}getMatches(){let t=this.subject;this.attributeParser&&this.reparseAttributes();let r=this.matches.length-1;if(this.matches[r]&&this.matches[r].annot==="soft_break"){this.matches.pop();let n=this.matches[this.matches.length-1];if(n&&n.annot==="str"&&t.codePointAt(n.endpos)===32){for(;n.endpos>=n.startpos&&t.codePointAt(n.endpos)===32;)n.endpos=n.endpos-1;n.endpos<n.startpos&&this.matches.pop()}}if(this.matches.length>0&&this.verbatim>0){let n=this.matches[this.matches.length-1];this.warn(new Ja.Warning("Unclosed verbatim",n.endpos)),this.matches.push({startpos:n.endpos,endpos:n.endpos,annot:"-"+this.verbatimType})}return this.matches}addOpener(t,r,n,o){this.openers[t]||(this.openers[t]=[]),this.openers[t].push({matchIndex:this.matches.length,startpos:r,endpos:n,annot:null,subMatchIndex:this.matches.length,substartpos:null,subendpos:null}),this.addMatch(r,n,o)}clearOpeners(t,r){for(let n in this.openers){let o=this.openers[n],i=o.length-1;for(;o[i];){let s=o[i];if(s.startpos>=t&&s.endpos<=r)o.splice(i,1);else if(s.substartpos&&s.substartpos>=t&&s.subendpos&&s.subendpos<=r)o[i].substartpos=null,o[i].subendpos=null,o[i].annot=null;else break;i--}}}strMatches(t,r){let n=this.matches.length-1;for(;n>0&&this.matches[n].startpos>=t;)n--;for(this.matches[n].startpos<t&&n++;this.matches[n]&&this.matches[n].endpos<=r;){let o=this.matches[n];o.annot!=="escape"&&o.annot!=="str"&&(o.annot="str"),n++}}feed(t,r){let n=this.subject;(this.firstpos===-1||t<this.firstpos)&&(this.firstpos=t),(this.lastpos===0||r>this.lastpos)&&(this.lastpos=r);let o=t;for(;o<=r;)if(this.attributeParser!==null){let i=o,s=Io(n,o,r),c;s===null?c=r:c=s;let l=this.attributeParser.feed(i,c),d=l.position;if(l.status==="done"){let m=this.attributeStart;m!==null&&this.addMatch(m,m,"+attributes");let y=this.attributeParser.matches;for(let C of y)this.addMatch(C.startpos,C.endpos,C.annot);this.addMatch(d,d,"-attributes"),this.attributeParser=null,this.attributeStart=null,this.attributeSlices=null,o=d+1}else l.status==="fail"?(this.reparseAttributes(),o=i):l.status==="continue"&&(this.attributeSlices===null&&(this.attributeSlices=[]),this.attributeSlices.push({startpos:i,endpos:d}),o=d+1)}else{let i=Io(n,o,r),s;if(i===null?s=r+1:s=i,s>o&&(this.addMatch(o,s-1,"str"),o=s,o>r))break;let c=n.codePointAt(o);if(c===void 0)throw new Error("Code point at "+o+" is undefined.");if(c===Or||c===Lr)c===Or&&n.codePointAt(o+1)===Lr&&o+1<=r?(this.addMatch(o,o+1,"soft_break"),o=o+2):(this.addMatch(o,o,"soft_break"),o=o+1);else if(this.verbatim>0)if(c===96){let l=(0,G.find)(n,mc,o,r);if(l){let d=l.endpos;if(l.endpos-o+1===this.verbatim){let m=(0,G.find)(n,yc,d+1,r);m&&this.verbatimType==="verbatim"?(this.addMatch(o,d,"-"+this.verbatimType),this.addMatch(m.startpos,m.endpos,"raw_format"),o=m.endpos+1):(this.addMatch(o,d,"-"+this.verbatimType),o=d+1),this.verbatim=0,this.verbatimType="verbatim"}else this.addMatch(o,d,"str"),o=d+1}else this.addMatch(o,r,"str"),o=r+1}else this.addMatch(o,o,"str"),o=o+1;else{let l=this.matchers[c];if(l){let d=l(this,o,r);d===null?o=this.singleChar(o):o=d}else o=this.singleChar(o)}}}};Ae.InlineParser=zr});var Rr=tt(Ne=>{"use strict";Object.defineProperty(Ne,"__esModule",{value:!0});Ne.parseEvents=void 0;var Lo=jt(),kc=Tr(),j=Ar(),Br=Do(),Fr=function(e){return e==="+"||e==="-"||e==="*"||e===":"?[e]:/^[+*-] \[[Xx ]\]/.exec(e)?["X"]:/^[(]?[0-9]+[).]/.exec(e)?[e.replace(/[0-9]+/,"1")]:/^[(]?[ivxlcdm][).]/.exec(e)?[e.replace(/[a-z]+/,"i"),e.replace(/[a-z]+/,"a")]:/^[(]?[IVXLCDM][).]/.exec(e)?[e.replace(/[A-Z]+/,"I"),e.replace(/[A-Z]+/,"A")]:/^[(]?[ivxlcdm]+[).]/.exec(e)?[e.replace(/[a-z]+/,"i")]:/^[(]?[IVXLCDM]+[).]/.exec(e)?[e.replace(/[A-Z]+/,"I")]:/^[(]?[a-z][).]/.exec(e)?[e.replace(/[a-z]/,"a")]:/^[(]?[A-Z][).]/.exec(e)?[e.replace(/[A-Z]/,"A")]:[]},Cc=function(e){return e===32||e===9},Sc=function(e){return e===10||e===13},Oo=(0,j.pattern)("[ \\t]*\\r?\\n"),_c=(0,j.pattern)("^\\w+\\s"),Me=(0,j.pattern)("[ \\t\\r\\n]"),Tc=(0,j.pattern)("[^ \\t\\r\\n]+"),zo=(0,j.pattern)("[>][ \\t\\r\\n]"),Bo=(0,j.pattern)("#+"),Ac=(0,j.pattern)("(~~~~*|````*)([ \\t]*)([^ \\t\\r\\n`]*)[ \\t]*\\r?\\n"),Mc=(0,j.pattern)("(:?)--*(:?)([ \\t]*\\|[ \\t]*)"),Nc=(0,j.pattern)("[^`|\\r\\n]*(?:[|]|`+)"),Ec=(0,j.pattern)("\\^[ \\t]+"),Ic=(0,j.pattern)("\\[\\^([^\\]]+)\\]:[ \\t\\r\\n]"),Pc=(0,j.pattern)("[-*][ 	]*[-*][ \\t]*[-*][-* \\t]*\\r?\\n"),Dc=(0,j.pattern)("(::::*)[ \\t]*\\r?\\n"),Lc=(0,j.pattern)("(::::*)[ \\t]*"),Oc=(0,j.pattern)("([\\w_-]*)[ \\t]*\\r?\\n"),zc=(0,j.pattern)("\\[([^\\]\\r\\n]*)\\]:[ \\t]*([^ \\t\\r\\n]*)[\\r\\n]"),Fo=(0,j.pattern)("(\\|[^\\r\\n]*\\|)[ \\t]*\\r?\\n"),Gr=(0,j.pattern)("(:?[-*+:]|\\([0-9]+\\)|[0-9]+[.)]|[ivxlcdmIVXLCDM]+[.)]|\\([ivxlcdmIVXLCDM]+\\)|[a-zA-Z][.)]|\\([a-zA-Z]\\))[ \\t\\r\\n]"),jr=(0,j.pattern)("[*+-] \\[[Xx ]\\][ \\t\\r\\n]"),L;(function(e){e[e.None=0]="None",e[e.Inline=1]="Inline",e[e.Block=2]="Block",e[e.Text=3]="Text",e[e.Cells=4]="Cells",e[e.Attributes=5]="Attributes",e[e.ListItem=6]="ListItem"})(L||(L={}));var K=class{constructor(t,r){this.name=t.name,this.type=t.type,this.content=t.content,this.continue=t.continue,this.close=t.close,this.indent=0,this.inlineParser=null,this.attributeParser=null,this.extra=r}},$r=class{constructor(t,r={}){t.charAt(t.length-1)!==`
`&&(t=t+`
`),this.subject=t,this.maxoffset=t.length-1,this.options=r,this.warn=r.warn||(()=>{}),this.indent=0,this.startline=0,this.starteol=0,this.endeol=0,this.matches=[],this.containers=[],this.pos=0,this.lastMatchedContainer=0,this.finishedLine=!1,this.returned=0,this.paraSpec={name:"para",type:L.Block,content:L.Inline,continue:n=>this.find(Me)===null,open:n=>(this.addContainer(new K(n,{})),this.addMatch(this.pos,this.pos,"+para"),!0),close:()=>{this.getInlineMatches(),this.containers.pop();let n=this.matches[this.matches.length-1],o=n&&n.endpos+1||this.pos;this.addMatch(o,o,"-para")}},this.specs=[{name:"block_quote",type:L.Block,content:L.Block,continue:n=>this.find(zo)!==null?(this.pos=this.pos+1,!0):!1,open:n=>this.find(zo)!==null?(this.addContainer(new K(n,{})),this.addMatch(this.pos,this.pos,"+block_quote"),this.pos=this.pos+1,!0):!1,close:()=>{this.containers.pop(),this.addMatch(this.pos,this.pos,"-block_quote")}},{name:"heading",type:L.Block,content:L.Inline,continue:n=>{let o=this.find(Bo);return o&&n.extra.level===o.endpos-o.startpos+1&&(0,j.find)(this.subject,Me,o.endpos+1)?(this.pos=o.endpos+1,!0):!1},open:n=>{let o=this.find(Bo);if(o&&(0,j.find)(this.subject,Me,o.endpos+1)){let i=o.endpos-o.startpos+1;return this.addContainer(new K(n,{level:i})),this.addMatch(o.startpos,o.endpos,"+heading"),this.pos=o.endpos+1,!0}else return!1},close:()=>{this.getInlineMatches(),this.containers.pop();let n=this.matches[this.matches.length-1],o=n&&n.endpos+1||this.pos;this.addMatch(o,o,"-heading")}},{name:"caption",type:L.Block,content:L.Inline,continue:n=>(0,j.find)(this.subject,Me,this.pos)===null,open:n=>{let o=this.find(Ec);return o?(this.pos=o.endpos+1,this.addContainer(new K(n,{})),this.addMatch(this.pos,this.pos,"+caption"),!0):!1},close:()=>{this.getInlineMatches(),this.containers.pop(),this.addMatch(this.pos-1,this.pos-1,"-caption")}},{name:"footnote",type:L.Block,content:L.Block,continue:n=>this.indent>(n.extra.indent||0)||this.pos===this.starteol,open:n=>{let o=this.find(Ic);if(o){let i=o.startpos,s=o.endpos,c=o.captures[0];return this.addContainer(new K(n,{note_label:c,indent:this.indent})),this.addMatch(i,i,"+footnote"),this.addMatch(i+2,s-3,"note_label"),this.pos=s,!0}else return!1},close:()=>{this.containers.pop(),this.addMatch(this.pos,this.pos,"-footnote")}},{name:"reference_definition",type:L.Block,content:L.None,continue:n=>{if(n.extra.indent>=this.indent)return!1;let o=this.find(Tc);return this.pos<this.starteol&&o&&o.endpos===this.starteol-1?(this.addMatch(this.pos,this.starteol-1,"reference_value"),this.pos=this.starteol,!0):!1},open:n=>{let o=this.find(zc);if(o){let i=o.captures[0],s=o.captures[1];return this.addContainer(new K(n,{key:i,indent:this.indent})),this.addMatch(o.startpos,o.startpos,"+reference_definition"),this.addMatch(o.startpos,o.startpos+i.length+1,"reference_key"),s.length>0&&this.addMatch(this.starteol-s.length,this.starteol-1,"reference_value"),this.pos=this.starteol-1,!0}else return!1},close:()=>{this.containers.pop(),this.addMatch(this.pos,this.pos,"-reference_definition")}},{name:"thematic_break",type:L.Block,content:L.None,continue:n=>!1,open:n=>{let o=this.find(Pc);return o?(this.addContainer(new K(n,{})),this.addMatch(o.startpos,o.endpos,"thematic_break"),this.pos=o.endpos,!0):!1},close:()=>{this.containers.pop()}},{name:"list",type:L.Block,content:L.ListItem,continue:n=>{if(this.indent>n.extra.indent||this.pos===this.starteol)return!0;{let o=this.find(Gr);if(o===null)return!1;let i=this.subject.substring(o.startpos,o.endpos),s=this.find(jr);s!==null&&(i=this.subject.substring(s.startpos,s.startpos+5));let c=Fr(i),l=[];for(let d of n.extra.styles)c.includes(d)&&l.push(d);if(l.length>0)return n.extra.styles=l,!0}return!1},open:n=>{let o=this.find(Gr);if(o===null)return!1;let i=o.startpos,s=o.endpos,c=this.subject.substring(i,s),l=this.find(jr);l!==null&&(c=this.subject.substring(l.startpos,l.startpos+5));let d=Fr(c);if(d.length===0)return!1;let m={styles:d,indent:this.indent};this.addContainer(new K(n,m));let y="+list";for(let C of d)y=y+"|"+C;return this.addMatch(i,s-1,y),!0},close:()=>{this.containers.pop(),this.addMatch(this.pos,this.pos,"-list")}},{name:"list_item",type:L.ListItem,content:L.Block,continue:n=>this.indent>n.extra.indent||this.pos===this.starteol,open:n=>{let o=this.find(Gr);if(o===null)return!1;let i=o.startpos,s=o.endpos,c=this.subject.substring(i,s),l=null,d=this.find(jr);d!==null&&(c=this.subject.substring(d.startpos,d.startpos+5),l=this.subject.substring(d.startpos+3,d.startpos+4));let m=Fr(c);if(m.length===0)return!1;let y={styles:m,indent:this.indent};this.addContainer(new K(n,y));let C="+list_item";for(let P of m)C=C+"|"+P;return this.addMatch(i,s-1,C),this.pos=s,l&&(l===" "?this.addMatch(i+2,i+4,"checkbox_unchecked"):this.addMatch(i+2,i+4,"checkbox_checked"),this.pos=i+5),!0},close:()=>{this.containers.pop(),this.addMatch(this.pos,this.pos,"-list_item")}},{name:"table",type:L.Block,content:L.Cells,continue:n=>{let o=this.find(Fo);if(o){let i=o.captures[0];return this.parseTableRow(o.startpos,o.startpos+i.length-1)}else return!1},open:n=>{let o=this.find(Fo);if(o){this.addContainer(new K(n,{columns:0}));let i=o.captures[0];return this.addMatch(o.startpos,o.startpos,"+table"),this.parseTableRow(o.startpos,o.startpos+i.length-1)?!0:(this.matches.pop(),this.containers.pop(),!1)}else return!1},close:()=>{this.containers.pop(),this.addMatch(this.pos,this.pos,"-table")}},{name:"attributes",type:L.Block,content:L.Attributes,open:n=>{if(this.subject.codePointAt(this.pos)===123){let o=new kc.AttributeParser(this.subject),i=o.feed(this.pos,this.starteol);if(i.status==="fail")return!1;if(i.status==="done"&&(0,j.find)(this.subject,Oo,i.position+1)===null)return!1;{let s=this.addContainer(new K(n,{status:i.status,indent:this.indent,startpos:this.pos,slices:[]}));return s.attributeParser=o,s.extra.slices=[{startpos:this.pos,endpos:this.starteol}],this.pos=this.starteol,!0}}else return!1},continue:n=>{if(n.extra.status==="done")return!1;if(n.attributeParser&&this.indent>n.extra.indent){n.extra.slices.push({startpos:this.pos,endpos:this.starteol});let s=n.attributeParser.feed(this.pos,this.endeol);if(n.extra.status=s.status,s.status!=="fail"||!(0,j.find)(this.subject,Oo,s.position+1))return this.pos=this.starteol,!0}this.addMatch(n.extra.startpos,n.extra.startpos,"+para");let o=this.containers.pop(),i=this.addContainer(new K(this.paraSpec,{}));if(!i.inlineParser||!o)throw new Error("Missing inlineParser or attrContainer");return i.inlineParser.attributeSlices=o.extra.slices,i.inlineParser.reparseAttributes(),this.pos=i.inlineParser.lastpos+1,!0},close:()=>{let n=this.containers.pop();if(n)if(n.extra.status==="continue"){this.addMatch(n.extra.startpos,n.extra.startpos,"+para");let o=this.addContainer(new K(this.paraSpec,{}),!0);if(!o||!o.inlineParser)throw new Error("Could not add paragraph");o.inlineParser.attributeSlices=n.extra.slices,o.inlineParser.reparseAttributes(),o.close()}else{if(this.addMatch(n.extra.startpos,n.extra.startpos,"+block_attributes"),n.attributeParser){let o=n.attributeParser.matches;for(let i of o)this.matches.push(i)}this.addMatch(this.pos,this.pos,"-block_attributes")}}},{name:"fenced_div",type:L.Block,content:L.Block,continue:n=>{let o=this.tip();if(o&&o.name==="code_block")return!0;let i=this.find(Dc);if(i&&n.extra.colons){let s=i.captures[0];if(s.length>=n.extra.colons)return n.extra.endFenceStartpos=i.startpos,n.extra.endFenceEndpos=i.startpos+s.length-1,this.pos=i.endpos,!1}return!0},open:n=>{let o=this.find(Lc);if(!o)return!1;let i=o.captures[0],s=(0,j.find)(this.subject,Oc,o.endpos+1);if(!s)return!1;let c=s.startpos,l=s.captures[0];return this.addContainer(new K(n,{colons:i.length})),this.addMatch(o.startpos,o.endpos,"+div"),l.length>0&&this.addMatch(c,c+l.length-1,"class"),this.pos=s.endpos+1,this.finishedLine=!0,!0},close:()=>{let n=this.containers.pop();if(!n)return;let o=n.extra.endFenceStartpos||this.pos,i=n.extra.endFenceEndpos||this.pos;this.addMatch(o,i,"-div"),o===i&&this.warn(new Lo.Warning("Unclosed div",this.pos))}},{name:"code_block",type:L.Block,content:L.Text,continue:n=>{let o=this.find(n.extra.closePattern);return o?(n.extra.endFenceStartpos=o.startpos,n.extra.endFenceEndpos=o.startpos+o.captures[0].length-1,this.pos=o.endpos,this.finishedLine=!0,!1):!0},open:n=>{let o=this.find(Ac);if(o){let[i,s,c]=o.captures,l=c.charAt(0)==="="&&!0||!1,d=(0,j.pattern)("("+i+i.substring(0,1)+"*)[ \\t]*[\\r\\n]"),m=this.addContainer(new K(n,{closePattern:d}));if(m.indent=this.indent,this.addMatch(o.startpos,o.startpos+i.length-1,"+code_block"),c.length>0){let y=o.startpos+i.length+s.length;l?this.addMatch(y,y+c.length-1,"raw_format"):this.addMatch(y,y+c.length-1,"code_language")}return this.pos=o.endpos,this.finishedLine=!0,!0}else return!1},close:()=>{let n=this.containers.pop();if(!n)return;let o=n.extra.endFenceStartpos||this.pos,i=n.extra.endFenceEndpos||this.pos;this.addMatch(o,i,"-code_block"),o===i&&this.warn(new Lo.Warning("Unclosed code block",this.pos))}}]}find(t){return(0,j.find)(this.subject,t,this.pos)}tip(){return this.containers.length>=1?this.containers[this.containers.length-1]:null}addMatch(t,r,n){this.matches.push({startpos:Math.min(t,this.maxoffset),endpos:Math.min(r,this.maxoffset),annot:n})}getInlineMatches(){var t;let r=(t=this.tip())===null||t===void 0?void 0:t.inlineParser;if(r){let n;for(let o of r.getMatches())n&&n.annot==="str"&&o.annot==="str"&&o.startpos===n.endpos+1?this.matches[this.matches.length-1].endpos=o.endpos:this.matches.push(o),n=o}}closeUnmatchedContainers(){let t=this.lastMatchedContainer,r=this.tip();for(;r&&this.containers.length-1>t;)r.close(),r=this.tip()}addContainer(t,r){r||this.closeUnmatchedContainers();let n=this.tip();for(;n&&n.content!==t.type;)n.close(),n=this.tip();return t.content===L.Inline&&(t.inlineParser=new Br.InlineParser(this.subject,{warn:this.warn})),this.containers.push(t),t}skipSpace(){let t=this.subject,r=this.pos;for(;Cc(t.codePointAt(r));)r++;this.indent=r-this.startline,this.pos=r}getEol(){let t=this.subject,r=this.pos;for(;!Sc(t.codePointAt(r));)r++;this.starteol=r,t.codePointAt(r)===13&&t.codePointAt(r+1)===10?this.endeol=r+1:this.endeol=r}parseTableCell(){let t=new Br.InlineParser(this.subject,{warn:this.warn}),r=!1,n=this.pos-1,o=n;for(this.skipSpace();!r;){let i=this.find(Nc);if(i===null){r=!1;break}else{let s=i.endpos;this.subject.charAt(s)==="`"||t.inVerbatim()?t.feed(this.pos,s):this.subject.charAt(s-1)==="\\"?t.feed(this.pos,s):(t.feed(this.pos,s-1),o=s,r=!0),this.pos=s+1}}if(r){let i=t.getMatches();return{startpos:n,endpos:o,matches:i}}else return null}parseTableRow(t,r){let n=this.matches.length,o=this.pos;this.addMatch(t,t,"+row"),this.pos++;let i=[],s=this.pos,c=!1;for(;!c;){let l=(0,j.find)(this.subject,Mc,s);if(l!==null){let[d,m,y]=l.captures,C="separator_default";if(d.length>0&&m.length>0?C="separator_center":m.length>0?C="separator_right":d.length>0&&(C="separator_left"),i.push({startpos:l.startpos,endpos:l.endpos-y.length,annot:C}),s=l.endpos+1,s===this.starteol){c=!0;break}}else break}if(c){for(let l of i)this.addMatch(l.startpos,l.endpos,l.annot);return this.addMatch(this.starteol-1,this.starteol-1,"-row"),this.pos=this.starteol,this.finishedLine=!0,!0}for(;this.pos<=r;){let l=this.parseTableCell();if(l!==null){this.addMatch(l.startpos,l.startpos,"+cell");let d=l.matches;d.forEach((m,y)=>{let C=m.startpos,P=m.endpos;if(y===d.length-1&&m.annot==="str")for(;this.subject.codePointAt(P)===32&&P>=C;)P=P-1;this.addMatch(C,P,m.annot)}),this.addMatch(l.endpos,l.endpos,"-cell")}else{for(this.pos=o;this.matches.length>n;)this.matches.pop();return!1}}return this.addMatch(this.pos,this.pos,"-row"),this.pos=this.starteol,this.finishedLine=!0,!0}[Symbol.iterator](){let t=this.specs,r=this.subject.length;this.returned=0;let n=this;return{next(){for(;n.pos<r;){if(n.matches.length>0&&n.returned<n.matches.length)return n.returned=n.returned+1,{value:n.matches[n.returned-1],done:!1};n.indent=0,n.startline=n.pos,n.finishedLine=!1,n.getEol(),n.lastMatchedContainer=-1;let o=0;for(;o<n.containers.length;){let i=n.containers[o];if(n.skipSpace(),i.continue(i))n.lastMatchedContainer=o;else break;o=o+1}if(n.finishedLine)for(;n.containers.length>0&&n.lastMatchedContainer<n.containers.length-1;){let i=n.tip();i&&i.close()}if(!n.finishedLine){n.skipSpace();let i=n.pos===n.starteol,s=!1,c=n.containers[n.lastMatchedContainer],l=!i&&(!c||c.content===L.Block||c.content===L.ListItem)&&!n.find(_c);for(;l;){l=!1;for(let d of t)if((!c&&d.type===L.Block||c&&c.content===d.type)&&d.open(d)){if(n.tip())n.lastMatchedContainer=n.containers.length-1,c=n.containers[n.lastMatchedContainer],n.finishedLine?l=!1:(n.skipSpace(),s=!0,l=d.content===L.Block||d.content===L.ListItem);else throw new Error("No tip after opening container");break}}if(!n.finishedLine){n.skipSpace(),i=n.pos===n.starteol;let d=n.tip();if(!i&&!s&&n.lastMatchedContainer<n.containers.length-1&&d&&d.content===L.Inline||n.closeUnmatchedContainers(),d=n.tip(),(!d||d.content===L.Block)&&(i?s||n.addMatch(n.pos,n.endeol,"blankline"):(n.paraSpec.open(n.paraSpec),d=n.tip(),d&&(d.inlineParser=new Br.InlineParser(n.subject,n.options)))),d&&d.content===L.Text){let y=n.pos;d.indent!==null&&n.indent>d.indent&&(y=y-(n.indent-d.indent)),n.addMatch(y,n.endeol,"str")}else d&&d.content===L.Inline&&!i&&d.inlineParser&&d.inlineParser.feed(n.pos,n.endeol)}}n.pos=(n.endeol||n.pos)+1}return n.lastMatchedContainer=-1,n.closeUnmatchedContainers(),n.matches.length>0&&n.returned<n.matches.length?(n.returned=n.returned+1,{value:n.matches[n.returned-1],done:!1}):{value:{startpos:n.pos,endpos:n.pos,annot:""},done:!0}}}}},Bc=function(e,t={}){return new $r(e,t)};Ne.parseEvents=Bc});var Ee=tt(ut=>{"use strict";Object.defineProperty(ut,"__esModule",{value:!0});ut.isCaption=ut.isRow=ut.isBlock=ut.isInline=void 0;var Fc={para:!0,heading:!0,block_quote:!0,thematic_break:!0,section:!0,div:!0,code_block:!0,raw_block:!0,bullet_list:!0,ordered_list:!0,task_list:!0,definition_list:!0,table:!0,reference:!0,footnote:!0};function Gc(e){return Fc[e.tag]||!1}ut.isBlock=Gc;var jc={str:!0,soft_break:!0,hard_break:!0,non_breaking_space:!0,symb:!0,verbatim:!0,raw_inline:!0,inline_math:!0,display_math:!0,url:!0,email:!0,footnote_reference:!0,smart_punctuation:!0,emph:!0,strong:!0,link:!0,image:!0,span:!0,mark:!0,superscript:!0,subscript:!0,insert:!0,delete:!0,double_quoted:!0,single_quoted:!0};function $c(e){return jc[e.tag]||!1}ut.isInline=$c;function Rc(e){return"head"in e}ut.isRow=Rc;function Uc(e){return!("head"in e)}ut.isCaption=Uc});var Le=tt(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});X.isInline=X.isCaption=X.isRow=X.isBlock=X.getStringContent=X.renderAST=X.parse=void 0;var Vc=Rr(),Go=jt(),De=Ee();Object.defineProperty(X,"isRow",{enumerable:!0,get:function(){return De.isRow}});Object.defineProperty(X,"isBlock",{enumerable:!0,get:function(){return De.isBlock}});Object.defineProperty(X,"isCaption",{enumerable:!0,get:function(){return De.isCaption}});Object.defineProperty(X,"isInline",{enumerable:!0,get:function(){return De.isInline}});var Vr=function(e){let t=[];return $o(e,t),t.join("")};X.getStringContent=Vr;var $o=function(e,t){if("text"in e)t.push(e.text);else if("tag"in e&&(e.tag==="soft_break"||e.tag==="hard_break"))t.push(`
`);else if("children"in e)for(let r of e.children)$o(r,t)},Ur=function(e){return e.replace(/^ `/,"`").replace(/` $/,"`")},qc={i:1,v:5,x:10,l:50,c:100,d:500,m:1e3,I:1,V:5,X:10,L:50,C:100,D:500,M:1e3},jo=function(e){let t=0,r=0,n=e.length-1;for(;n>=0;){let o=e.charAt(n),i=qc[o];if(!i)throw new Error("Encountered bad character in roman numeral "+e);i<r?t=t-i:t=t+i,r=i,n=n-1}return t},Wc=function(e,t){let r=t.replace(/[().]/g,""),n=e.replace(/[().]/g,"");switch(r){case"1":return parseInt(n,10);case"A":return(n.codePointAt(0)||65)-65+1;case"a":return(n.codePointAt(0)||97)-97+1;case"I":return jo(n);case"i":return jo(n)}},R;(function(e){e[e.Normal=0]="Normal",e[e.Verbatim=1]="Verbatim",e[e.Literal=2]="Literal"})(R||(R={}));var ne=function(e){return e.trim().replace(/[ \t\r\n]+/g," ")},Hc=function(e,t={}){let r=[-1];if(t.sourcePositions)for(let u=0;u<e.length;u++)e[u]===`
`&&r.push(u);let n=function(u){let p=r.length,f=0,h=p-1,a=0,b=0;for(;!a;){let T=f+~~((h-f)/2);r[T]>u?h=T:r[T]<=u&&(T===h||r[T+1]>u?(a=T+1,b=u-r[T]):f===T&&f<h?f=T+1:f=T)}return{line:a,col:b,offset:u}},o=R.Normal,i="",s={},c={},l={},d={},m={},y=0,C=(0,Vc.parseEvents)(e,t),P=t.warn||(()=>{}),N=function(u){if(Object.keys(m).length>0){u.attributes=u.attributes||{};for(let p in m)u.attributes[p]=m[p],delete m[p]}},E=function(u){let p=u.replace(/[\]\[~!@#$%^&*(){}`,.<>\\|=+/?\s]+/g," ").trim().replace(/ +/g,"-"),f=0,h=p;for(;!h||d[h];)f=f+1,h=(p||"s")+"-"+f;return h},_=function(u){let p={children:[],data:{},pos:u,attributes:void 0};N(p),S.push(p)},x=function(u){let p=S.pop();if(!p)throw new Error("Container stack is empty (popContainer)");return u&&p.pos&&(p.pos.end=u.end),p},v=function(){if(S.length>0)return S[S.length-1];throw new Error("Container stack is empty (topContainer)")},$=function(){let u=v();return u.children.length>0?u.children[u.children.length-1]:u},k=function(u){S.length>0&&S[S.length-1].children.push(u)},q={str:(u,p,f,h)=>{let a=e.substring(p,f+1);o===R.Normal?k({tag:"str",text:a,pos:h}):i+=a},soft_break:(u,p,f,h)=>{o===R.Normal?k({tag:"soft_break",pos:h}):i+=`
`},escape:(u,p,f,h)=>{o===R.Verbatim&&(i+="\\")},hard_break:(u,p,f,h)=>{o===R.Normal?k({tag:"hard_break",pos:h}):i+=`
`},non_breaking_space:(u,p,f,h)=>{o===R.Verbatim?i+="\\ ":k({tag:"non_breaking_space",pos:h})},symb:(u,p,f,h)=>{if(o===R.Normal){let a=e.substring(p+1,f);k({tag:"symb",alias:a,pos:h})}else{let a=e.substring(p,f+1);i+=a}},footnote_reference:(u,p,f,h)=>{let a=e.substring(p+2,f);k({tag:"footnote_reference",text:ne(a),pos:h})},"+reference_definition":(u,p,f,h)=>{_(h)},"-reference_definition":(u,p,f,h)=>{let a=x(h),b=ne(a.data.key),T={tag:"reference",label:b,destination:a.data.value||"",attributes:a.attributes,pos:a.pos};a.data.key&&(s[b]=T)},reference_key:(u,p,f,h)=>{v().data.key=e.substring(p+1,f),v().data.value=""},reference_value:(u,p,f,h)=>{v().data.value=v().data.value+e.substring(p,f+1)},"+emph":(u,p,f,h)=>{_(h)},"-emph":(u,p,f,h)=>{let a=x(h);k({tag:"emph",children:a.children,pos:a.pos})},"+strong":(u,p,f,h)=>{_(h)},"-strong":(u,p,f,h)=>{let a=x(h);k({tag:"strong",children:a.children,pos:a.pos})},"+span":(u,p,f,h)=>{_(h)},"-span":(u,p,f,h)=>{let a=x(h);k({tag:"span",children:a.children,pos:a.pos})},"+mark":(u,p,f,h)=>{_(h)},"-mark":(u,p,f,h)=>{let a=x(h);k({tag:"mark",children:a.children,pos:a.pos})},"+superscript":(u,p,f,h)=>{_(h)},"-superscript":(u,p,f,h)=>{let a=x(h);k({tag:"superscript",children:a.children,pos:a.pos})},"+subscript":(u,p,f,h)=>{_(h)},"-subscript":(u,p,f,h)=>{let a=x(h);k({tag:"subscript",children:a.children,pos:a.pos})},"+delete":(u,p,f,h)=>{_(h)},"-delete":(u,p,f,h)=>{let a=x(h);k({tag:"delete",children:a.children,pos:a.pos})},"+insert":(u,p,f,h)=>{_(h)},"-insert":(u,p,f,h)=>{let a=x(h);k({tag:"insert",children:a.children,pos:a.pos})},"+double_quoted":(u,p,f,h)=>{_(h)},"-double_quoted":(u,p,f,h)=>{let a=x(h);k({tag:"double_quoted",children:a.children,pos:a.pos})},"+single_quoted":(u,p,f,h)=>{_(h)},"-single_quoted":(u,p,f,h)=>{let a=x(h);k({tag:"single_quoted",children:a.children,pos:a.pos})},"+attributes":(u,p,f,h)=>{_(h)},"-attributes":(u,p,f,h)=>{let a=x(h);if(a.attributes&&S.length>0){a.attributes.id&&(d[a.attributes.id]=!0);let b=$();if(b===v())return;let T=!1;if("tag"in b&&b.tag==="str"){let D=b.text.match(/[^\s]+$/);if(D&&D.index&&D.index>0){let nt;if(b.pos){let ot=b.pos.end;b.pos.end={line:ot.line,col:ot.col-D[0].length,offset:ot.offset-D[0].length},nt={start:{line:ot.line,col:ot.col-D[0].length+1,offset:ot.offset-D[0].length+1},end:ot}}b.text=b.text.substring(0,D.index),k({tag:"str",text:D[0],pos:nt})}else D||(T=!0)}if(b=$(),T){P(new Go.Warning("Ignoring unattached attribute",t.sourcePositions?n(p):p));return}b.attributes||(b.attributes={});for(let D in a.attributes)D==="class"&&b.attributes[D]?b.attributes[D]=b.attributes[D]+" "+a.attributes[D]:b.attributes[D]=a.attributes[D]}},"+block_attributes":(u,p,f,h)=>{_(h)},"-block_attributes":(u,p,f,h)=>{let a=x(h);if(a.attributes&&S.length>0){a.attributes.id&&(d[a.attributes.id]=!0);for(let b in a.attributes)b==="class"&&m[b]?m[b]=m[b]+" "+a.attributes[b]:m[b]=a.attributes[b]}},class:(u,p,f,h)=>{let a=v(),b=e.substring(p,f+1);a.attributes||(a.attributes={}),a.attributes.class?a.attributes.class=a.attributes.class+" "+b:a.attributes.class=b},id:(u,p,f,h)=>{let a=v(),b=e.substring(p,f+1);a.attributes?a.attributes.id=b:a.attributes={id:b}},key:(u,p,f,h)=>{let a=v(),b=e.substring(p,f+1);a.data.key=b,a.attributes||(a.attributes={}),a.attributes[a.data.key]=""},value:(u,p,f,h)=>{let a=v(),b=e.substring(p,f+1).replace(/[ \r\n]+/g," ").replace(/\\([.,\\/#!$%^&*;:{}=\-_`~+[\]()'"?|])/g,"$1");if(a.attributes||(a.attributes={}),a.data.key)a.attributes[a.data.key]=a.attributes[a.data.key]+b;else throw new Error("Encountered value without key")},"+linktext":(u,p,f,h)=>{_(h),v().data.isimage=!1},"-linktext":(u,p,f,h)=>{},"+imagetext":(u,p,f,h)=>{_(h),v().data.isimage=!0},"-imagetext":(u,p,f,h)=>{},"+destination":(u,p,f,h)=>{o=R.Literal},"-destination":(u,p,f,h)=>{let a=x(h);k({tag:a.data.isimage?"image":"link",destination:i.replace(/[\r\n]/g,""),children:a.children,pos:a.pos}),o=R.Normal,i=""},"+reference":(u,p,f,h)=>{o=R.Literal},"-reference":(u,p,f,h)=>{let a=x(h),b=i;b.length===0&&(b=Vr(a)),k({tag:a.data.isimage?"image":"link",reference:ne(b),children:a.children,pos:a.pos}),o=R.Normal,i=""},"+verbatim":(u,p,f,h)=>{o=R.Verbatim,_(h)},"-verbatim":(u,p,f,h)=>{let a=x(h);k({tag:"verbatim",text:Ur(i),pos:a.pos}),o=R.Normal,i=""},raw_format:(u,p,f,h)=>{let a=e.substring(p,f+1).replace(/^\{?=/,"").replace(/\}$/,""),b=v();if(o===R.Verbatim)b.data.format=a;else{let T=b.children[b.children.length-1];if(T&&"tag"in T&&T.tag==="verbatim")T.tag="raw_inline",T.format=a;else throw new Error("raw_format is not after verbatim or code_block.")}},"+display_math":(u,p,f,h)=>{o=R.Verbatim,_(h)},"+inline_math":(u,p,f,h)=>{o=R.Verbatim,_(h)},"-display_math":(u,p,f,h)=>{let a=x(h);k({tag:"display_math",text:Ur(i),pos:a.pos}),o=R.Normal,i=""},"-inline_math":(u,p,f,h)=>{let a=x(h);k({tag:"inline_math",text:Ur(i),pos:a.pos}),o=R.Normal,i=""},"+url":(u,p,f,h)=>{o=R.Literal,_(h)},"-url":(u,p,f,h)=>{let a=x(h);k({tag:"url",text:i.replace(/[\r\n]/g,""),pos:a.pos}),o=R.Normal,i=""},"+email":(u,p,f,h)=>{o=R.Literal,_(h)},"-email":(u,p,f,h)=>{let a=x(h);k({tag:"email",text:i.replace(/[\r\n]/g,""),pos:a.pos}),o=R.Normal,i=""},"+para":(u,p,f,h)=>{_(h)},"-para":(u,p,f,h)=>{let a=x(h);k({tag:"para",children:a.children,attributes:a.attributes,pos:a.pos})},"+heading":(u,p,f,h)=>{_(h),v().data.level=1+f-p},"-heading":(u,p,f,h)=>{let a=x(h);a.attributes||(a.attributes={}),a.autoAttributes||(a.autoAttributes={});let b=Vr(a).trim();a.attributes.id||(a.autoAttributes.id=E(b),d[a.autoAttributes.id]=!0);let T=ne(b);!s[T]&&!c[T]&&(c[T]={tag:"reference",label:T,destination:"#"+(a.attributes.id||a.autoAttributes.id)});let D=v();if(D.data.headinglevel!==void 0){for(;D&&D.data.headinglevel!==void 0&&D.data.headinglevel>=a.data.level;)D=x(h),k({tag:"section",children:D.children,attributes:D.attributes,autoAttributes:D.autoAttributes,pos:D.pos}),D=v();_(h),v().data.headinglevel=a.data.level,a.autoAttributes&&a.autoAttributes.id&&(v().autoAttributes=a.autoAttributes,delete a.autoAttributes),a.attributes&&a.attributes.id&&(v().attributes=a.attributes,delete a.attributes)}k({tag:"heading",level:a.data.level,children:a.children,attributes:a.attributes,autoAttributes:a.autoAttributes,pos:a.pos})},"+list":(u,p,f,h)=>{_(h),v().data.styles=u,v().data.blanklines=!1,v().data.tight=!0,y++},"-list":(u,p,f,h)=>{let a=x(h),b=a.data.styles[0];if(!b)throw new Error("No style defined for list");let T=Wc(a.data.firstMarker,b);k(b===":"?{tag:"definition_list",children:a.children,attributes:a.attributes,autoAttributes:a.autoAttributes,pos:a.pos}:b==="X"?{tag:"task_list",tight:a.data.tight,children:a.children,attributes:a.attributes,autoAttributes:a.autoAttributes,pos:a.pos}:b==="+"||b==="*"||b==="-"?{tag:"bullet_list",tight:a.data.tight,style:b,children:a.children,attributes:a.attributes,autoAttributes:a.autoAttributes,pos:a.pos}:{tag:"ordered_list",style:b,children:a.children,start:T,tight:a.data.tight,attributes:a.attributes,autoAttributes:a.autoAttributes,pos:a.pos}),y--},"+list_item":(u,p,f,h)=>{u.length<v().data.styles.length&&(v().data.styles=u),v().data.firstMarker||(v().data.firstMarker=e.substring(p,f+1)),_(h),u.length===1&&u[0]===":"&&(v().data.definitionList=!0)},"-list_item":(u,p,f,h)=>{let a=x(h);if(a.data.definitionList)if(a.children[0]&&a.children[0].tag==="para"){let b={tag:"term",children:a.children[0].children};a.children.shift();let T={tag:"definition",children:a.children};k({tag:"definition_list_item",children:[b,T],attributes:a.attributes,autoAttributes:a.autoAttributes,pos:a.pos})}else{let b={tag:"term",children:[]},T={tag:"definition",children:a.children};k({tag:"definition_list_item",children:[b,T],attributes:a.attributes,autoAttributes:a.autoAttributes,pos:a.pos})}else a.data.checkbox?k({tag:"task_list_item",children:a.children,attributes:a.attributes,autoAttributes:a.autoAttributes,checkbox:a.data.checkbox,pos:a.pos}):k({tag:"list_item",children:a.children,attributes:a.attributes,autoAttributes:a.autoAttributes,pos:a.pos})},checkbox_checked:(u,p,f,h)=>{v().data.checkbox="checked"},checkbox_unchecked:(u,p,f,h)=>{v().data.checkbox="unchecked"},"+block_quote":(u,p,f,h)=>{_(h)},"-block_quote":(u,p,f,h)=>{let a=x(h);k({tag:"block_quote",children:a.children,attributes:a.attributes,autoAttributes:a.autoAttributes,pos:a.pos})},"+table":(u,p,f,h)=>{_(h),v().data.aligns=[]},"-table":(u,p,f,h)=>{var a;let b=x(h),T=b.children,D={tag:"caption",children:[]};((a=T[0])===null||a===void 0?void 0:a.tag)==="caption"&&(D=T.shift()),k({tag:"table",children:[D,...T],attributes:b.attributes,autoAttributes:b.autoAttributes,pos:b.pos})},"+row":(u,p,f,h)=>{_(h),v().data.aligns=[]},"-row":(u,p,f,h)=>{let a=x(h);if(a.children.length===0){v().data.aligns=a.data.aligns;let b=$();if(b&&"tag"in b&&b.tag==="row"){b.head=!0;for(let T=0;T<b.children.length;T++)b.children[T].head=!0,b.children[T].align=a.data.aligns[T]||"default"}}else{a.data.aligns=[];for(let b=0;b<a.children.length;b++)a.children[b].align=v().data.aligns[b]||"default";k({tag:"row",children:a.children,head:!1,attributes:a.attributes,autoAttributes:a.autoAttributes,pos:a.pos})}},separator_default:(u,p,f,h)=>{v().data.aligns.push("default")},separator_left:(u,p,f,h)=>{v().data.aligns.push("left")},separator_right:(u,p,f,h)=>{v().data.aligns.push("right")},separator_center:(u,p,f,h)=>{v().data.aligns.push("center")},"+cell":(u,p,f,h)=>{_(h)},"-cell":(u,p,f,h)=>{let a=x(h);k({tag:"cell",children:a.children,head:!1,align:"default",attributes:a.attributes,autoAttributes:a.autoAttributes,pos:a.pos})},"+caption":(u,p,f,h)=>{_(h)},"-caption":(u,p,f,h)=>{var a;let b=x(h),T=$();if(!T||"tag"in T&&T.tag!=="table")return;let D={tag:"caption",children:b.children,attributes:b.attributes,autoAttributes:b.autoAttributes,pos:b.pos};((a=T.children[0])===null||a===void 0?void 0:a.tag)==="caption"&&(T.children[0]=D)},"+footnote":(u,p,f,h)=>{_(h)},"-footnote":(u,p,f,h)=>{let a=x(h);if(a.data.label){let b=ne(a.data.label);l[b]={tag:"footnote",label:b||"",children:a.children,attributes:a.attributes,autoAttributes:a.autoAttributes,pos:a.pos}}else P(new Go.Warning("Ignoring footnote without a label.",t.sourcePositions?n(f):f))},note_label:(u,p,f,h)=>{v().data.label=e.substring(p,f+1)},"+code_block":(u,p,f,h)=>{_(h),o=R.Verbatim},"-code_block":(u,p,f,h)=>{let a=x(h);a.data.format?k({tag:"raw_block",format:a.data.format,text:i,attributes:a.attributes,autoAttributes:a.autoAttributes,pos:a.pos}):k({tag:"code_block",text:i,lang:a.data.lang,attributes:a.attributes,autoAttributes:a.autoAttributes,pos:a.pos}),o=R.Normal,i=""},code_language:(u,p,f,h)=>{let a=v();a.data.lang=e.substring(p,f+1)},"+div":(u,p,f,h)=>{_(h)},"-div":(u,p,f,h)=>{let a=x(h);k({tag:"div",children:a.children,attributes:a.attributes,autoAttributes:a.autoAttributes,pos:a.pos})},thematic_break:(u,p,f,h)=>{let a={tag:"thematic_break",pos:h};N(a),k(a)},left_single_quote:(u,p,f,h)=>{k({tag:"smart_punctuation",type:"left_single_quote",text:"'",pos:h})},right_single_quote:(u,p,f,h)=>{k({tag:"smart_punctuation",type:"right_single_quote",text:"'",pos:h})},left_double_quote:(u,p,f,h)=>{k({tag:"smart_punctuation",type:"left_double_quote",text:'"',pos:h})},right_double_quote:(u,p,f,h)=>{k({tag:"smart_punctuation",type:"right_double_quote",text:'"',pos:h})},ellipses:(u,p,f,h)=>{k({tag:"smart_punctuation",type:"ellipses",text:"...",pos:h})},en_dash:(u,p,f,h)=>{k({tag:"smart_punctuation",type:"en_dash",text:"--",pos:h})},em_dash:(u,p,f,h)=>{k({tag:"smart_punctuation",type:"em_dash",text:"---",pos:h})},blankline:(u,p,f,h)=>{let a;"tight"in v().data?a=v():S.length>=2&&"tight"in S[S.length-2].data&&(a=S[S.length-2]),a&&(a.data.blanklines=!0)}},W=function(u,p){let f,h,a;t.sourcePositions&&(f=n(p.startpos),h=n(p.endpos),a={start:f,end:h});let b=p.annot,T=[];if(p.annot.includes("|")){let nt=p.annot.split("|");b=nt[0],T=nt.slice(1)}if(y>0&&b!=="blankline"){let nt,ot=v();ot&&(ot.data&&"tight"in ot.data?nt=ot:u.length>=2&&"tight"in u[u.length-2].data&&(nt=u[u.length-2])),nt&&(!/^[+-]list/.test(b)&&nt.data.blanklines&&(nt.data.tight=!1),/^[-+]list_item$/.test(b)||(nt.data.blanklines=!1))}let D=q[b];D&&D(T,p.startpos,p.endpos,a)},S=[{children:[],data:{headinglevel:0},pos:{start:{line:0,col:0,offset:0},end:{line:0,col:0,offset:0}}}],Z=0;for(let u of C)W(S,u),Z=u.endpos;let at;t.sourcePositions&&(at=n(Z));let mt=v();for(;mt&&mt.data.headinglevel>0;)x(at&&{start:at,end:at}),k({tag:"section",children:mt.children,attributes:mt.attributes,autoAttributes:mt.autoAttributes,pos:mt.pos}),mt=v();let ct={tag:"doc",references:s,autoReferences:c,footnotes:l,children:S[0].children};return S[0].autoAttributes&&(ct.autoAttributes=S[0].autoAttributes),S[0].attributes&&(ct.attributes=S[0].attributes),ct};X.parse=Hc;var Yc={children:!0,tag:!0,pos:!0,attributes:!0,autoAttributes:!0,references:!0,autoReferences:!0,footnotes:!0},Pe=function(e){return JSON.stringify(e).replace(/\\\n/g,"\\n")},Ie=function(e,t,r){if(t.push(" ".repeat(r)),r>128){t.push(`(((DEEPLY NESTED CONTENT OMITTED)))
`);return}t.push(e.tag),e.pos&&t.push(` (${e.pos.start.line}:${e.pos.start.col}:${e.pos.start.offset}-${e.pos.end.line}:${e.pos.end.col}:${e.pos.end.offset})`);for(let n in e)if(!Yc[n]){let o=e[n];o!=null&&t.push(` ${n}=${Pe(o)}`)}if(e.attributes)for(let n in e.attributes)t.push(` ${n}=${Pe(e.attributes[n])}`);if(t.push(`
`),e.children)for(let n of e.children)Ie(n,t,r+2)},Jc=function(e){let t=[];if(Ie(e,t,0),Object.keys(e.references).length>0){t.push(`references
`);for(let r in e.references)t.push(`  [${Pe(r)}] =
`),Ie(e.references[r],t,4)}if(Object.keys(e.footnotes).length>0){t.push(`footnotes
`);for(let r in e.footnotes)t.push(`  [${Pe(r)}] =
`),Ie(e.footnotes[r],t,4)}return t.join("")};X.renderAST=Jc});var Uo=tt(Rt=>{"use strict";Object.defineProperty(Rt,"__esModule",{value:!0});Rt.HTMLRenderer=Rt.renderHTML=void 0;var Ro=Le(),Kc=jt(),Xc=/[&<>]/,Qc=/[&<>"]/,Oe=class{constructor(t){this.smartPunctuationMap={right_single_quote:"\u2019",left_single_quote:"\u2018",right_double_quote:"\u201D",left_double_quote:"\u201C",ellipses:"\u2026",em_dash:"\u2014",en_dash:"\u2013"},this.warn=t.warn||(()=>{}),this.options=t||{},this.tight=!1,this.footnoteIndex={},this.nextFootnoteIndex=1,this.references={},this.autoReferences={}}escape(t){return Xc.test(t)?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):t}escapeAttribute(t){return Qc.test(t)?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):t}renderAttributes(t,r){let n="";if(r)for(let i in r)if(i==="class"){let s=r[i];t.attributes&&t.attributes.class&&(s=`${s} ${t.attributes.class}`),n+=` ${i}="${this.escapeAttribute(s)}"`}else n+=` ${i}="${this.escapeAttribute(r[i])}"`;let o=Object.assign(Object.assign({},t.autoAttributes),t.attributes);if(o)for(let i in o){let s=o[i];i==="class"&&r&&r.class||(n+=` ${i}="${this.escapeAttribute(s)}"`)}if(t.pos){let i=t.pos.start,s=t.pos.end;n+=` data-startpos="${i.line}:${i.col}:${i.offset}" data-endpos="${s.line}:${s.col}:${s.offset}"`}return n}renderTag(t,r,n){let o="";return(r.attributes||r.autoAttributes||n||r.pos)&&(o=this.renderAttributes(r,n)),`<${t}${o}>`}renderCloseTag(t){return`</${t}>`}inTags(t,r,n,o){let i=n>=2?`
`:"",s=n>=1?`
`:"";return`${this.renderTag(t,r,o)}${i}${this.renderChildren(r)}</${t}>${s}`}addBacklink(t,r){let n=`<a href="#fnref${r}" role="doc-backlink">\u21A9\uFE0E</a>`;return/\<\/p\>[\r\n]*$/.test(t)?t.replace(/\<\/p\>([\r\n]*)$/,n+"</p>$1"):t+`<p>${n}</p>
`}renderChildren(t){let r="",n=this.tight;"tight"in t&&(this.tight=!!t.tight);for(let o of t.children)r+=this.renderAstNode(o);return"tight"in t&&(this.tight=n),r}renderAstNode(t){var r;let n=(r=this.options.overrides)===null||r===void 0?void 0:r[t.tag];return n?n(t,this):this.renderAstNodeDefault(t)}renderNotes(t){let r="",n=[],o={};for(let i in t)o[i]=this.renderChildren(t[i]);for(let i in this.footnoteIndex){let s=this.footnoteIndex[i];s&&(n[s]=o[i])}r+=`<section role="doc-endnotes">
<hr>
<ol>
`;for(let i=1;i<n.length;i++){let s=n[i]||"";r+=`<li id="fn${i}">
`,r+=this.addBacklink(s,i),r+=`</li>
`}return r+=`</ol>
</section>
`,r}renderAstNodeDefault(t){var r;switch(t.tag){case"doc":{let n="";return n+=this.renderChildren(t),this.nextFootnoteIndex>1&&(n+=this.renderNotes(t.footnotes)),n}case"para":return this.tight?`${this.renderChildren(t)}
`:this.inTags("p",t,1);case"block_quote":return this.inTags("blockquote",t,2);case"div":return this.inTags("div",t,2);case"section":return this.inTags("section",t,2);case"list_item":return this.inTags("li",t,2);case"task_list_item":return this.inTags("li",t,2,{class:t.checkbox==="checked"?"checked":"unchecked"});case"definition_list_item":return this.renderChildren(t);case"definition":return this.inTags("dd",t,2);case"term":return this.inTags("dt",t,1);case"definition_list":return this.inTags("dl",t,2);case"bullet_list":return this.inTags("ul",t,2);case"task_list":return this.inTags("ul",t,2,{class:"task-list"});case"ordered_list":{let n={};return t.start&&t.start!==1&&(n.start=t.start.toString()),t.style&&!/1/.test(t.style)&&(n.type=t.style.replace(/[().]/g,"")),this.inTags("ol",t,2,n)}case"heading":return this.inTags(`h${t.level}`,t,1);case"footnote_reference":{let n="",o=t.text,i=this.footnoteIndex[o];return i||(i=this.nextFootnoteIndex,this.footnoteIndex[o]=i,this.nextFootnoteIndex++),n+=this.renderTag("a",t,{id:"fnref"+i,href:"#fn"+i,role:"doc-noteref"}),n+="<sup>",n+=this.escape(i.toString()),n+="</sup></a>",n}case"table":return this.inTags("table",t,2);case"caption":{let n="";return t.children.length>0&&(n+=this.inTags("caption",t,1)),n}case"row":return this.inTags("tr",t,2);case"cell":{let n={};return t.align&&t.align!=="default"&&(n.style=`text-align: ${t.align};`),this.inTags(t.head?"th":"td",t,1,n)}case"thematic_break":{let n="";return n+=this.renderTag("hr",t),n+=`
`,n}case"code_block":{let n="";return n+=this.renderTag("pre",t),n+="<code",t.lang&&(n+=` class="language-${this.escapeAttribute(t.lang)}"`),n+=">",n+=this.escape(t.text),n+=this.renderCloseTag("code"),n+=this.renderCloseTag("pre"),n+=`
`,n}case"raw_block":{let n="";return t.format==="html"&&(n+=t.text),n}case"str":return t.attributes||t.autoAttributes?`${this.renderTag("span",t)}${this.escape(t.text)}</span>`:this.escape(t.text);case"smart_punctuation":return this.smartPunctuationMap[t.type]||t.text;case"double_quoted":{let n="";return n+=this.smartPunctuationMap.left_double_quote||'"',n+=this.renderChildren(t),n+=this.smartPunctuationMap.right_double_quote||'"',n}case"single_quoted":{let n="";return n+=this.smartPunctuationMap.left_single_quote||"'",n+=this.renderChildren(t),n+=this.smartPunctuationMap.right_single_quote||"'",n}case"symb":return this.escape(`:${t.alias}:`);case"inline_math":{let n="";return n+=this.renderTag("span",t,{class:"math inline"}),n+=`\\(${this.escape(t.text)}\\)`,n+=this.renderCloseTag("span"),n}case"display_math":{let n="";return n+=this.renderTag("span",t,{class:"math display"}),n+=`\\[${this.escape(t.text)}\\]`,n+=this.renderCloseTag("span"),n}case"verbatim":{let n="";return n+=this.renderTag("code",t),n+=this.escape(t.text),n+=this.renderCloseTag("code"),n}case"raw_inline":{let n="";return t.format==="html"&&(n+=t.text),n}case"soft_break":return`
`;case"hard_break":return`<br>
`;case"non_breaking_space":return"&nbsp;";case"link":case"image":{let n={},o=t.destination;if(t.reference){let i=this.references[t.reference]||this.autoReferences[t.reference];if(i){if(o=i.destination,t.tag==="image"?(n.alt=(0,Ro.getStringContent)(t),n.src=o):n.href=o,i.attributes)for(let s in i.attributes)(!t.attributes||!t.attributes[s])&&(n[s]=i.attributes[s]);if(i.autoAttributes)for(let s in i.autoAttributes)(!t.autoAttributes||!t.autoAttributes[s])&&(n[s]=i.autoAttributes[s])}else this.warn(new Kc.Warning(`Reference ${JSON.stringify(t.reference)} not found`,(r=t==null?void 0:t.pos)===null||r===void 0?void 0:r.end))}else t.tag==="image"?(n.alt=(0,Ro.getStringContent)(t),o!==void 0&&(n.src=o)):o!==void 0&&(n.href=o);return t.tag==="image"?this.renderTag("img",t,n):this.inTags("a",t,0,n)}case"url":case"email":{let n="",o={};return t.tag==="email"?o.href="mailto:"+t.text:o.href=t.text,n+=this.renderTag("a",t,o),n+=this.escape(t.text),n+=this.renderCloseTag("a"),n}case"strong":return this.inTags("strong",t,0);case"emph":return this.inTags("em",t,0);case"span":return this.inTags("span",t,0);case"mark":return this.inTags("mark",t,0);case"insert":return this.inTags("ins",t,0);case"delete":return this.inTags("del",t,0);case"superscript":return this.inTags("sup",t,0);case"subscript":return this.inTags("sub",t,0);default:return""}}render(t){return this.references=t.references,this.autoReferences=t.autoReferences,this.renderAstNode(t)}};Rt.HTMLRenderer=Oe;var Zc=function(e,t={}){return new Oe(t).render(e)};Rt.renderHTML=Zc});var Vo=tt(ze=>{"use strict";Object.defineProperty(ze,"__esModule",{value:!0});ze.applyFilter=void 0;var Wr=class{constructor(t){this.finished=!1,this.stack=[],this.enter=!0,this.top=t,this.current=t}walk(t){for(;!this.finished;){t(this);let r=this.stack&&this.stack[this.stack.length-1];if(this.enter)"children"in this.current&&this.current.children.length>0?(this.stack.push({node:this.current,childIndex:0}),this.current=this.current.children[0],this.enter=!0):this.enter=!1;else if(r){r.childIndex++;let n=r.node.children[r.childIndex];n?(this.current=n,this.enter=!0):(this.stack.pop(),this.current=r.node,this.enter=!1)}else this.finished=!0}}},tl=function(e,t,r){if(!e||!e.tag)throw new Error("Filter called on a non-node.");let n=r[e.tag];if(!n)return!1;let o;if(t?"enter"in n&&n.enter&&(o=n.enter):"exit"in n&&n.exit?o=n.exit:o=n,typeof o=="function")return o(e)},qr=function(e,t){return new Wr(e).walk(r=>{let n=tl(r.current,r.enter,t),o=r.stack[r.stack.length-1];if(typeof n=="object"&&"stop"in n&&n.stop&&(n=n.stop,r.enter=!1),n){if(Array.isArray(n))if(o)o.node.children.splice(o.childIndex,1,...n),r.current=o.node.children[o.childIndex],n.length>1&&(o.childIndex+=n.length-1);else throw Error("Cannot replace top node with multiple nodes");else if(typeof n=="object"&&"tag"in n&&n.tag)if(o)o.node.children[o.childIndex]=n;else return n}}),e},el=function(e,t){let r=t(),n;Array.isArray(r)?n=r:n=[r];for(let o of n){qr(e,o);for(let i in e.footnotes)qr(e.footnotes[i],o);for(let i in e.references)qr(e.references[i],o)}};ze.applyFilter=el});var Wo=tt(Ut=>{"use strict";Object.defineProperty(Ut,"__esModule",{value:!0});Ut.fromPandoc=Ut.toPandoc=void 0;var Fe=jt(),Be={Decimal:{Period:"1.",OneParen:"1)",TwoParens:"(1)"},LowerAlpha:{Period:"a.",OneParen:"a)",TwoParens:"(a)"},UpperAlpha:{Period:"A.",OneParen:"A)",TwoParens:"(A)"},LowerRoman:{Period:"i.",OneParen:"i)",TwoParens:"(i)"},UpperRoman:{Period:"I.",OneParen:"I)",TwoParens:"(I)"}},qo={};for(let e in Be)for(let t in Be[e])qo[Be[e][t]]=[e,t];var rl=function(e){return e.t==="Para"&&(e.t="Plain"),e},pt=function(e){let t=Object.assign(Object.assign({},e.autoAttributes),e.attributes);if(t){let r=t.id||"",n=t.class&&t.class.split(" ")||[],o=[];for(let i in t)i!==r&&i!=="class"&&o.push([i,t[i]]);return[r,n,o]}else return["",[],[]]},Hr=class{constructor(t={}){this.references={},this.footnotes={},this.options=t,this.smartPunctuationMap=this.options.smartPunctuationMap||{right_single_quote:"\u2019",left_single_quote:"\u2018",right_double_quote:"\u201D",left_double_quote:"\u201C",ellipses:"\u2026",em_dash:"\u2014",en_dash:"\u2013"},this.warn||(this.warn=()=>{})}toPandocChildren(t){if("children"in t){let r=[];return t.children.forEach(n=>{this.addToPandocElts(r,n)}),r}else return[]}toPandocDefinitionListItem(t){let r=this;return function(n){if(!("children"in n))return[];let[o,i]=n.children;return[r.toPandocChildren(o),[r.toPandocChildren(i)]]}}toPandocListItem(t){let r=this;return function(n){let o=r.toPandocChildren(n);return"checkbox"in n&&n.checkbox&&o[0].t==="Para"&&(n.checkbox==="checked"?o[0].c.unshift({t:"Str",c:"\u2612"},{t:"Space"}):o[0].c.unshift({t:"Str",c:"\u2610"},{t:"Space"})),"tight"in t&&t.tight&&(o=o.map(rl)),o}}addToPandocElts(t,r){switch(r.tag){case"section":case"div":{let n=pt(r);r.tag==="section"&&n[1].unshift("section"),t.push({t:"Div",c:[n,this.toPandocChildren(r)]});break}case"block_quote":t.push({t:"BlockQuote",c:this.toPandocChildren(r)});break;case"definition_list":{let n=r.children.map(this.toPandocDefinitionListItem(r));t.push({t:"DefinitionList",c:n});break}case"task_list":case"bullet_list":{let n;n=r.children.map(this.toPandocListItem(r)),t.push({t:"BulletList",c:n});break}case"ordered_list":{let n=r.children.map(this.toPandocListItem(r)),[o,i]=qo[r.style],s=r.start||1;t.push({t:"OrderedList",c:[[s,{t:o},{t:i}],n]});break}case"task_list_item":case"list_item":break;case"para":t.push({t:"Para",c:this.toPandocChildren(r)});break;case"heading":t.push({t:"Header",c:[r.level,pt(r),this.toPandocChildren(r)]});break;case"code_block":{let n=pt(r);r.lang&&n[1].unshift(r.lang),t.push({t:"CodeBlock",c:[n,r.text]});break}case"raw_block":t.push({t:"RawBlock",c:[r.format,r.text]});break;case"thematic_break":t.push({t:"HorizontalRule"});break;case"table":{let n=pt(r),o=["",[],[]],i=[],s=[],c=[],l=[],d=[o,[]],m=[],y=[],C={left:"AlignLeft",right:"AlignRight",center:"AlignCenter",default:"AlignDefault"},P=function(x){return[{t:C[x.align]||"AlignDefault"},{t:"ColWidthDefault"}]},N=this,E=function(x){if("children"in x)return[pt(x),{t:"align"in x&&C[x.align]||"AlignDefault"},1,1,[{t:"Plain",c:N.toPandocChildren(x)}]]},_=function(x){if("children"in x)return[pt(x),x.children.map(E)]};for(let x=0;x<r.children.length;x++){let v=r.children[x];if(!("children"in v))break;s.length===0&&(s=v.children.map(P)),v.tag==="caption"?v.children.length&&(i=this.toPandocChildren(v)):v.head?y.length===0?m.push(_(v)):(l.push([o,0,m,y]),y=[],m=[_(v)]):(l.length===0&&y.length===0&&(c=m,m=[]),y.push(_(v)))}(m.length>0||y.length>0)&&l.push([o,0,m,y]),t.push({t:"Table",c:[n,[null,[{t:"Plain",c:i}]],s,[o,c],l,d]});break}case"raw_inline":t.push({t:"RawInline",c:[r.format,r.text]});break;case"soft_break":t.push({t:"SoftBreak"});break;case"hard_break":t.push({t:"LineBreak"});break;case"str":r.text.split(/ +/).forEach((n,o)=>{o>0&&t.push({t:"Space"}),n.length>0&&t.push({t:"Str",c:n})});break;case"verbatim":t.push({t:"Code",c:[pt(r),r.text]});break;case"inline_math":t.push({t:"Math",c:[{t:"InlineMath"},r.text]});break;case"display_math":t.push({t:"Math",c:[{t:"DisplayMath"},r.text]});break;case"non_breaking_space":t.push({t:"Str",c:"\xA0"});break;case"smart_punctuation":t.push({t:"Str",c:this.smartPunctuationMap[r.type]||r.text});break;case"symb":t.push({t:"Span",c:[["",["symbol"],[["alias",r.alias]]],[{t:"Str",c:":"+r.alias+":"}]]});break;case"single_quoted":case"double_quoted":{let n={t:r.tag==="single_quoted"?"SingleQuote":"DoubleQuote"};t.push({t:"Quoted",c:[n,this.toPandocChildren(r)]});break}case"email":case"url":{let n=r.text;r.tag==="email"&&(n="mailto:"+n);let o=pt(r);o[1].unshift(r.tag==="email"?"email":"uri"),t.push({t:"Link",c:[o,[{t:"Str",c:r.text}],[n,""]]});break}case"image":case"link":{let n=r.destination||"",o={};if(r.reference){let d=this.references[r.reference];if(d){n=d.destination||"";let m=Object.assign(Object.assign({},d.autoAttributes),d.attributes);if(m)for(let y in m)o[y]=m[y]}else this.warn(new Fe.Warning("Reference "+r.reference+" not found."))}let i=Object.assign(Object.assign({},r.autoAttributes),r.attributes);if(i)for(let d in i)o[d]&&d==="class"?o[d]+=" "+i[d]:o[d]||(o[d]=i[d]);let s=pt({tag:"link",attributes:o,children:[]}),c=n||"",l=r.attributes&&r.attributes.title||r.autoAttributes&&r.autoAttributes.title||"";l&&(s[2]=s[2].filter(([d,m])=>d!=="title")),t.push({t:r.tag==="link"?"Link":"Image",c:[s,this.toPandocChildren(r),[c,l]]});break}case"emph":t.push({t:"Emph",c:this.toPandocChildren(r)});break;case"strong":t.push({t:"Strong",c:this.toPandocChildren(r)});break;case"superscript":t.push({t:"Superscript",c:this.toPandocChildren(r)});break;case"subscript":t.push({t:"Subscript",c:this.toPandocChildren(r)});break;case"span":t.push({t:"Span",c:[pt(r),this.toPandocChildren(r)]});break;case"mark":t.push({t:"Span",c:[["",["mark"],[]],this.toPandocChildren(r)]});break;case"insert":t.push({t:"Underline",c:this.toPandocChildren(r)});break;case"delete":t.push({t:"Strikeout",c:this.toPandocChildren(r)});break;case"footnote_reference":{let n=this.footnotes[r.text];n?t.push({t:"Note",c:this.toPandocChildren(n)}):t.push({t:"Superscript",c:[{t:"Str",c:r.text}]});break}default:this.warn(new Fe.Warning("Skipping unhandled node "+r.tag))}}toPandoc(t){return this.references=t.references,this.footnotes=t.footnotes,{"pandoc-api-version":[1,23],meta:{},blocks:this.toPandocChildren(t)}}},ft=function(e){let t={};e[0]&&(t.id=e[0]),e[1].length>0&&(t.class=e[1].join(" "));for(let r=0;r<e[2].length;r++)t[e[2][r][0].toString()]=e[2][r][1];return Object.keys(t).length===0?null:t},Yr=function(e){return e.t==="Plain"||e.t==="Para"},nl=function(e){if(!e[0])return null;let t=e[0];return Yr(t)&&t.c.length>=2&&t.c[0].t==="Str"&&t.c[1].t==="Space"?t.c[0].c==="\u2612"?(t.c.shift(),t.c.shift(),"checked"):t.c[0].c==="\u2610"?(t.c.shift(),t.c.shift(),"unchecked"):null:null},Jr=class{constructor(t={}){this.footnotes={},this.footnoteIndex=0,this.options=t,this.warn=t.warn||(()=>{})}fromPandocInlines(t){let r=[],n=[];for(let o=0;o<t.length;o++){let i=t[o];if(i.t==="Str")r.push(i.c);else if(i.t==="Space")r.push(" ");else switch(r.length>0&&(n.push({tag:"str",text:r.join("")}),r=[]),i.t){case"SoftBreak":n.push({tag:"soft_break"});break;case"LineBreak":n.push({tag:"hard_break"});break;case"Emph":n.push({tag:"emph",children:this.fromPandocInlines(i.c)});break;case"Strong":n.push({tag:"strong",children:this.fromPandocInlines(i.c)});break;case"Superscript":n.push({tag:"superscript",children:this.fromPandocInlines(i.c)});break;case"Subscript":n.push({tag:"subscript",children:this.fromPandocInlines(i.c)});break;case"Strikeout":n.push({tag:"delete",children:this.fromPandocInlines(i.c)});break;case"Span":{let s={tag:"span",children:this.fromPandocInlines(i.c[1])},c=ft(i.c[0]);c&&(s.attributes=c),n.push(s);break}case"Underline":n.push({tag:"span",attributes:{class:"underline"},children:this.fromPandocInlines(i.c)});break;case"SmallCaps":n.push({tag:"span",attributes:{class:"smallcaps"},children:this.fromPandocInlines(i.c)});break;case"Math":n.push({tag:i.c[0].t==="DisplayMath"?"display_math":"inline_math",text:i.c[1]});break;case"Quoted":i.c[0].t==="SingleQuote"?n.push({tag:"single_quoted",children:this.fromPandocInlines(i.c[1])}):n.push({tag:"double_quoted",children:this.fromPandocInlines(i.c[1])});break;case"RawInline":n.push({tag:"raw_inline",format:i.c[0],text:i.c[1]});break;case"Code":{let s=ft(i.c[0]),c={tag:"verbatim",text:i.c[1]};s&&(c.attributes=s),n.push(c);break}case"Image":case"Link":{let s=ft(i.c[0]);i.c[2][1]&&(s=s||{},s.title=i.c[2][1]);let c=i.c[2][0],l=this.fromPandocInlines(i.c[1]);if(i.t==="Image"){let d={tag:"image",destination:c,children:l};s&&(d.attributes=s),n.push(d)}else{let d={tag:"link",destination:c,children:l};s&&(d.attributes=s),n.push(d)}break}case"Cite":n.push({tag:"span",attributes:{class:"cite"},children:this.fromPandocInlines(i.c[1])});break;case"Note":{this.footnoteIndex++;let s=this.footnoteIndex.toString(),c=i.c.map(l=>this.fromPandocBlock(l));this.footnotes[this.footnoteIndex.toString()]={tag:"footnote",label:s,children:c},n.push({tag:"footnote_reference",text:s});break}default:}}return r.length>0&&n.push({tag:"str",text:r.join("")}),n}fromPandocBlock(t){switch(t.t){case"Plain":case"Para":return{tag:"para",children:this.fromPandocInlines(t.c)};case"BlockQuote":return{tag:"block_quote",children:t.c.map(r=>this.fromPandocBlock(r))};case"Div":{let r=ft(t.c[0]),n=/\bsection\b/.test(r&&r.class||"")?"section":"div",o=t.c[1].map(i=>this.fromPandocBlock(i));if(n==="section")return r=r||{},r.class=r.class.replace(/section */,""),r.class||delete r.class,{tag:"section",attributes:r,children:o};{let i={tag:"div",children:o};return r&&(i.attributes=r),i}}case"Header":{let r=ft(t.c[1]),n={tag:"heading",level:t.c[0],children:this.fromPandocInlines(t.c[2])};return r&&(n.attributes=r),n}case"HorizontalRule":return{tag:"thematic_break"};case"RawBlock":return{tag:"raw_block",format:t.c[0],text:t.c[1]};case"CodeBlock":{let r=ft(t.c[0]),n;if(r&&r.class){let i=r.class.split(/  */);n=i[0],i.shift(),i.length>0?r.class=i.join(" "):delete r.class}let o={tag:"code_block",lang:n,text:t.c[1]};return r&&(o.attributes=r),n||delete o.lang,o}case"DefinitionList":{let r=[];for(let o=0;o<t.c.length;o++){let i=t.c[o][0],s=t.c[o][1],c=this.fromPandocInlines(i),l=[];for(let d=0;d<s.length;d++)s[d].map(m=>{l.push(this.fromPandocBlock(m))});r.push({tag:"definition_list_item",children:[{tag:"term",children:c},{tag:"definition",children:l}]})}return{tag:"definition_list",children:r}}case"OrderedList":case"BulletList":{let r=[],n=[],o=!1,i;t.t==="BulletList"?i=t.c:i=t.c[1];for(let s=0;s<i.length;s++){let c=nl(i[s]),l=i[s].map(d=>(d.t==="Plain"?o=!0:d.t==="Para"&&(o=!1),this.fromPandocBlock(d)));c!==null?n.push({tag:"task_list_item",checkbox:c,children:l}):r.push({tag:"list_item",children:l})}if(t.t==="BulletList")return n.length>0?{tag:"task_list",tight:o,children:n}:{tag:"bullet_list",style:"-",tight:o,children:r};if(t.t==="OrderedList"){let s=t.c[0][0],c=t.c[0][1].t;c==="DefaultStyle"&&(c="Decimal");let l=t.c[0][2].t;return l==="DefaultDelim"&&(l="Period"),{tag:"ordered_list",style:Be[c][l],start:s,tight:o,children:r}}}case"Table":{let r=ft(t.c[0]),n=t.c[1][1],o={tag:"caption",children:[]};n.length>1||n.length===1&&!Yr(n[0])?this.warn(new Fe.Warning("Skipping block-level content in table caption.")):n[0]&&"c"in n[0]&&(o.children=this.fromPandocInlines(n[0].c));let i=t.c[2],s=[];for(let C in i)s.push(i[C][0].t.slice(5).toLowerCase());let c=[],l=t.c[3][1];for(let C in l)c.push(this.fromPandocRow(l[C],!0,0,s));let d=t.c[4];for(let C in d){let P=d[C][1],N=d[C][2];for(let _ in N)c.push(this.fromPandocRow(N[_],!0,P,s));let E=d[C][3];for(let _ in E)c.push(this.fromPandocRow(E[_],!1,P,s))}let m=t.c[5][1];for(let C in m)c.push(this.fromPandocRow(m[C],!1,0,s));let y={tag:"table",children:[o,...c]};return r&&(y.attributes=r),y}case"Figure":{let r=ft(t.c[0]),n=/\bsection\b/.test(r&&r.class||"")?"section":"div",o=t.c[2].map(c=>this.fromPandocBlock(c)),i=t.c[1][1];if(i.length>0){let c=i.map(l=>this.fromPandocBlock(l));o.push(...c)}let s={tag:"div",children:o};return r&&(s.attributes=r),s}case"LineBlock":{let r=[];for(let n=0;n<t.c.length;n++)n>0&&r.push({tag:"hard_break"}),r.push(...this.fromPandocInlines(t.c[n]));return{tag:"para",children:r}}case"Null":return{tag:"raw_block",format:"none",text:""};default:}return{tag:"raw_block",format:"error",text:"Could not convert "+t.t}}fromPandocRow(t,r,n,o){let i=ft(t[0]),s=t[1],c=[];for(let d=0;d<s.length;d++)c.push(this.fromPandocCell(s[d],r||d<n,o[d]));let l={tag:"row",head:r,children:c};return i&&(l.attributes=i),l}fromPandocCell(t,r,n){let o=[],i=ft(t[0]),s=t[1].t.slice(5).toLowerCase();s==="default"&&(s=n);let c=t[4];c.length>1||c.length===1&&!Yr(c[0])?(this.warn(new Fe.Warning("Skipping table cell with block-level content.")),o=[{tag:"str",text:"((content omitted))"}]):c[0]&&(o=this.fromPandocInlines(c[0].c));let l={tag:"cell",head:r,align:s,children:o};return i&&(l.attributes=i),l}fromPandoc(t){if(typeof t!="object")throw Error("Pandoc document must be an object");if(t["pandoc-api-version"])if(t.blocks){if(!t.meta)throw Error("Pandoc document lacks meta")}else throw Error("Pandoc document lacks blocks");else throw Error("Pandoc document lacks pandoc-api-version");return{tag:"doc",children:t.blocks.map(o=>this.fromPandocBlock(o)),footnotes:this.footnotes,references:{},autoReferences:{}}}},ol=function(e,t){return new Hr(t).toPandoc(e)};Ut.toPandoc=ol;var il=function(e,t){return new Jr(t).fromPandoc(e)};Ut.fromPandoc=il});var Ko=tt(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.renderDjot=void 0;var Tt=Ee(),Ho=Le(),Jo=function(e){let t=e.tag;return t==="space"||t==="soft_break"||t==="hard_break"},sl=function(e){return e.children[0]&&Jo(e.children[0])},al=function(e){return e.children[0]&&Jo(e.children[e.children.length-1])},Kr=function(e,t){let r=e.text.match(/(`+)/g),n={};if(r)for(let i in r)n[r[i].length]=!0;let o=t;for(;n[o];)o++;return"`".repeat(o)},Yo=function(e){if(e<0||e>=4e3)return"?";let t="";for(;e>0;)if(e>=1e3)t+="M",e-=1e3;else if(e>=900)t+="CM",e-=900;else if(e>=500)t+="D",e-=500;else if(e>=400)t+="CD",e-=400;else if(e>=100)t+="C",e-=100;else if(e>=90)t+="XC",e-=90;else if(e>=50)t+="L",e-=50;else if(e>=40)t+="XL",e-=40;else if(e>=10)t+="X",e-=10;else if(e==9)t+="IX",e-=9;else if(e>=5)t+="V",e-=5;else if(e==4)t+="IV",e-=4;else if(e>=1)t+="I",e-=1;else throw new Error("toRoman encountered x = "+e);return t},cl=function(e,t){let r=t.replace(/[a-zA-Z0-9]+/g,"$"),n=t.replace(/[.()]/g,""),o;switch(n){case"1":o=e.toString();break;case"a":o=String.fromCodePoint(96+e%26);break;case"A":o=String.fromCodePoint(64+e%26);break;case"i":o=Yo(e).toLowerCase();break;case"I":o=Yo(e);break;default:throw new Error("formatNumber encountered unknown style "+t)}return r.replace("$",o)},Xr=class{constructor(t,r={}){this.prefixes=[],this.buffer=[],this.startOfLine=!0,this.endOfPrefix=0,this.column=0,this.needsBlankLine=!1,this.handlers={doc:n=>{this.renderChildren(n.children),this.prefixes=[],this.cr(),Object.keys(n.references).length>0&&(this.cr(),this.newline());for(let s in n.references)this.renderNode(n.references[s]);let i=Object.keys(n.footnotes).length>0;for(let s in n.footnotes)this.renderNode(n.footnotes[s]);this.prefixes=[],this.cr()},footnote:n=>{this.lit("[^"+n.label+"]:"),this.space(),this.needsBlankLine=!1,this.prefixes.push("  "),this.renderChildren(n.children),this.prefixes.pop(),this.blankline()},reference:n=>{this.lit("["),this.lit(n.label),this.lit("]:"),this.prefixes.push("  "),this.space(),this.lit(n.destination),this.wrap(),this.prefixes.pop(),this.blankline()},para:n=>{this.renderChildren(n.children),this.blankline()},thematic_break:()=>{this.lit("* * * * *"),this.blankline()},div:n=>{this.lit(":::"),this.cr(),this.renderChildren(n.children),this.cr(),this.lit(":::"),this.blankline()},heading:n=>{let o="#".repeat(n.level);this.lit(o+" "),this.prefixes.push(o+" "),this.renderChildren(n.children),this.prefixes.pop(),this.blankline()},block_quote:n=>{this.prefixes.push("> "),this.lit("> "),this.renderChildren(n.children),this.prefixes.pop(),this.blankline()},section:n=>{this.renderChildren(n.children)},code_block:n=>{let o=Kr(n,3);this.lit(o),n.lang&&this.lit(" "+n.lang),this.cr(),this.litlines(n.text),this.cr(),this.lit(o),this.blankline()},raw_block:n=>{let o=Kr(n,3);this.lit(o),this.lit(" ="+n.format),this.cr(),this.litlines(n.text),this.cr(),this.lit(o),this.blankline()},definition_list:n=>{let o=n.children;for(let i=0;i<o.length;i++){let s=o[i];i>0&&this.newline(),this.lit(":"),this.needsBlankLine=!1,this.space(),this.prefixes.push(" ".repeat(2)),this.renderChildren(s.children),this.prefixes.pop()}},ordered_list:n=>{let o=n.style,i=n.start||1,s=n.children,c=n.tight;for(let l=0;l<s.length;l++){let d=s[l];l>0&&(this.cr(),c||this.newline());let m=cl(i+l,o);this.lit(m),this.needsBlankLine=!1,this.space(),this.prefixes.push(" ".repeat(m.length+1)),this.renderChildren(d.children),this.prefixes.pop()}c&&this.blankline()},bullet_list:n=>{let o=n.children,i=n.tight;for(let s=0;s<o.length;s++){let c=o[s];s>0&&(this.cr(),i||this.newline());let l=n.style;this.lit(l),this.needsBlankLine=!1,this.space(),this.prefixes.push(" ".repeat(l.length+1)),this.renderChildren(c.children),this.prefixes.pop()}i&&this.blankline()},task_list:n=>{let o=n.children,i=n.tight;for(let s=0;s<o.length;s++){let c=o[s];s>0&&(this.cr(),i||this.newline()),this.needsBlankLine=!1,this.lit(`- [${c.checkbox==="checked"?"X":" "}]`),this.space(),this.prefixes.push(" ".repeat(6)),this.renderChildren(c.children),this.prefixes.pop()}i&&this.blankline()},term:n=>{this.renderChildren(n.children),this.blankline()},definition:n=>{this.renderChildren(n.children)},table:n=>{let o=n.children.filter(Tt.isCaption),i=n.children.filter(Tt.isRow);for(let s=0;s<i.length;s++){let c=i[s];if("head"in c&&!c.head&&s>0&&i[s-1].head){let l=i[s-1];for(let d=0;d<l.children.length;d++){switch(d===0&&this.lit("|"),l&&l.children[d].align){case"left":this.lit(":--");break;case"right":this.lit("--:");break;case"center":this.lit(":-:");break;default:this.lit("---")}this.lit("|")}this.cr()}for(let l=0;l<c.children.length;l++){let d=c.children[l];l===0&&this.lit("|"),this.noWrap(()=>{d.tag==="cell"&&this.renderChildren(d.children)}),this.lit("|")}this.cr()}o.length>0&&o[0].children.length>0&&(this.newline(),this.lit("^ "),this.needsBlankLine=!1,this.prefixes.push("  "),this.renderChildren(o[0].children),this.prefixes.pop(),this.blankline()),this.blankline()},str:n=>{n.text.split(/  */).forEach((o,i)=>{i>0&&this.space(),this.out(o)})},space:()=>{this.space()},soft_break:()=>{this.soft_break()},smart_punctuation:n=>{this.lit(n.text)},non_breaking_space:()=>{this.lit("\\ ")},single_quoted:this.inlineContainer("'"),double_quoted:this.inlineContainer('"'),emph:this.inlineContainer("_"),strong:this.inlineContainer("*"),superscript:this.inlineContainer("^"),subscript:this.inlineContainer("~"),mark:this.inlineContainer("=",!0),delete:this.inlineContainer("-",!0),insert:this.inlineContainer("+",!0),footnote_reference:n=>{this.lit("[^"+n.text+"]")},symb:n=>{this.lit(":"+n.alias+":")},email:n=>{this.lit("<"+n.text+">")},url:n=>{this.lit("<"+n.text+">")},span:n=>{this.lit("["),this.renderChildren(n.children),this.lit("]")},link:n=>{this.lit("["),this.renderChildren(n.children),this.lit("]"),n.reference?(this.lit("["),n.reference!==(0,Ho.getStringContent)(n)&&this.lit(n.reference),this.lit("]")):n.destination?(this.lit("("),this.lit(n.destination),this.lit(")")):this.lit("()")},image:n=>{this.lit("!["),this.renderChildren(n.children),this.lit("]"),n.reference?(this.lit("["),n.reference!==(0,Ho.getStringContent)(n)&&this.lit(n.reference),this.lit("]")):n.destination?(this.lit("("),this.lit(n.destination),this.lit(")")):this.lit("()")},raw_inline:n=>{this.verbatimNode(n),this.lit("{="+n.format+"}")},verbatim:n=>{this.verbatimNode(n)},inline_math:n=>{this.lit("$"),this.verbatimNode(n)},display_math:n=>{this.lit("$$"),this.verbatimNode(n)}},this.doc=t,this.wrapWidth=(r==null?void 0:r.wrapWidth)||0}escape(t){return t=t.replace(/([~`'"${}[\]^<>\\*_]|-(?=-)|!(=\[)|\.(?=\.))/g,"\\$1"),(this.column===0||this.column===this.endOfPrefix)&&(t=t.replace(/^#/,"\\#")),t}out(t){this.lit(this.escape(t))}doBlankLines(){this.needsBlankLine&&(this.cr(),this.newline(),this.needsBlankLine=!1)}lit(t){this.buffer.push(t),this.column+=t.length,this.startOfLine=!1}blankline(){this.needsBlankLine=!0}newline(){if(this.endOfPrefix===this.column)for(;/  *$|^$/.test(this.buffer[this.buffer.length-1]);)this.buffer[this.buffer.length-1]=this.buffer[this.buffer.length-1].replace(/  *$/,""),this.buffer[this.buffer.length-1]===""&&this.buffer.pop();if(this.endOfPrefix=0,this.column=0,this.buffer.push(`
`),this.prefixes.length>0){for(let t=0,r=this.prefixes.length;t<r;t++)this.buffer.push(this.prefixes[t]),this.column+=this.prefixes[t].length;this.endOfPrefix=this.column}this.startOfLine=!0}cr(){this.startOfLine||this.newline()}wrap(){if(this.wrapWidth<=0)return;let t=this.buffer.length-1;if(!this.startOfLine&&this.buffer.length>0&&this.column>this.wrapWidth){let r;for(;t>=0&&(r=this.buffer[t],r!==" ");){if(/^[ \r\n]+$/.test(r))return;t--}}if(t<this.buffer.length-1){let r=this.buffer.splice(t+1);this.buffer[this.buffer.length-1]===" "&&this.buffer.pop(),this.newline(),this.startOfLine=!0;for(let n=0;n<r.length;n++)this.buffer.push(r[n]),this.column+=r[n].length,this.startOfLine=!1}}space(){this.wrap(),this.lit(" ")}soft_break(){this.wrapWidth===0?this.newline():this.space()}needsBraces(t){return sl(t)||al(t)||this.buffer.length>0&&/\w$/.test(this.buffer[this.buffer.length-1])}noWrap(t){let r=this.wrapWidth;this.wrapWidth=-1,t(),this.wrapWidth=r}inlineContainer(t,r){let n=this;return function(o){r=r||n.needsBraces(o),r&&n.lit("{"),n.lit(t),n.renderChildren(o.children),n.lit(t),r&&n.lit("}")}}litlines(t){let r=t.split(/\r?\n/);r[r.length-1]===""&&r.pop();for(let n of r)this.lit(n),this.cr()}verbatimNode(t){let r=Kr(t,1);this.lit(r),/^`/.test(t.text)&&this.lit(" "),this.lit(t.text),/`$/.test(t.text)&&this.lit(" "),this.lit(r)}renderChildren(t){for(let r=0,n=t.length;r<n;r++)this.renderNode(t[r]);t[0]&&!(0,Tt.isBlock)(t[0])&&this.wrap()}renderNode(t){this.doBlankLines();let r=this.handlers[t.tag];if(r)t.attributes&&(0,Tt.isBlock)(t)&&(this.renderAttributes(t),this.cr()),r(t),t.attributes&&(0,Tt.isInline)(t)&&this.renderAttributes(t);else throw new Error("No renderer defined for node type "+t.tag)}renderAttributes(t){if(!t.attributes||Object.keys(t.attributes).length===0)return;let r=t.attributes;this.lit("{");let n=!0;(0,Tt.isBlock)(t)&&this.prefixes.push(" ");for(let o in r){if(n||this.space(),o==="id")this.lit("#"),this.lit(r[o]);else if(o==="class"){let i=r[o].split(/  */);for(let s=0;s<i.length;s++)s>0&&this.space(),this.lit("."),this.lit(i[s])}else this.lit(o),this.lit('="'),this.out(r[o]),this.lit('"');n=!1}(0,Tt.isBlock)(t)&&this.prefixes.pop(),this.lit("}")}render(){return this.renderNode(this.doc),this.buffer.join("")}},ll=function(e,t={}){return new Xr(e,t).render()};Ge.renderDjot=ll});var Xo=tt(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});je.version=void 0;je.version="0.3.1"});var ri=tt(U=>{"use strict";Object.defineProperty(U,"__esModule",{value:!0});U.isInline=U.isBlock=U.version=U.renderDjot=U.toPandoc=U.fromPandoc=U.applyFilter=U.HTMLRenderer=U.renderHTML=U.parseEvents=U.renderAST=U.parse=void 0;var Qo=Le();Object.defineProperty(U,"parse",{enumerable:!0,get:function(){return Qo.parse}});Object.defineProperty(U,"renderAST",{enumerable:!0,get:function(){return Qo.renderAST}});var dl=Rr();Object.defineProperty(U,"parseEvents",{enumerable:!0,get:function(){return dl.parseEvents}});var Zo=Uo();Object.defineProperty(U,"renderHTML",{enumerable:!0,get:function(){return Zo.renderHTML}});Object.defineProperty(U,"HTMLRenderer",{enumerable:!0,get:function(){return Zo.HTMLRenderer}});var hl=Vo();Object.defineProperty(U,"applyFilter",{enumerable:!0,get:function(){return hl.applyFilter}});var ti=Wo();Object.defineProperty(U,"fromPandoc",{enumerable:!0,get:function(){return ti.fromPandoc}});Object.defineProperty(U,"toPandoc",{enumerable:!0,get:function(){return ti.toPandoc}});var ul=Ko();Object.defineProperty(U,"renderDjot",{enumerable:!0,get:function(){return ul.renderDjot}});var pl=Xo();Object.defineProperty(U,"version",{enumerable:!0,get:function(){return pl.version}});var ei=Ee();Object.defineProperty(U,"isBlock",{enumerable:!0,get:function(){return ei.isBlock}});Object.defineProperty(U,"isInline",{enumerable:!0,get:function(){return ei.isInline}})});var Vs=tt((x1,rr)=>{(function(){var e=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],t=typeof window<"u",r=t&&window.mozInnerScreenX!=null;function n(o,i,s){if(!t)throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");var c=s&&s.debug||!1;if(c){var l=document.querySelector("#input-textarea-caret-position-mirror-div");l&&l.parentNode.removeChild(l)}var d=document.createElement("div");d.id="input-textarea-caret-position-mirror-div",document.body.appendChild(d);var m=d.style,y=window.getComputedStyle?window.getComputedStyle(o):o.currentStyle,C=o.nodeName==="INPUT";m.whiteSpace="pre-wrap",C||(m.wordWrap="break-word"),m.position="absolute",c||(m.visibility="hidden"),e.forEach(function(E){C&&E==="lineHeight"?m.lineHeight=y.height:m[E]=y[E]}),r?o.scrollHeight>parseInt(y.height)&&(m.overflowY="scroll"):m.overflow="hidden",d.textContent=o.value.substring(0,i),C&&(d.textContent=d.textContent.replace(/\s/g,"\xA0"));var P=document.createElement("span");P.textContent=o.value.substring(i)||".",d.appendChild(P);var N={top:P.offsetTop+parseInt(y.borderTopWidth),left:P.offsetLeft+parseInt(y.borderLeftWidth),height:parseInt(y.lineHeight)};return c?P.style.backgroundColor="#aaa":document.body.removeChild(d),N}typeof rr<"u"&&typeof rr.exports<"u"?rr.exports=n:t&&(window.getCaretCoordinates=n)})()});var Pt=e=>Array.isArray(e);var na=e=>({el:document.querySelector(e),elements:document.querySelectorAll(e),placeholder(t){return this.el.placeholder=t,this},getValue(){return this.el.value},insertAtCaret(t){return this.el.setRangeText(t,this.el.selectionStart,this.el.selectionEnd,"end"),this},setValue(t){this.el.value=t;let r=new Event("input",{bubbles:!0,cancelable:!0});return this.el.dispatchEvent(r),this},innerHTML(t){return this.el.innerHTML=t,this},html(t){return this.el.innerHTML="",this.append(t),this},append(t){return(Pt(t)?t:[t]).forEach(n=>{let o=Dt(n)?n:document.createTextNode(n);this.el.appendChild(o)}),this},appendListElement(t){let r=document.createElement("LI");return r.appendChild(document.createTextNode(t)),this.el.appendChild(r),this},removeClass(t){return this.el.classList.remove(t),this},removeClasses(t=[]){return t.map(r=>this.removeClass(r)),this},addClass(t){return this.el.classList.add(t),this},hasClass(t){return(" "+this.el.className+" ").indexOf(" "+t+" ")>-1},show(t=!0){return t?this.removeClass("hidden"):this.hide(),this},hide(){return this.addClass("hidden"),this},toggle(t="hidden"){return this.hasClass(t)?this.removeClass(t):this.addClass(t),this},focus(){return this.el.focus(),this},listenAll(t,r){return Array.prototype.slice.call(this.elements).map(o=>{o.addEventListener(t,i=>r(i.srcElement))}),this},listen(t,r){return this.el.addEventListener(t,n=>r(n,this)),this},click(){this.el&&this.el.click()},checked(t){return this.el.checked=!!t,this},disable(t=!0){return this.el.disabled=t,this}}),Dt=e=>{try{return e instanceof HTMLElement}catch{return typeof e=="object"&&e.nodeType===1&&typeof e.style=="object"&&typeof e.ownerDocument=="object"}},g=na;var pr={info:"info",success:"success",error:"error",warning:"warning"},fr=g("#notification"),ur=()=>{fr.removeClasses(Object.values(pr))};fr.el.onclick=()=>ur();var oa=()=>Object.values(pr).reduce((e,t)=>({...e,[t](r){this.showNotification(r,t)}}),{}),ia=(e=5)=>({autohideDuration:e,timer:void 0,removeAfter(){this.timer=self.setTimeout(()=>{ur()},this.autohideDuration*1e3)},showNotification(t,r=pr.info){ur(),fr.innerHTML(t).addClass(r),clearTimeout(this.timer),this.removeAfter()},...oa()}),sa=ia(),M=sa;var aa=()=>{let e=localStorage.getItem("miropad.user");e?M.info(`\u{1F917} Happy to see you again from ${e}`):M.info(`<h1>Welcome \u{1F44B} \u{1F603} </h1>
       <p>Use  Ctrl+S:  to save your note<p/>
       <p>& Ctrl+P: to format a JSON doc<p/>
      `,100),localStorage.setItem("miropad.user",new Date().toLocaleDateString())},Gn=aa;var ca={set:function(e,t){return localStorage.setItem(e,t),this},update:function(e,t){let r=JSON.parse(this.get(e));return localStorage.setItem(e,JSON.stringify({...r,...t})),this},remove:function(e){return localStorage.removeItem(e),this},get:function(e){return Pt(e)?e.reduce((t,r)=>({...t,[r]:this.get(r)}),{}):localStorage.getItem(e)},parse:function(e){let t=this.get(e);return JSON.parse(t)},getDictionary:function(){let e=localStorage.getItem("__dictionary__");return e?JSON.parse(e):[]},removeFromDictionary:function(e){let r=this.getDictionary().filter(n=>n!==e);localStorage.setItem("__dictionary__",JSON.stringify(r))},saveToDictionary:async function(e){if(e.length)try{let t=e.toLowerCase().replace(/[^a-zA-Z--]/g," "),r=await this.getDictionary(),n=[...t.split(" ").filter(i=>i.length>3),...r],o=[...new Set(n)];localStorage.setItem("__dictionary__",JSON.stringify(o))}catch(t){M.error(`\u{1F631} Something went wrong while trying to save to local storage ${t}`)}else M.warning("\u{1F615} Nothing to save!");return this}},I=ca;var dt={github:{client_id:"70c1955dfe4914c52c10",request_state:"miro-pad"},auth_service:"https://vercel-api-phi.vercel.app/api/auth",mail_service:{api:"https://vercel-api-phi.vercel.app/api/mail",signature:`Theo Mironidis <br/>
    Software Engineer <br/>
    https://teomrd.github.io`},file_service:{api:"https://vercel-api-phi.vercel.app/api/upload"}};var ue=(e,t=I.get("authToken"))=>fetch(`https://api.github.com/gists/${e}`,{headers:{Authorization:`token ${t}`}}).then(r=>{if(!r.ok)throw Error(r.statusText);return r.json()}),jn=(e=I.get("authToken"))=>fetch("https://api.github.com/gists",{headers:{Authorization:`token ${e}`}}).then(t=>{if(!t.ok)throw Error(t.statusText);return t.json()}),$n=async(e,t=I.get("gistId"),r=I.get("authToken"))=>{let n=await fetch(`https://api.github.com/gists/${t}`,{method:"PATCH",headers:{Authorization:`token ${r}`,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({files:{[e]:null},description:"MiroPad Gist",public:!1})});if(!n.ok)throw new Error(n.statusText);let o=await n.json();return M.info(`${e} deleted on Gist!`),o},Rn=(e=lt(),t=I.get("gistId"),r=I.get("authToken"))=>{if(t&&r){let n=e.reduce((o,{id:i,text:s,deleted:c})=>({...o,[i]:c?null:{content:s}}),{});return fetch(`https://api.github.com/gists/${t}`,{method:"PATCH",headers:{Authorization:`token ${r}`,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({files:n,description:"MiroPad Gist",public:!1})}).then(o=>{if(!o.ok)throw new Error(o.statusText);return o.json()}).then(o=>(e.map(({id:i,deleted:s})=>{s&&localStorage.removeItem(i)}),o))}},Un=async(e=I.get("authToken"))=>{let r=lt().reduce((i,s)=>({...i,[s.id]:{content:s.text}}),{}),n=await fetch("https://api.github.com/gists",{method:"POST",headers:{Authorization:`token ${e}`,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({files:r,description:"MiroPad Gist",public:!1})});if(!n.ok)throw Error(n.statusText);return await n.json()},Vn=(e,t)=>fetch(`${dt.auth_service}?state=${t}&code=${e}`,{headers:{Accept:"application/json","Content-Type":"application/json"}}).then(r=>{if(!r.ok)throw Error(r.statusText);return r.json()}).then(r=>r),qn=async({note:e,token:t=I.get("authToken")})=>{let r=await fetch("https://api.github.com/gists",{method:"POST",headers:{Authorization:`token ${t}`,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({files:{[e.id]:{content:e.text}},description:"MiroPad Gist",public:!0})});if(!r.ok)throw Error(r.statusText);return await r.json()};var Zh=new Uint8Array(0);function Wn(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function Lt(e){if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function la(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<e.length;o++){var i=e.charAt(o),s=i.charCodeAt(0);if(r[s]!==255)throw new TypeError(i+" is ambiguous");r[s]=o}var c=e.length,l=e.charAt(0),d=Math.log(c)/Math.log(256),m=Math.log(256)/Math.log(c);function y(N){if(N instanceof Uint8Array||(ArrayBuffer.isView(N)?N=new Uint8Array(N.buffer,N.byteOffset,N.byteLength):Array.isArray(N)&&(N=Uint8Array.from(N))),!(N instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(N.length===0)return"";for(var E=0,_=0,x=0,v=N.length;x!==v&&N[x]===0;)x++,E++;for(var $=(v-x)*m+1>>>0,k=new Uint8Array($);x!==v;){for(var q=N[x],W=0,S=$-1;(q!==0||W<_)&&S!==-1;S--,W++)q+=256*k[S]>>>0,k[S]=q%c>>>0,q=q/c>>>0;if(q!==0)throw new Error("Non-zero carry");_=W,x++}for(var Z=$-_;Z!==$&&k[Z]===0;)Z++;for(var at=l.repeat(E);Z<$;++Z)at+=e.charAt(k[Z]);return at}function C(N){if(typeof N!="string")throw new TypeError("Expected String");if(N.length===0)return new Uint8Array;var E=0;if(N[E]!==" "){for(var _=0,x=0;N[E]===l;)_++,E++;for(var v=(N.length-E)*d+1>>>0,$=new Uint8Array(v);N[E];){var k=r[N.charCodeAt(E)];if(k===255)return;for(var q=0,W=v-1;(k!==0||q<x)&&W!==-1;W--,q++)k+=c*$[W]>>>0,$[W]=k%256>>>0,k=k/256>>>0;if(k!==0)throw new Error("Non-zero carry");x=q,E++}if(N[E]!==" "){for(var S=v-x;S!==v&&$[S]===0;)S++;for(var Z=new Uint8Array(_+(v-S)),at=_;S!==v;)Z[at++]=$[S++];return Z}}}function P(N){var E=C(N);if(E)return E;throw new Error(`Non-${t} character`)}return{encode:y,decodeUnsafe:C,decode:P}}var da=la,ha=da,Hn=ha;var mr=class{constructor(t,r,n){F(this,"name");F(this,"prefix");F(this,"baseEncode");this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},gr=class{constructor(t,r,n){F(this,"name");F(this,"prefix");F(this,"baseDecode");F(this,"prefixCodePoint");this.name=t,this.prefix=r;let o=r.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Yn(this,t)}},br=class{constructor(t){F(this,"decoders");this.decoders=t}or(t){return Yn(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n!=null)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function Yn(e,t){return new br({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}var wr=class{constructor(t,r,n,o){F(this,"name");F(this,"prefix");F(this,"baseEncode");F(this,"baseDecode");F(this,"encoder");F(this,"decoder");this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new mr(t,r,n),this.decoder=new gr(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};function Jn({name:e,prefix:t,encode:r,decode:n}){return new wr(e,t,r,n)}function Ot({name:e,prefix:t,alphabet:r}){let{encode:n,decode:o}=Hn(r,e);return Jn({prefix:t,name:e,encode:n,decode:i=>Lt(o(i))})}function ua(e,t,r,n){let o={};for(let m=0;m<t.length;++m)o[t[m]]=m;let i=e.length;for(;e[i-1]==="=";)--i;let s=new Uint8Array(i*r/8|0),c=0,l=0,d=0;for(let m=0;m<i;++m){let y=o[e[m]];if(y===void 0)throw new SyntaxError(`Non-${n} character`);l=l<<r|y,c+=r,c>=8&&(c-=8,s[d++]=255&l>>c)}if(c>=r||255&l<<8-c)throw new SyntaxError("Unexpected end of data");return s}function pa(e,t,r){let n=t[t.length-1]==="=",o=(1<<r)-1,i="",s=0,c=0;for(let l=0;l<e.length;++l)for(c=c<<8|e[l],s+=8;s>r;)s-=r,i+=t[o&c>>s];if(s!==0&&(i+=t[o&c<<r-s]),n)for(;i.length*r&7;)i+="=";return i}function ht({name:e,prefix:t,bitsPerChar:r,alphabet:n}){return Jn({prefix:t,name:e,encode(o){return pa(o,n,r)},decode(o){return ua(o,n,r,e)}})}var Kt=ht({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),au=ht({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),cu=ht({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),lu=ht({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),du=ht({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),hu=ht({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),uu=ht({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),pu=ht({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),fu=ht({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var pe=Ot({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),bu=Ot({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var bt=Ot({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),vu=Ot({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var fa=Qn,Kn=128,ma=127,ga=~ma,ba=Math.pow(2,31);function Qn(e,t,r){t=t||[],r=r||0;for(var n=r;e>=ba;)t[r++]=e&255|Kn,e/=128;for(;e&ga;)t[r++]=e&255|Kn,e>>>=7;return t[r]=e|0,Qn.bytes=r-n+1,t}var wa=yr,ya=128,Xn=127;function yr(e,n){var r=0,n=n||0,o=0,i=n,s,c=e.length;do{if(i>=c)throw yr.bytes=0,new RangeError("Could not decode varint");s=e[i++],r+=o<28?(s&Xn)<<o:(s&Xn)*Math.pow(2,o),o+=7}while(s>=ya);return yr.bytes=i-n,r}var va=Math.pow(2,7),xa=Math.pow(2,14),ka=Math.pow(2,21),Ca=Math.pow(2,28),Sa=Math.pow(2,35),_a=Math.pow(2,42),Ta=Math.pow(2,49),Aa=Math.pow(2,56),Ma=Math.pow(2,63),Na=function(e){return e<va?1:e<xa?2:e<ka?3:e<Ca?4:e<Sa?5:e<_a?6:e<Ta?7:e<Aa?8:e<Ma?9:10},Ea={encode:fa,decode:wa,encodingLength:Na},Ia=Ea,Xt=Ia;function Qt(e,t=0){return[Xt.decode(e,t),Xt.decode.bytes]}function zt(e,t,r=0){return Xt.encode(e,t,r),t}function Bt(e){return Xt.encodingLength(e)}function Zt(e,t){let r=t.byteLength,n=Bt(e),o=n+Bt(r),i=new Uint8Array(o+r);return zt(e,i,0),zt(r,i,n),i.set(t,o),new Ft(e,r,t,i)}function to(e){let t=Lt(e),[r,n]=Qt(t),[o,i]=Qt(t.subarray(n)),s=t.subarray(n+i);if(s.byteLength!==o)throw new Error("Incorrect length");return new Ft(r,o,s,t)}function eo(e,t){if(e===t)return!0;{let r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&Wn(e.bytes,r.bytes)}}var Ft=class{constructor(t,r,n,o){F(this,"code");F(this,"size");F(this,"digest");F(this,"bytes");this.code=t,this.size=r,this.digest=n,this.bytes=o}};function no(e,t){let{bytes:r,version:n}=e;switch(n){case 0:return Da(r,vr(e),t??bt.encoder);default:return La(r,vr(e),t??Kt.encoder)}}var oo=new WeakMap;function vr(e){let t=oo.get(e);if(t==null){let r=new Map;return oo.set(e,r),r}return t}var so,fe=class e{constructor(t,r,n,o){F(this,"code");F(this,"version");F(this,"multihash");F(this,"bytes");F(this,"/");F(this,so,"CID");this.code=r,this.version=t,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:r}=this;if(t!==te)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Oa)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return e.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=Zt(t,r);return e.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return e.equals(this,t)}static equals(t,r){let n=r;return n!=null&&t.code===n.code&&t.version===n.version&&eo(t.multihash,n.multihash)}toString(t){return no(this,t)}toJSON(){return{"/":no(this)}}link(){return this}[(so=Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"))](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let r=t;if(r instanceof e)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:i,bytes:s}=r;return new e(n,o,i,s??io(n,o,i.bytes))}else if(r[za]===!0){let{version:n,multihash:o,code:i}=r,s=to(o);return e.create(n,i,s)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==te)throw new Error(`Version 0 CID must use dag-pb (code: ${te}) block encoding`);return new e(t,r,n,n.bytes)}case 1:{let o=io(t,r,n.bytes);return new e(t,r,n,o)}default:throw new Error("Invalid version")}}static createV0(t){return e.create(0,te,t)}static createV1(t,r){return e.create(1,t,r)}static decode(t){let[r,n]=e.decodeFirst(t);if(n.length!==0)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=e.inspectBytes(t),n=r.size-r.multihashSize,o=Lt(t.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let i=o.subarray(r.multihashSize-r.digestSize),s=new Ft(r.multihashCode,r.digestSize,i,o);return[r.version===0?e.createV0(s):e.createV1(r.codec,s),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[y,C]=Qt(t.subarray(r));return r+=C,y},o=n(),i=te;if(o===18?(o=0,r=0):i=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let s=r,c=n(),l=n(),d=r+l,m=d-s;return{version:o,codec:i,multihashCode:c,digestSize:l,multihashSize:m,size:d}}static parse(t,r){let[n,o]=Pa(t,r),i=e.decode(o);if(i.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return vr(i).set(n,t),i}};function Pa(e,t){switch(e[0]){case"Q":{let r=t??bt;return[bt.prefix,r.decode(`${bt.prefix}${e}`)]}case bt.prefix:{let r=t??bt;return[bt.prefix,r.decode(e)]}case Kt.prefix:{let r=t??Kt;return[Kt.prefix,r.decode(e)]}case pe.prefix:{let r=t??pe;return[pe.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}}function Da(e,t,r){let{prefix:n}=r;if(n!==bt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=t.get(n);if(o==null){let i=r.encode(e).slice(1);return t.set(n,i),i}else return o}function La(e,t,r){let{prefix:n}=r,o=t.get(n);if(o==null){let i=r.encode(e);return t.set(n,i),i}else return o}var te=112,Oa=18;function io(e,t,r){let n=Bt(e),o=n+Bt(t),i=new Uint8Array(o+r.byteLength);return zt(e,i,0),zt(t,i,n),i.set(r,o),i}var za=Symbol.for("@ipld/js-cid/CID");var Ba=new TextEncoder,Du=new TextDecoder;var ao=512;function co(e){return Ba.encode(JSON.stringify(e))}function kr({name:e,code:t,encode:r}){return new xr(e,t,r)}var xr=class{constructor(t,r,n){F(this,"name");F(this,"code");F(this,"encode");this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){let r=this.encode(t);return r instanceof Uint8Array?Zt(this.code,r):r.then(n=>Zt(this.code,n))}else throw Error("Unknown type, must be binary type")}};function lo(e){return async t=>new Uint8Array(await crypto.subtle.digest(e,t))}var ho=kr({name:"sha2-256",code:18,encode:lo("SHA-256")}),Bu=kr({name:"sha2-512",code:19,encode:lo("SHA-512")});var Ga=async e=>{let t=co(e),r=await ho.digest(t);return fe.create(1,ao,r).toString()},me=Ga;var ja=e=>{try{JSON.parse(e)}catch{return!1}return!0},ge=ja;var uo=()=>document.title.split("|")[0],Cr=e=>{let t=uo();document.title=t.trim()+" | "+e.trim(),g(".title h3").html(e.trim())},be=()=>{let e=uo();document.title=e,g("title").innerHTML("\u270D\uFE0F MiroPad v3.1.19"),g(".title h3").innerHTML('\u270D\uFE0F MiroPad <span class="version">v3.1.19</span>')};var O={baseUrl:`${globalThis.location.origin}${globalThis.location.pathname}`,get:function(){return globalThis.location.href},getPageId:function(e=globalThis.location.href){return new URL(e).hash.slice(1).split("?")[0]||null},getSearchParams:function(e=globalThis.location.href){let n=new URL(e).href.split("?")[1]||"";return new URLSearchParams(n)},getParamsObject:function(e=globalThis.location.href){let t=this.getSearchParams(e),r={};for(let n of t.keys())r={...r,[n]:this.getSearchParam(n,e)};return r},getSearchParam(e,t=globalThis.location.href){return this.getSearchParams(t).get(e)},deleteParam:function(e){let t=this.getSearchParams();Array.isArray(e)?e.forEach(o=>{t.delete(o)}):t.delete(e);let{pathname:r}=globalThis.location,n=this.getPageId();return globalThis.location.assign(`${n?`#${n}`:r}${t.toString()?`?${t.toString()}`:""}`)},set:function(e=this.getPageId(),t=this.getParamsObject()){let r={...this.getParamsObject(),...t},n=new URLSearchParams(r);return globalThis.location.assign(`#${e}?${n.toString()}`)}};var _t=(e=!0)=>{e?(g("#save").removeClass("unsaved"),g("#logo").removeClass("unsaved")):(g("#save").addClass("unsaved"),g("#logo").addClass("unsaved"))};var po=e=>{let t=encodeURIComponent(e);if(t.length===0)throw new Error("You need to start with a valid title for your note!");return t},we=e=>{let t=mo(e),r=Y(t);if(r){let{dateCreated:n}=r;return n}throw new Error(`Note "${e}" cannot found!`)},$a=e=>{let t=Y(e);t&&localStorage.setItem(e,JSON.stringify({title:t.title,deleted:!0,revisions:t.revisions}))},Y=(e=O.getPageId(),t)=>{let r;try{if(r=JSON.parse(I.get(e)),!r.revisions)throw new Error("This is not a note!")}catch{return null}let n=r?Object.values(r.revisions).reduce((i,s)=>s.dateCreated>i.dateCreated?s:i,{dateCreated:0}):{},o=t?r.revisions[t]:n;return e?{...r,id:e,...o||{},numberOfRevisions:r&&r.revisions?Object.keys(r.revisions).length:void 0,title:r.title}:null},fo=e=>{let t=Y();t&&(I.update(t.id,{disableSync:e}),M.info(`"${t.title}" cloud sync ${e?"disabled \u{1F636}":"enabled \u26A1\uFE0F"}`))},ye=(e=O.getPageId())=>{if(e){let t=O.getSearchParam("v")||void 0,r=Y(void 0,t);r&&(g("#revisions").html(`${r.numberOfRevisions} revision${r.numberOfRevisions>1?"s":""}`),Cr(r.title),g(".terminal").setValue(r.text)),r||M.error("404 Note not found \u{1F937}\u200D\u2642\uFE0F")}},ve=()=>{location.hash="",be(),g("#revisions").html(""),g(".terminal").setValue("").focus(),_t()},Gt=(e="")=>e.split(`
`)[0].trim().replace("#","").trim(),mo=e=>{let t=Gt(e);return po(t)},go=async e=>{if(e.length){let t=mo(e),r=Gt(e),n=Y(t);if(n===null)return xe(e);let{text:o}=n,i=await me(e),s=await me(o);if(i===s)return;let c=I.get(t),l=JSON.parse(c);I.set(t,JSON.stringify({...l,title:r,revisions:{...l&&l.revisions||{},[i]:{dateCreated:Date.now(),text:e}}}))}},xe=async(e=g(".terminal").getValue())=>{if(await I.saveToDictionary(e),e.length){let t=await me(e);try{let r=e.split(`
`)[0].trim().replace("#","").trim();Cr(r);let n=po(r),o=I.get(n),i=JSON.parse(o);I.set(n,JSON.stringify({...i,title:r,lines:e.split(`
`),revisions:{...i&&i.revisions||{},[t]:{dateCreated:Date.now(),text:e}}})),O.set(n,{v:t}),I.set("lastLocalUpdate",new Date),M.success("\u{1F44C} Note saved!"),_t()}catch(r){M.error(`\u{1F631} Something went wrong while trying to save to local storage ${r}`)}}else M.warning("\u{1F615} Nothing to save!")},lt=({includeDeleted:e=!1}={})=>Object.entries(localStorage).filter(([,t])=>typeof t=="string").filter(([t,r])=>!t.startsWith("__")&&ge(r)).map(([t,r])=>[t,JSON.parse(r)]).filter(([,t])=>!!t.title).reduce((t,[r])=>[...t,Y(r)],[]).filter(({deleted:t})=>e?!0:!t),bo=(e=null)=>e?lt().map(({id:r})=>Y(r)).filter(r=>r!==null).filter(({text:r})=>r.toLowerCase().includes(e.toLowerCase()))[0]:void 0,ke=()=>{if(confirm("Are you sure you want do that?")){let t=Y();ve(),t&&t.id&&($n(t.id),$a(t.id))}B.hide()};var wo=()=>!!I.get("authToken");var xt=({title:e,secondary:t,onclick:r,onSecondaryClick:n,icon:o},i=!1)=>{let s=document.createElement("LI");if(s.className=i?"selected":"",o){let d=o.cloneNode(!0);s.appendChild(d)}let c=Dt(e)?e:document.createTextNode(e);c.onclick=r,s.appendChild(c);let l=document.createElement("span");if(t){l.className="secondary";let d=Dt(t)?t:document.createTextNode(t);d.onclick=n,l.appendChild(d)}return s.appendChild(l),s};var yo=(e,t)=>{let r=e.toLowerCase().split(t),n=0;return r.reduce((o,i,s)=>[...o,...s===0?[i]:[t,i]],[]).filter(o=>o!=="").map(o=>{n=n+o.length;let i=n-o.length,s=i+o.length;return e.slice(i,s)})};var vo=e=>{let t=document.createElement("mark");return t.appendChild(document.createTextNode(e)),t},wt=({content:e="",highlight:t=""})=>{let r=document.createElement("div"),n=e.split(" "),o=t.toLowerCase().split(" ");return t.trim()===""?(r.appendChild(document.createTextNode(e)),r):(n.map(i=>{let s=o.map(c=>i.toLocaleLowerCase().includes(c)?c:void 0).filter(c=>c!==void 0);return{word:i,matches:s}}).forEach(({word:i,matches:s})=>{if(s.length>0){let c=s[0];if(i===c)r.appendChild(vo(` ${i}`));else{let d=yo(i,c).map(m=>m.toLowerCase()===c?vo(m):document.createTextNode(m));r.appendChild(document.createTextNode(" ")),d.forEach(m=>{r.appendChild(m)})}}else r.appendChild(document.createTextNode(` ${i} `))}),r)};var xo=()=>(M.info("You need to be authenticated!"),B.hide(),globalThis.location.replace(`https://github.com/login/oauth/authorize?client_id=${dt.github.client_id}&scope=gist&state=${dt.github.request_state}`)),ko=async e=>{M.info("Downloading my Gists!");let t=await jn(e);B.setState({mode:B.getModes().gists}),M.info("Select Gist to sync with");let r=t.sort((o,i)=>new Date(i.updated_at).getTime()-new Date(o.updated_at).getTime()).map(({description:o,updated_at:i,id:s})=>({title:wt({content:`${o}(${s})`}),secondary:i,onclick:async()=>{await I.set("gistId",s),M.success(`${o}(${s}) selected for synchronization!`),ee(),B.hide()}})),n=xt([{title:"Create a new Gist",onclick:async()=>{M.info("Syncing your MiroPads to a new Gist");try{let{id:o}=await Un();I.set("gistId",o),M.success("MiroPads synced to a new Gist \u{1F389}")}catch(o){M.error(o.message)}B.hide()}},...r]);g("#commands").html(""),g("#commands").append(n)},ee=async(e=I.get("gistId"))=>{if(I.get("authToken")&&e){g("#logo").addClass("loading");let{files:r}=await ue(e);Object.values(r).forEach(({content:n})=>{go(n)}),I.set("lastSync",new Date),M.success("\u2B07 MiroPad synced \u2705"),g("#logo").removeClass("loading")}},Co=async()=>{let e=O.getSearchParam("code"),t=O.getSearchParam("state");if(e&&t){g("#logo").addClass("loading"),M.info("\u{1F510} Authenticating...");try{let{token:r}=await Vn(e,t);I.set("authToken",r),M.info("\u26F3 You have been authenticated!"),O.deleteParam(["code","state"])}catch(r){M.error(r.message)}g("#logo").removeClass("loading")}};var Ra=async(e="no-titled")=>{let t={suggestedName:`${e}`,types:[{description:"MiroPad text notes",accept:{"text/plain":[".miropad"]}}]};return await globalThis.showSaveFilePicker(t)},Ua=async(e,t)=>{let r=await e.createWritable();await r.write(t),await r.close()},So=async(e,t)=>{try{let r=await Ra(t);await Ua(r,e)}catch{M.error("An error occurred trying to save the file.");return}},_o=(()=>{let e=document.createElement("a");return e.setAttribute("style","display: none"),e.setAttribute("id","download-to-file"),e.setAttribute("href","#"),document.body.appendChild(e),(t,r=`MiroPad-${new Date().toISOString()}.json`)=>{let n=JSON.stringify(t),o=new Blob([n],{type:"octet/stream"}),i=globalThis.URL.createObjectURL(o);e.href=i,e.download=r,e.click(),globalThis.URL.revokeObjectURL(i)}})();var $e=mn(ri()),Re=e=>(0,$e.renderHTML)((0,$e.parse)(e,{warn:t=>console.log(t.render())}),{overrides:{code_block:t=>`<pre><code class="language-${t.lang} ${t.lang}">${t.text}</code></pre>`}});var Qr=e=>{if(e.status.toString().slice(0,1)==="2")return e;throw new Error(e)},fl=(e="")=>`<!DOCTYPE htmlPUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html lang="en">
    <head>
      <meta http-equiv="Content-Type" content="text/html charset=UTF-8" />
      <style>
      img {
        border-style: none;
        max-width: 100%;
        box-sizing: content-box;
      }
      </style>
    </head>
    <table style="width:100%;background-color:#ffffff" align="center" border="0" cellPadding="0" cellSpacing="0" role="presentation">
      <tbody>
        <tr>
          <td>
            <div><!--[if mso | IE]>
              <table role="presentation" width="100%" align="center" style="max-width:37.5em;margin:0 auto;padding:20px 0 48px;width:560px;"><tr><td></td><td style="width:37.5em;background:#ffffff">
            <![endif]--></div>

            <div style="max-width:37.5em;margin:0 auto;padding:20px 0 48px;width:560px"><img alt="Theo Mironidis Logo" src="https://teomrd.github.io/miroFavicon.f0c5b85b.png" width="42" height="42" style="display:block;outline:none;border:none;text-decoration:none;width:42px;height:42px" />
              ${e}
              <hr style="width:100%;border:none;border-top:1px solid #eaeaea;border-color:#dfe1e4;margin:42px 0 26px" />
              <a target="_blank" style="color:#b4becc;text-decoration:none;font-family:-apple-system,BlinkMacSystemFont,&quot;Segoe UI&quot;,Roboto,Oxygen-Sans,Ubuntu,Cantarell,&quot;Helvetica Neue&quot;,sans-serif;font-size:14px" href="https://teomrd.github.io">
              ${dt.mail_service.signature}
              </a>
            </div>
            <div><!--[if mso | IE]>
            </td><td></td></tr></table>
            <![endif]--></div>
          </td>
        </tr>
      </tbody>
    </table>
  </html>`,ml=async(e,t,r="MiroPad note")=>{if(!e){M.error("\u{1F47B} No message to send, type something and try again! \u{1F913}");return}try{await fetch(`${dt.mail_service.api}`,{method:"POST",headers:{"x-secret-token":I.get("MIROPAD_SECRET_TOKEN"),accept:"application/json","content-type":"application/json"},body:JSON.stringify({to:t,subject:r,html:fl(e)})}).then(Qr).then(n=>n.json()),M.success("Email sent \u{1F680}")}catch{M.error("Error not went through \u{1F4A5}! Check your credentials and try again!")}},gl=()=>{let e=I.get("mail");if(e){let n=globalThis.prompt(`Mail ${e} again? (y)es/(no)`,"yeap");if(n===null)return n;if(n.slice(0,1).toLowerCase()==="y")return e}let t=globalThis.prompt("Where do you wanna send the mail to?"),r=globalThis.prompt("Do you wanna save that to your preferences for later on? (y)es/(no)","yeap");return r&&r.slice(0,1).toLowerCase()==="y"&&I.set("mail",t),t},ni=e=>{let t=gl();if(t===null){M.info("Sending mail cancelled \u{1F636}");return}M.info("Sending mail... \u{1F680}");let r=Gt(e),n=Re(e);ml(n,t,r)};var kt=async(e,t="\u{1F4CB} Copied to clipboard")=>{try{await navigator.clipboard.writeText(e),M.success(t)}catch(r){M.error(r.message)}};var Ue=(e,t,r)=>{let n=Pt(e)?e:[e],o=document.createElement("button");return o.setAttribute("type","button"),r&&o.setAttribute("id",r),n.forEach(i=>{typeof i=="string"?o.appendChild(document.createTextNode(i)):o.appendChild(i)}),o.onclick=i=>t(i),o};var Ve="comm",qe="rule",We="decl";var oi="@import";var ii="@keyframes";var si="@layer";var Zr=Math.abs,oe=String.fromCharCode;function He(e){return e.trim()}function ie(e,t,r){return e.replace(t,r)}function ai(e,t,r){return e.indexOf(t,r)}function At(e,t){return e.charCodeAt(t)|0}function Ct(e,t,r){return e.slice(t,r)}function et(e){return e.length}function ci(e){return e.length}function Vt(e,t){return t.push(e),e}var Ye=1,qt=1,li=0,it=0,J=0,Ht="";function Je(e,t,r,n,o,i,s,c){return{value:e,root:t,parent:r,type:n,props:o,children:i,line:Ye,column:qt,length:s,return:"",siblings:c}}function di(){return J}function hi(){return J=it>0?At(Ht,--it):0,qt--,J===10&&(qt=1,Ye--),J}function st(){return J=it<li?At(Ht,it++):0,qt++,J===10&&(qt=1,Ye++),J}function vt(){return At(Ht,it)}function se(){return it}function Ke(e,t){return Ct(Ht,e,t)}function Wt(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function ui(e){return Ye=qt=1,li=et(Ht=e),it=0,[]}function pi(e){return Ht="",e}function Xe(e){return He(Ke(it-1,tn(e===91?e+2:e===40?e+1:e)))}function fi(e){for(;(J=vt())&&J<33;)st();return Wt(e)>2||Wt(J)>3?"":" "}function mi(e,t){for(;--t&&st()&&!(J<48||J>102||J>57&&J<65||J>70&&J<97););return Ke(e,se()+(t<6&&vt()==32&&st()==32))}function tn(e){for(;st();)switch(J){case e:return it;case 34:case 39:e!==34&&e!==39&&tn(J);break;case 40:e===41&&tn(e);break;case 92:st();break}return it}function gi(e,t){for(;st()&&e+J!==57;)if(e+J===84&&vt()===47)break;return"/*"+Ke(t,it-1)+"*"+oe(e===47?e:st())}function bi(e){for(;!Wt(vt());)st();return Ke(e,it)}function vi(e){return pi(Qe("",null,null,null,[""],e=ui(e),0,[0],e))}function Qe(e,t,r,n,o,i,s,c,l){for(var d=0,m=0,y=s,C=0,P=0,N=0,E=1,_=1,x=1,v=0,$="",k=o,q=i,W=n,S=$;_;)switch(N=v,v=st()){case 40:if(N!=108&&At(S,y-1)==58){ai(S+=ie(Xe(v),"&","&\f"),"&\f",Zr(d?c[d-1]:0))!=-1&&(x=-1);break}case 34:case 39:case 91:S+=Xe(v);break;case 9:case 10:case 13:case 32:S+=fi(N);break;case 92:S+=mi(se()-1,7);continue;case 47:switch(vt()){case 42:case 47:Vt(bl(gi(st(),se()),t,r,l),l),(Wt(N||1)==5||Wt(vt()||1)==5)&&et(S)&&Ct(S,-1,void 0)!==" "&&(S+=" ");break;default:S+="/"}break;case 123*E:c[d++]=et(S)*x;case 125*E:case 59:case 0:switch(v){case 0:case 125:_=0;case 59+m:x==-1&&(S=ie(S,/\f/g,"")),P>0&&(et(S)-y||E===0&&N===47)&&Vt(P>32?yi(S+";",n,r,y-1,l):yi(ie(S," ","")+";",n,r,y-2,l),l);break;case 59:S+=";";default:if(Vt(W=wi(S,t,r,d,m,o,c,$,k=[],q=[],y,i),i),v===123)if(m===0)Qe(S,t,W,W,k,i,y,c,q);else switch(C===99&&At(S,3)===110?100:C){case 100:case 108:case 109:case 115:Qe(e,W,W,n&&Vt(wi(e,W,W,0,0,o,c,$,o,k=[],y,q),q),o,q,y,c,n?k:q);break;default:Qe(S,W,W,W,[""],q,0,c,q)}}d=m=P=0,E=x=1,$=S="",y=s;break;case 58:y=1+et(S),P=N;default:if(E<1){if(v==123)--E;else if(v==125&&E++==0&&hi()==125)continue}switch(S+=oe(v),v*E){case 38:x=m>0?1:(S+="\f",-1);break;case 44:c[d++]=(et(S)-1)*x,x=1;break;case 64:vt()===45&&(S+=Xe(st())),C=vt(),m=y=et($=S+=bi(se())),v++;break;case 45:N===45&&et(S)==2&&(E=0)}}return i}function wi(e,t,r,n,o,i,s,c,l,d,m,y){for(var C=o-1,P=o===0?i:[""],N=ci(P),E=0,_=0,x=0;E<n;++E)for(var v=0,$=Ct(e,C+1,C=Zr(_=s[E])),k=e;v<N;++v)(k=He(_>0?P[v]+" "+$:ie($,/&\f/g,P[v])))&&(l[x++]=k);return Je(e,t,r,o===0?qe:c,l,d,m,y)}function bl(e,t,r,n){return Je(e,t,r,Ve,oe(di()),Ct(e,2,-2),0,n)}function yi(e,t,r,n,o){return Je(e,t,r,We,Ct(e,0,n),Ct(e,n+1,-1),n,o)}function Ze(e,t){for(var r="",n=0;n<e.length;n++)r+=t(e[n],n,e,t)||"";return r}function xi(e,t,r,n){switch(e.type){case si:if(e.children.length)break;case oi:case We:return e.return=e.return||e.value;case Ve:return"";case ii:return e.return=e.value+"{"+Ze(e.children,n)+"}";case qe:if(!et(e.value=e.props.join(",")))return""}return et(r=Ze(e.children,n))?e.return=e.value+"{"+r+"}":""}var Ti="c4",wl=w(e=>/^\s*C4Context|C4Container|C4Component|C4Dynamic|C4Deployment/.test(e),"detector"),yl=w(async()=>{let{diagram:e}=await import("./c4Diagram-6F5ED5ID-HSVJYJ2V.js");return{id:Ti,diagram:e}},"loader"),vl={id:Ti,detector:wl,loader:yl},xl=vl,Ai="flowchart",kl=w((e,t)=>{var r,n;return((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="dagre-wrapper"||((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="elk"?!1:/^\s*graph/.test(e)},"detector"),Cl=w(async()=>{let{diagram:e}=await import("./flowDiagram-7ASYPVHJ-2GSTIMB6.js");return{id:Ai,diagram:e}},"loader"),Sl={id:Ai,detector:kl,loader:Cl},_l=Sl,Mi="flowchart-v2",Tl=w((e,t)=>{var r,n,o;return((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="dagre-d3"?!1:(((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="elk"&&(t.layout="elk"),/^\s*graph/.test(e)&&((o=t==null?void 0:t.flowchart)==null?void 0:o.defaultRenderer)==="dagre-wrapper"?!0:/^\s*flowchart/.test(e))},"detector"),Al=w(async()=>{let{diagram:e}=await import("./flowDiagram-7ASYPVHJ-2GSTIMB6.js");return{id:Mi,diagram:e}},"loader"),Ml={id:Mi,detector:Tl,loader:Al},Nl=Ml,Ni="er",El=w(e=>/^\s*erDiagram/.test(e),"detector"),Il=w(async()=>{let{diagram:e}=await import("./erDiagram-6RL3IURR-DJPCWB2Q.js");return{id:Ni,diagram:e}},"loader"),Pl={id:Ni,detector:El,loader:Il},Dl=Pl,Ei="gitGraph",Ll=w(e=>/^\s*gitGraph/.test(e),"detector"),Ol=w(async()=>{let{diagram:e}=await import("./gitGraphDiagram-NRZ2UAAF-6RII2WWD.js");return{id:Ei,diagram:e}},"loader"),zl={id:Ei,detector:Ll,loader:Ol},Bl=zl,Ii="gantt",Fl=w(e=>/^\s*gantt/.test(e),"detector"),Gl=w(async()=>{let{diagram:e}=await import("./ganttDiagram-NTVNEXSI-2XBS6JZP.js");return{id:Ii,diagram:e}},"loader"),jl={id:Ii,detector:Fl,loader:Gl},$l=jl,Pi="info",Rl=w(e=>/^\s*info/.test(e),"detector"),Ul=w(async()=>{let{diagram:e}=await import("./infoDiagram-A4XQUW5V-Y25OEDYB.js");return{id:Pi,diagram:e}},"loader"),Vl={id:Pi,detector:Rl,loader:Ul},Di="pie",ql=w(e=>/^\s*pie/.test(e),"detector"),Wl=w(async()=>{let{diagram:e}=await import("./pieDiagram-YF2LJOPJ-OIPKH2QL.js");return{id:Di,diagram:e}},"loader"),Hl={id:Di,detector:ql,loader:Wl},Li="quadrantChart",Yl=w(e=>/^\s*quadrantChart/.test(e),"detector"),Jl=w(async()=>{let{diagram:e}=await import("./quadrantDiagram-OS5C2QUG-WHI7VWYN.js");return{id:Li,diagram:e}},"loader"),Kl={id:Li,detector:Yl,loader:Jl},Xl=Kl,Oi="xychart",Ql=w(e=>/^\s*xychart-beta/.test(e),"detector"),Zl=w(async()=>{let{diagram:e}=await import("./xychartDiagram-6QU3TZC5-ZO2HMEXQ.js");return{id:Oi,diagram:e}},"loader"),td={id:Oi,detector:Ql,loader:Zl},ed=td,zi="requirement",rd=w(e=>/^\s*requirement(Diagram)?/.test(e),"detector"),nd=w(async()=>{let{diagram:e}=await import("./requirementDiagram-MIRIMTAZ-EN3I36MB.js");return{id:zi,diagram:e}},"loader"),od={id:zi,detector:rd,loader:nd},id=od,Bi="sequence",sd=w(e=>/^\s*sequenceDiagram/.test(e),"detector"),ad=w(async()=>{let{diagram:e}=await import("./sequenceDiagram-G6AWOVSC-WHUALXLJ.js");return{id:Bi,diagram:e}},"loader"),cd={id:Bi,detector:sd,loader:ad},ld=cd,Fi="class",dd=w((e,t)=>{var r;return((r=t==null?void 0:t.class)==null?void 0:r.defaultRenderer)==="dagre-wrapper"?!1:/^\s*classDiagram/.test(e)},"detector"),hd=w(async()=>{let{diagram:e}=await import("./classDiagram-LNE6IOMH-JUKNVZPO.js");return{id:Fi,diagram:e}},"loader"),ud={id:Fi,detector:dd,loader:hd},pd=ud,Gi="classDiagram",fd=w((e,t)=>{var r;return/^\s*classDiagram/.test(e)&&((r=t==null?void 0:t.class)==null?void 0:r.defaultRenderer)==="dagre-wrapper"?!0:/^\s*classDiagram-v2/.test(e)},"detector"),gd=w(async()=>{let{diagram:e}=await import("./classDiagram-v2-MQ7JQ4JX-KUM77YUV.js");return{id:Gi,diagram:e}},"loader"),bd={id:Gi,detector:fd,loader:gd},wd=bd,ji="state",yd=w((e,t)=>{var r;return((r=t==null?void 0:t.state)==null?void 0:r.defaultRenderer)==="dagre-wrapper"?!1:/^\s*stateDiagram/.test(e)},"detector"),vd=w(async()=>{let{diagram:e}=await import("./stateDiagram-MAYHULR4-MNWWVDQW.js");return{id:ji,diagram:e}},"loader"),xd={id:ji,detector:yd,loader:vd},kd=xd,$i="stateDiagram",Cd=w((e,t)=>{var r;return!!(/^\s*stateDiagram-v2/.test(e)||/^\s*stateDiagram/.test(e)&&((r=t==null?void 0:t.state)==null?void 0:r.defaultRenderer)==="dagre-wrapper")},"detector"),Sd=w(async()=>{let{diagram:e}=await import("./stateDiagram-v2-4JROLMXI-PPFXAWLC.js");return{id:$i,diagram:e}},"loader"),_d={id:$i,detector:Cd,loader:Sd},Td=_d,Ri="journey",Ad=w(e=>/^\s*journey/.test(e),"detector"),Md=w(async()=>{let{diagram:e}=await import("./journeyDiagram-G5WM74LC-2T6FSMIA.js");return{id:Ri,diagram:e}},"loader"),Nd={id:Ri,detector:Ad,loader:Md},Ed=Nd,Id=w((e,t,r)=>{H.debug(`rendering svg for syntax error
`);let n=Fn(t),o=n.append("g");n.attr("viewBox","0 0 2412 512"),An(n,100,512,!0),o.append("path").attr("class","error-icon").attr("d","m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"),o.append("path").attr("class","error-icon").attr("d","m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"),o.append("path").attr("class","error-icon").attr("d","m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"),o.append("path").attr("class","error-icon").attr("d","m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"),o.append("path").attr("class","error-icon").attr("d","m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"),o.append("path").attr("class","error-icon").attr("d","m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"),o.append("text").attr("class","error-text").attr("x",1440).attr("y",250).attr("font-size","150px").style("text-anchor","middle").text("Syntax error in text"),o.append("text").attr("class","error-text").attr("x",1250).attr("y",400).attr("font-size","100px").style("text-anchor","middle").text(`mermaid version ${r}`)},"draw"),Ui={draw:Id},Pd=Ui,Dd={db:{},renderer:Ui,parser:{parse:w(()=>{},"parse")}},Ld=Dd,Vi="flowchart-elk",Od=w((e,t={})=>{var r;return/^\s*flowchart-elk/.test(e)||/^\s*flowchart|graph/.test(e)&&((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="elk"?(t.layout="elk",!0):!1},"detector"),zd=w(async()=>{let{diagram:e}=await import("./flowDiagram-7ASYPVHJ-2GSTIMB6.js");return{id:Vi,diagram:e}},"loader"),Bd={id:Vi,detector:Od,loader:zd},Fd=Bd,qi="timeline",Gd=w(e=>/^\s*timeline/.test(e),"detector"),jd=w(async()=>{let{diagram:e}=await import("./timeline-definition-U7ZMHBDA-ZZTBVWVN.js");return{id:qi,diagram:e}},"loader"),$d={id:qi,detector:Gd,loader:jd},Rd=$d,Wi="mindmap",Ud=w(e=>/^\s*mindmap/.test(e),"detector"),Vd=w(async()=>{let{diagram:e}=await import("./mindmap-definition-GWI6TPTV-KQ5BFMQG.js");return{id:Wi,diagram:e}},"loader"),qd={id:Wi,detector:Ud,loader:Vd},Wd=qd,Hi="kanban",Hd=w(e=>/^\s*kanban/.test(e),"detector"),Yd=w(async()=>{let{diagram:e}=await import("./kanban-definition-QRCXZQQD-VPQLW4JL.js");return{id:Hi,diagram:e}},"loader"),Jd={id:Hi,detector:Hd,loader:Yd},Kd=Jd,Yi="sankey",Xd=w(e=>/^\s*sankey-beta/.test(e),"detector"),Qd=w(async()=>{let{diagram:e}=await import("./sankeyDiagram-Y46BX6SQ-MXME7T2Q.js");return{id:Yi,diagram:e}},"loader"),Zd={id:Yi,detector:Xd,loader:Qd},t0=Zd,Ji="packet",e0=w(e=>/^\s*packet-beta/.test(e),"detector"),r0=w(async()=>{let{diagram:e}=await import("./diagram-QW4FP2JN-3NHDKL77.js");return{id:Ji,diagram:e}},"loader"),n0={id:Ji,detector:e0,loader:r0},Ki="block",o0=w(e=>/^\s*block-beta/.test(e),"detector"),i0=w(async()=>{let{diagram:e}=await import("./blockDiagram-ZHA2E4KO-27TXPLRB.js");return{id:Ki,diagram:e}},"loader"),s0={id:Ki,detector:o0,loader:i0},a0=s0,Xi="architecture",c0=w(e=>/^\s*architecture/.test(e),"detector"),l0=w(async()=>{let{diagram:e}=await import("./architectureDiagram-UYN6MBPD-X74UKWZL.js");return{id:Xi,diagram:e}},"loader"),d0={id:Xi,detector:c0,loader:l0},h0=d0,ki=!1,er=w(()=>{ki||(ki=!0,Jt("error",Ld,e=>e.toLowerCase().trim()==="error"),Jt("---",{db:{clear:w(()=>{},"clear")},styles:{},renderer:{draw:w(()=>{},"draw")},parser:{parse:w(()=>{throw new Error("Diagrams beginning with --- are not valid. If you were trying to use a YAML front-matter, please ensure that you've correctly opened and closed the YAML front-matter with un-indented `---` blocks")},"parse")},init:w(()=>null,"init")},e=>e.toLowerCase().trimStart().startsWith("---")),sr(xl,Kd,wd,pd,Dl,$l,Vl,Hl,id,ld,Fd,Nl,_l,Wd,Rd,Bl,Td,kd,Ed,Xl,t0,n0,ed,a0,h0))},"addDiagrams"),u0=w(async()=>{H.debug("Loading registered diagrams");let t=(await Promise.allSettled(Object.entries(or).map(async([r,{detector:n,loader:o}])=>{if(o)try{he(r)}catch{try{let{diagram:i,id:s}=await o();Jt(s,i,n)}catch(i){throw H.error(`Failed to load external diagram with key ${r}. Removing from detectors.`),delete or[r],i}}}))).filter(r=>r.status==="rejected");if(t.length>0){H.error(`Failed to load ${t.length} external diagrams`);for(let r of t)H.error(r);throw new Error(`Failed to load ${t.length} external diagrams`)}},"loadRegisteredDiagrams"),p0="graphics-document document";function Qi(e,t){e.attr("role",p0),t!==""&&e.attr("aria-roledescription",t)}w(Qi,"setA11yDiagramInfo");function Zi(e,t,r,n){if(e.insert!==void 0){if(r){let o=`chart-desc-${n}`;e.attr("aria-describedby",o),e.insert("desc",":first-child").attr("id",o).text(r)}if(t){let o=`chart-title-${n}`;e.attr("aria-labelledby",o),e.insert("title",":first-child").attr("id",o).text(t)}}}w(Zi,"addSVGa11yTitleDescription");var Mt,rn=(Mt=class{constructor(t,r,n,o,i){this.type=t,this.text=r,this.db=n,this.parser=o,this.renderer=i}static async fromText(t,r={}){var d,m;let n=Et(),o=ir(t,n);t=Ln(t)+`
`;try{he(o)}catch{let y=yn(o);if(!y)throw new wn(`Diagram ${o} not found.`);let{id:C,diagram:P}=await y();Jt(C,P)}let{db:i,parser:s,renderer:c,init:l}=he(o);return s.parser&&(s.parser.yy=i),(d=i.clear)==null||d.call(i),l==null||l(n),r.title&&((m=i.setDiagramTitle)==null||m.call(i,r.title)),await s.parse(t),new Mt(o,t,i,s,c)}async render(t,r){await this.renderer.draw(this.text,t,r,this)}getParser(){return this.parser}getType(){return this.type}},w(Mt,"Diagram"),Mt),Ci=[],f0=w(()=>{Ci.forEach(e=>{e()}),Ci=[]},"attachFunctions"),m0=w(e=>e.replace(/^\s*%%(?!{)[^\n]+\n?/gm,"").trimStart(),"cleanupComments");function ts(e){let t=e.match(bn);if(!t)return{text:e,metadata:{}};let r=En(t[1],{schema:Nn})??{};r=typeof r=="object"&&!Array.isArray(r)?r:{};let n={};return r.displayMode&&(n.displayMode=r.displayMode.toString()),r.title&&(n.title=r.title.toString()),r.config&&(n.config=r.config),{text:e.slice(t[0].length),metadata:n}}w(ts,"extractFrontMatter");var g0=w(e=>e.replace(/\r\n?/g,`
`).replace(/<(\w+)([^>]*)>/g,(t,r,n)=>"<"+r+n.replace(/="([^"]*)"/g,"='$1'")+">"),"cleanupText"),b0=w(e=>{let{text:t,metadata:r}=ts(e),{displayMode:n,title:o,config:i={}}=r;return n&&(i.gantt||(i.gantt={}),i.gantt.displayMode=n),{title:o,config:i,text:t}},"processFrontmatter"),w0=w(e=>{let t=It.detectInit(e)??{},r=It.detectDirective(e,"wrap");return Array.isArray(r)?t.wrap=r.some(({type:n})=>n==="wrap"):(r==null?void 0:r.type)==="wrap"&&(t.wrap=!0),{text:Pn(e),directive:t}},"processDirectives");function on(e){let t=g0(e),r=b0(t),n=w0(r.text),o=Dn(r.config,n.directive);return e=m0(n.text),{code:e,title:r.title,config:o}}w(on,"preprocessDiagram");function es(e){let t=new TextEncoder().encode(e),r=Array.from(t,n=>String.fromCodePoint(n)).join("");return btoa(r)}w(es,"toBase64");var y0=5e4,v0="graph TB;a[Maximum text size in diagram exceeded];style a fill:#faa",x0="sandbox",k0="loose",C0="http://www.w3.org/2000/svg",S0="http://www.w3.org/1999/xlink",_0="http://www.w3.org/1999/xhtml",T0="100%",A0="100%",M0="border:0;margin:0;",N0="margin:0",E0="allow-top-navigation-by-user-activation allow-popups",I0='The "iframe" tag is not supported by your browser.',P0=["foreignobject"],D0=["dominant-baseline"];function sn(e){let t=on(e);return Yt(),_n(t.config??{}),t}w(sn,"processAndSetConfigs");async function rs(e,t){er();try{let{code:r,config:n}=sn(e);return{diagramType:(await os(r)).type,config:n}}catch(r){if(t!=null&&t.suppressErrors)return!1;throw r}}w(rs,"parse");var Si=w((e,t,r=[])=>`
.${e} ${t} { ${r.join(" !important; ")} !important; }`,"cssImportantStyles"),L0=w((e,t=new Map)=>{var n;let r="";if(e.themeCSS!==void 0&&(r+=`
${e.themeCSS}`),e.fontFamily!==void 0&&(r+=`
:root { --mermaid-font-family: ${e.fontFamily}}`),e.altFontFamily!==void 0&&(r+=`
:root { --mermaid-alt-font-family: ${e.altFontFamily}}`),t instanceof Map){let c=e.htmlLabels??((n=e.flowchart)==null?void 0:n.htmlLabels)?["> *","span"]:["rect","polygon","ellipse","circle","path"];t.forEach(l=>{dr(l.styles)||c.forEach(d=>{r+=Si(l.id,d,l.styles)}),dr(l.textStyles)||(r+=Si(l.id,"tspan",((l==null?void 0:l.textStyles)||[]).map(d=>d.replace("color","fill"))))})}return r},"createCssStyles"),O0=w((e,t,r,n)=>{let o=L0(e,r),i=Mn(t,o,e.themeVariables);return Ze(vi(`${n}{${i}}`),xi)},"createUserStyles"),z0=w((e="",t,r)=>{let n=e;return!r&&!t&&(n=n.replace(/marker-end="url\([\d+./:=?A-Za-z-]*?#/g,'marker-end="url(#')),n=On(n),n=n.replace(/<br>/g,"<br/>"),n},"cleanUpSvgCode"),B0=w((e="",t)=>{var o,i;let r=(i=(o=t==null?void 0:t.viewBox)==null?void 0:o.baseVal)!=null&&i.height?t.viewBox.baseVal.height+"px":A0,n=es(`<body style="${N0}">${e}</body>`);return`<iframe style="width:${T0};height:${r};${M0}" src="data:text/html;charset=UTF-8;base64,${n}" sandbox="${E0}">
  ${I0}
</iframe>`},"putIntoIFrame"),_i=w((e,t,r,n,o)=>{let i=e.append("div");i.attr("id",r),n&&i.attr("style",n);let s=i.append("svg").attr("id",t).attr("width","100%").attr("xmlns",C0);return o&&s.attr("xmlns:xlink",o),s.append("g"),e},"appendDivSvgG");function nn(e,t){return e.append("iframe").attr("id",t).attr("style","width: 100%; height: 100%;").attr("sandbox","")}w(nn,"sandboxedIframe");var F0=w((e,t,r,n)=>{var o,i,s;(o=e.getElementById(t))==null||o.remove(),(i=e.getElementById(r))==null||i.remove(),(s=e.getElementById(n))==null||s.remove()},"removeExistingElements"),G0=w(async function(e,t,r){var u,p,f,h,a,b;er();let n=sn(t);t=n.code;let o=Et();H.debug(o),t.length>((o==null?void 0:o.maxTextSize)??y0)&&(t=v0);let i="#"+e,s="i"+e,c="#"+s,l="d"+e,d="#"+l,m=w(()=>{let D=gt(C?c:d).node();D&&"remove"in D&&D.remove()},"removeTempElements"),y=gt("body"),C=o.securityLevel===x0,P=o.securityLevel===k0,N=o.fontFamily;if(r!==void 0){if(r&&(r.innerHTML=""),C){let T=nn(gt(r),s);y=gt(T.nodes()[0].contentDocument.body),y.node().style.margin=0}else y=gt(r);_i(y,e,l,`font-family: ${N}`,S0)}else{if(F0(document,e,l,s),C){let T=nn(gt("body"),s);y=gt(T.nodes()[0].contentDocument.body),y.node().style.margin=0}else y=gt("body");_i(y,e,l)}let E,_;try{E=await rn.fromText(t,{title:n.title})}catch(T){if(o.suppressErrorRendering)throw m(),T;E=await rn.fromText("error"),_=T}let x=y.select(d).node(),v=E.type,$=x.firstChild,k=$.firstChild,q=(p=(u=E.renderer).getClasses)==null?void 0:p.call(u,t,E),W=O0(o,v,q,i),S=document.createElement("style");S.innerHTML=W,$.insertBefore(S,k);try{await E.renderer.draw(t,e,hr,E)}catch(T){throw o.suppressErrorRendering?m():Pd.draw(t,e,hr),T}let Z=y.select(`${d} svg`),at=(h=(f=E.db).getAccTitle)==null?void 0:h.call(f),mt=(b=(a=E.db).getAccDescription)==null?void 0:b.call(a);is(v,Z,at,mt),y.select(`[id="${e}"]`).selectAll("foreignobject > *").attr("xmlns",_0);let ct=y.select(d).node().innerHTML;if(H.debug("config.arrowMarkerAbsolute",o.arrowMarkerAbsolute),ct=z0(ct,C,Tn(o.arrowMarkerAbsolute)),C){let T=y.select(d+" svg").node();ct=B0(ct,T)}else P||(ct=gn.sanitize(ct,{ADD_TAGS:P0,ADD_ATTR:D0,HTML_INTEGRATION_POINTS:{foreignobject:!0}}));if(f0(),_)throw _;return m(),{diagramType:v,svg:ct,bindFunctions:E.db.bindFunctions}},"render");function ns(e={}){var n;let t=vn({},e);t!=null&&t.fontFamily&&!((n=t.themeVariables)!=null&&n.fontFamily)&&(t.themeVariables||(t.themeVariables={}),t.themeVariables.fontFamily=t.fontFamily),kn(t),t!=null&&t.theme&&t.theme in de?t.themeVariables=de[t.theme].getThemeVariables(t.themeVariables):t&&(t.themeVariables=de.default.getThemeVariables(t.themeVariables));let r=typeof t=="object"?xn(t):cr();nr(r.logLevel),er()}w(ns,"initialize");var os=w((e,t={})=>{let{code:r}=on(e);return rn.fromText(r,t)},"getDiagramFromText");function is(e,t,r,n){Qi(t,e),Zi(t,r,n,t.attr("id"))}w(is,"addA11yInfo");var Nt=Object.freeze({render:G0,parse:rs,getDiagramFromText:os,initialize:ns,getConfig:Et,setConfig:Sn,getSiteConfig:cr,updateSiteConfig:Cn,reset:w(()=>{Yt()},"reset"),globalReset:w(()=>{Yt(ar)},"globalReset"),defaultConfig:ar});nr(Et().logLevel);Yt(Et());var j0=w((e,t,r)=>{H.warn(e),lr(e)?(r&&r(e.str,e.hash),t.push({...e,message:e.str,error:e})):(r&&r(e),e instanceof Error&&t.push({str:e.message,message:e.message,hash:e.name,error:e}))},"handleError"),ss=w(async function(e={querySelector:".mermaid"}){try{await $0(e)}catch(t){if(lr(t)&&H.error(t.str),rt.parseError&&rt.parseError(t),!e.suppressErrors)throw H.error("Use the suppressErrors option to suppress these errors"),t}},"run"),$0=w(async function({postRenderCallback:e,querySelector:t,nodes:r}={querySelector:".mermaid"}){let n=Nt.getConfig();H.debug(`${e?"":"No "}Callback function found`);let o;if(r)o=r;else if(t)o=document.querySelectorAll(t);else throw new Error("Nodes and querySelector are both undefined");H.debug(`Found ${o.length} diagrams`),(n==null?void 0:n.startOnLoad)!==void 0&&(H.debug("Start On Load: "+(n==null?void 0:n.startOnLoad)),Nt.updateSiteConfig({startOnLoad:n==null?void 0:n.startOnLoad}));let i=new It.InitIDGenerator(n.deterministicIds,n.deterministicIDSeed),s,c=[];for(let l of Array.from(o)){if(H.info("Rendering diagram: "+l.id),l.getAttribute("data-processed"))continue;l.setAttribute("data-processed","true");let d=`mermaid-${i.next()}`;s=l.innerHTML,s=zn(It.entityDecode(s)).trim().replace(/<br\s*\/?>/gi,"<br/>");let m=It.detectInit(s);m&&H.debug("Detected early reinit: ",m);try{let{svg:y,bindFunctions:C}=await ds(d,s,l);l.innerHTML=y,e&&await e(d),C&&C(l)}catch(y){j0(y,c,rt.parseError)}}if(c.length>0)throw c[0]},"runThrowsErrors"),as=w(function(e){Nt.initialize(e)},"initialize"),R0=w(async function(e,t,r){H.warn("mermaid.init is deprecated. Please use run instead."),e&&as(e);let n={postRenderCallback:r,querySelector:".mermaid"};typeof t=="string"?n.querySelector=t:t&&(t instanceof HTMLElement?n.nodes=[t]:n.nodes=t),await ss(n)},"init"),U0=w(async(e,{lazyLoad:t=!0}={})=>{er(),sr(...e),t===!1&&await u0()},"registerExternalDiagrams"),cs=w(function(){if(rt.startOnLoad){let{startOnLoad:e}=Nt.getConfig();e&&rt.run().catch(t=>H.error("Mermaid failed to initialize",t))}},"contentLoaded");typeof document<"u"&&window.addEventListener("load",cs,!1);var V0=w(function(e){rt.parseError=e},"setParseErrorHandler"),tr=[],en=!1,ls=w(async()=>{if(!en){for(en=!0;tr.length>0;){let e=tr.shift();if(e)try{await e()}catch(t){H.error("Error executing queue",t)}}en=!1}},"executeQueue"),q0=w(async(e,t)=>new Promise((r,n)=>{let o=w(()=>new Promise((i,s)=>{Nt.parse(e,t).then(c=>{i(c),r(c)},c=>{var l;H.error("Error parsing",c),(l=rt.parseError)==null||l.call(rt,c),s(c),n(c)})}),"performCall");tr.push(o),ls().catch(n)}),"parse"),ds=w((e,t,r)=>new Promise((n,o)=>{let i=w(()=>new Promise((s,c)=>{Nt.render(e,t,r).then(l=>{s(l),n(l)},l=>{var d;H.error("Error parsing",l),(d=rt.parseError)==null||d.call(rt,l),c(l),o(l)})}),"performCall");tr.push(i),ls().catch(o)}),"render"),rt={startOnLoad:!0,mermaidAPI:Nt,parse:q0,render:ds,init:R0,run:ss,registerExternalDiagrams:U0,registerLayoutLoaders:Bn,initialize:as,parseError:void 0,contentLoaded:cs,setParseErrorHandler:V0,detectType:ir,registerIconPacks:In},an=rt;an.initialize({startOnLoad:!0,theme:"dark",logLevel:"info"});var W0={view:g(".preview"),init:function(){return this.update(),g(".terminal").listen("input",()=>this.update()),!!O.getSearchParam("md")?this.view.show():this.view.hide(),this},autoLink:function(){let e=I.parse("__auto-links__");if(!e)return;let t=Object.keys(e).map(o=>`${o}\\w+`).join("|"),r=new RegExp(`(${t})`,"g"),n=this.view.el.innerHTML.replace(r,o=>{let i=Object.keys(e).find(c=>o.startsWith(c)),s=e[i];return s.startsWith("http")?`<a href="${s}${o}" target="_blank">${o}</a>`:`<a href="${s}${o}">${o}</a>`});this.view.innerHTML(n)},update:function(){let md=g(".terminal").getValue();this.view.innerHTML(Re(md)),this.autoLink();let{elements}=g("pre");Array.prototype.slice.call(elements).forEach(e=>{let t=Ue("\u{1F4CB} Copy",async r=>{r.stopPropagation();let n=r.srcElement.previousSibling.innerHTML;await kt(n,"\u{1F4CB} Code copied to clipboard")});e.appendChild(t)}),g("code").listenAll("click",({innerHTML})=>{let result=eval(innerHTML);g(".console").show().innerHTML(result)}),g(".console").listen("click",async e=>{e.srcElement.classList.add("hidden");let t=e.srcElement.innerHTML;await kt(t,"\u{1F4CB} Code copied to clipboard")}),an.contentLoaded()},show:function(e=!0){this.view.show(),O.set(void 0,{md:e})},hide:function(){this.view.hide(),O.deleteParam("md")},toggle:function(e="true"){return O.getSearchParam("md")===e?this.hide():this.show(e),this}},St=W0;var H0=e=>{let t=document.querySelector(e);if(ge(t.value)){let r=JSON.stringify(JSON.parse(t.value),null,2);t.value=r,M.success("\u{1F44D} JSON value prettified")}else M.error("\u{1F627} Value is not in valid JSON format")},hs=H0;var us=(e=1e3)=>new Promise(t=>{setTimeout(t,e)});var V=(e,t,r)=>{let n=document.createElement("IMG");return r&&n.classList.add(r),t&&n.setAttribute("alt",t),n.setAttribute("src",e),n};var ps="./list-LK7OCHR7.svg";var ae="./trash-RDL437QG.svg";var fs="./checkmark-circle-JQ7ADSUI.svg";var ms="./cloud-sync-F3RLGHML.svg";var gs="./lighter-UBEI67LL.svg";var bs="./enter-down-6TVO6OFR.svg";var ws="./download-FVXMIYZ4.svg";var ys="./envelope-Z2VRVSLR.svg";var vs="./bug-36UGMUXT.svg";var xs="./picture-3TDOSVS3.svg";var ks="./printer-B7RMPYZC.svg";var Cs="./page-break-BLVP5QBQ.svg";var Ss="./frame-expand-CX6CNP53.svg";var _s="./arrow-right-circle-2Q6EHM2H.svg";var Ts="./magic-wand-JQJ6EKRO.svg";var As="./rocket-AIY2RJJS.svg";var Ms="./spell-check-V6QYTGNT.svg";var Ns="./pencil-X3ZMY3QU.svg";var cn="./exit-up-GH6BPN2X.svg";var Es="./leaf-CGBE7XAJ.svg";var Is="./clock-SRGT5GTL.svg";var Ps=async()=>{try{let e=Y(),t=O.get();await navigator.share({title:e?e.title:"\u270D\uFE0F MiroPad",text:e?e.text:"Temporary note keeping app for the browser",url:t})}catch(e){M.info(`${e.message}`)}};var mh=()=>{let e=I.get("gistId");return I.get("authToken")?e?"Sync: Notes with my GitHub Gist":"Sync: Pick your Gist to sync with":"Sync: Authorize your GitHub account for synchronisation"},gh={title:"Share note",icon:V(cn,"share note"),sortTitle:"Share",call:Ps},bh={title:"Share public link",key:null,icon:V(cn,"share public link"),sortTitle:"Share public link",call:async()=>{B.hide(),await xe(g(".terminal").getValue());let e=Y();if(e){let r=(await qn({note:e})).history[0].url,n=await fetch(r).then(m=>m.json()),{files:o}=n,i=Object.values(o),[s]=i,{raw_url:c}=s,l=`${O.baseUrl}?raw=${c}`;kt(l,"MiroPad public link copied to clipboard \u{1F4CB}!")}}},ln=()=>[{title:"New note",icon:V(Ns,"new note"),sortTitle:"New",key:"n",call:ve},{title:"Save",key:"s",icon:V(fs,"save note"),sortTitle:"Save",call:async()=>{B.hide(),await xe(g(".terminal").getValue());let e=Y();e&&!e.disableSync&&Rn([e]),_t()}},...navigator.share?[gh]:[],{title:"Toggle MarkDown Viewer",icon:V(Cs,"toggle markdown viewer","rotate90"),sortTitle:"Split",key:"m",call:()=>{St.toggle(),B.hide()}},{title:"Full MarkDown view",icon:V(Ss,"full view mode"),sortTitle:"Full view",key:"shift m",call:()=>{St.toggle("full"),B.hide()}},...wo()?[bh]:[],{title:"Zen mode",icon:V(Es,"switch to zen mode"),sortTitle:"Zen mode",key:"shift z",call:()=>{!!O.getSearchParam("zen")?O.deleteParam("zen"):O.set(void 0,{zen:!0}),B.hide()}},{title:"List saved notes",icon:V(ps,"list notes"),sortTitle:"Notes",key:"p",call:()=>B.toggle(B.getModes().notes)},{title:"Delete note",key:"shift d",icon:V(ae,"delete note"),sortTitle:"Delete",call:ke},{title:mh(),icon:V(ms,"sync with github"),key:null,call:async()=>{let e=I.get("authToken");if(!e)return xo();if(!I.get("gistId"))return await ko(e);B.hide(),await ee()}},{title:"Sync: Reset Gist settings",icon:V(gs,"reset github settings"),key:null,call:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("gistId"),localStorage.removeItem("lastLocalUpdate"),localStorage.removeItem("lastSync"),M.info("Gist setting have been reset!"),B.hide()}},{title:"Toggle sidebar",experimental:!0,key:"shift l",call:()=>{g("aside").toggle()}},{title:"Save to File System...",experimental:!0,icon:V(bs,"save file"),key:"shift s",call:()=>{let e=Y();if(e){let{text:t,title:r}=e;So(t,r),B.hide()}}},{title:"Email note to...",experimental:!0,icon:V(ys,"email"),key:"e",call:()=>{let e=g(".terminal").getValue();ni(e),B.hide()}},{title:"Toggle experimental features",experimental:!1,icon:V(vs,"lab"),key:null,call:()=>{let e=!!I.get("__experimental__");e?I.remove("__experimental__"):I.set("__experimental__",!0),M.showNotification(`Experimental features turned ${e?"off":"on"}`),B.hide()}},{title:"Toggle Autocompletion",experimental:!1,icon:V(_s,"autocompletion"),key:null,call:()=>{let e=!!I.get("__autocomplete__");e?I.remove("__autocomplete__"):I.set("__autocomplete__",!0),M.showNotification(`Autocomplete feature turned ${e?"off":"on"}`),B.hide(),g(".terminal").focus()}},{title:"Add a cover picture",experimental:!0,icon:V(xs,"cover picture"),key:null,call:async()=>{let e=prompt("Paste the image URL in here...");B.hide(),await us(200),kt(`![bg](${e}){.cover}`,"\u{1F44C}Copied! Paste the code on the MiroPad editor"),g(".terminal").focus(),M.info("Paste the cover picture wherever you prefer on the MirPad editor")}},{title:"Create a Google calendar event for today",experimental:!0,icon:V(Is,"calendar event"),key:null,call:()=>{let e=r=>{let n=new Date,o=n.getFullYear(),i=String(n.getMonth()+1).padStart(2,"0"),s=String(n.getDate()).padStart(2,"0"),c=`${o}${i}${s}`,l=`${o}${i}${String(n.getDate()+1).padStart(2,"0")}`,d="https://calendar.google.com/calendar/render",m=new URLSearchParams({action:"TEMPLATE",text:r,dates:`${c}/${l}`,details:"This is an all-day event for today.",location:"Online"});globalThis.open(`${d}?${m}`,"_blank")},t=globalThis.prompt("Give a title to your calendar event:");t?e(t):M.warning("Title is required to create a calendar event. Abort!"),g(".terminal").focus()}},{title:"Print MarkDown output",experimental:!0,icon:V(ks,"print"),key:null,call:()=>{g(".preview").show(),St.init(),globalThis.print(),B.hide()}},{key:"j",title:"Prettify JSON document",icon:V(Ts,"prettify json"),call:()=>{hs(".terminal"),B.hide()}},{title:"Toggle command palette",icon:V(As,"toggle command palette"),key:["shift p","k"],call:()=>B.toggle(B.getModes().commands)},{title:"Find and Replace...",experimental:!0,icon:V(Ms,"find and replace"),key:"shift f",call:()=>{let e=g(".terminal").getValue().slice(g(".terminal").el.selectionStart,g(".terminal").el.selectionEnd),t=prompt("What do you wanna find?",e);if(!t)return M.info("Value not found");let r=g(".terminal").getValue().indexOf(t);g(".terminal").el.setSelectionRange(r,r+t.length);let n=prompt(`Replace ${t} with...`);n&&g(".terminal").el.setRangeText(n)}},{title:"Download all notes!",icon:V(ws,"Download all notes on your local file system"),call:()=>{let e=lt({includeDeleted:!0});_o(e),B.hide()}},{title:"Permanently delete ALL notes \u2757",icon:V(ae,"delete note"),call:()=>{confirm("Are you sure you want do delete ALL your notes?")&&(lt({includeDeleted:!0}).forEach(r=>{I.remove(r.id)}),ve()),B.hide()}}];var wh={events:[],on(e,t){return Array.isArray(e)?(e.forEach(r=>{let n=r.key||r,o=r.call||t;this.on(n,o)}),this):(e&&typeof e=="string"&&t&&typeof t=="function"&&(this.events=[...this.events,{key:e.includes("shift")?e.replace("shift","").trim():e,shift:e.includes("shift"),fn(){t()}}]),this)},listen(){return document.addEventListener("keydown",e=>{this.handleEvent(e)}),this},handleEvent(e){this.events.map(t=>(t.key===e.key&&(e.ctrlKey===!0||e.metaKey===!0)&&e.shiftKey===t.shift&&(e.preventDefault(),t.fn()),!0))}},Ds=wh;var Ls=(e,t)=>{let r=document.createElement("a");return r.href=t,r.appendChild(Dt(e)?e:document.createTextNode(e)),r};var dn=(e,t=new Date)=>{let r=new Date(e).getFullYear(),n=new Date(t).getFullYear();return r===n},Bs=(e,t=new Date)=>{let r=new Date(e).getMonth(),n=new Date(t).getMonth();return r===n},yh=(e,t=new Date)=>{let r=new Date(e).getDate(),n=new Date(t).getDate();return r===n},Os=(e,t=new Date)=>dn(e,t)&&Bs(e,t)&&yh(e,t),vh=["January","February","March","April","May","June","July","August","September","October","November","December"],xh=vh.map(e=>e.slice(0,3)),zs=(e=new Date)=>{let t=new Date(e),r=new Date().getDate()-1;return Bs(t)&&dn(t)&&t.getDate()===r},ce=e=>{let t=new Date(e),r=zs(e)?"":xh[t.getMonth()],n=dn(t)?"":t.getFullYear(),o=zs(t)?"Yesterday":t.getDate();return`${Os(t)?"":`${o} ${r} ${n}`} ${Os(t)?t.toLocaleTimeString():""}`};var Fs=e=>e.reduce((r,n)=>{if(r.length===0)return[n];let o=Math.max(...r);return[...r,...n>=o?[n]:[]]},[]).length===e.length;var hn=(e,t)=>{let r=e.split(" ").map(i=>i.toLowerCase()),o=t.split(" ").map(i=>i.toLowerCase()).map(i=>r.map((l,d)=>l.includes(i)?d:-1).reduce((l,d)=>d>-1?d:l,-1));return o.includes(-1)?!1:Fs(o)};var Gs=()=>globalThis.Notification.requestPermission(),js=()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register(`${globalThis.location.pathname.slice(-1)==="/"?globalThis.location.pathname:`${globalThis.location.origin}/`}service-worker.js?v=v3.1.19`)};var $s=e=>Array.isArray(e)?e.map(t=>$s(t)).join(", "):e?`\u2318+${e.toUpperCase()}`:"",kh=(()=>{let e;(c=>(c.off="off",c.notes="notes",c.revisions="revisions",c.commands="commands",c.gists="gists"))(e||(e={}));let t={input:"",mode:"off",options:{selected:0,length:0}};return{getState:function(){return t},getModes:function(){return e},setState:function(r){return t={...t,...r},t},show:function(r="commands"){switch(g("#commander").show(),g("#commander input").focus(),r){case"commands":this.generateCommands(),g("#commander input").setValue("> "),this.setState({mode:"commands"});break;case"notes":this.generateNotes(),g("#commander input").setValue(""),this.setState({mode:"notes"});break;case"revisions":this.generateRevisions(),g("#commander input").setValue(""),this.setState({mode:"revisions"});break;default:break}return this},hide:function(){return g("#commander").hide(),t.mode="off",this},toggle:function(r){return Gs(),t.mode==="off"||t.mode!==r?this.show(r):this.hide(),this},commands:function(){return ln()},selectOption:function(r="down"){let n=t.options.selected,o=t.options.length-1,l=r==="down"?n===o?0:n+1:n===0?o:n-1;t.options={...t.options,selected:l}},initCommander:function(){return ln().slice(0,5).map(r=>{g(".mobile-dock").append(Ue([r.icon,document.createTextNode(r.sortTitle)],r.call,r.title.toLowerCase().replace(/\s/g,"-")))}),g("#commander button").listen("click",()=>{this.hide()}),g("#commander input").listen("keydown",r=>{r.keyCode===40&&(t.mode==="revisions"&&g("#commands li.selected").click(),this.selectOption("down")),r.keyCode===38&&(t.mode==="revisions"&&g("#commands li.selected").click(),this.selectOption("up"))}).listen("keyup",r=>{r.keyCode===13&&(t.mode==="commands"?g("#commands li.selected div").click():g("#commands li.selected a").click()),r.keyCode===27&&g(".terminal").focus();let n=r.target;t.input!==n.value&&(t.options.selected=0),t.input=n.value,this.generateOptions(n.value)}),this},init:function(){return this.initCommander(),Ds.listen().on(this.commands()),g(".menu").listen("click",()=>this.toggle()),g("#revisions").listen("click",()=>this.generateRevisions()),this},generateRevisions:function(){this.show(),t.mode="revisions";let r=Y();if(r){let{revisions:n}=r,o=t.options.selected,i=Object.keys(n).sort((s,c)=>{let{dateCreated:l}=n[s],{dateCreated:d}=n[c];return d-l}).map((s,c)=>({title:wt({content:`...${s.slice(-10)}`}),secondary:`${ce(n[s].dateCreated)}`,onclick:()=>{O.set(void 0,{v:s}),t.options.selected=c,this.generateRevisions()}})).map((s,c)=>xt(s,c===o));g("#commands").html(i),t.options={...t.options,length:i.length}}return this},generateOptions:function(r){switch(t.mode){case"commands":case"notes":r.slice(0,1)===">"?(t.mode="commands",this.generateCommands(r.slice(1).trim()),g("#commander input").placeholder("Search for commands...")):(t.mode="notes",this.generateNotes(r));return;case"revisions":return this.generateRevisions();case"off":break;default:break}},generateNotes:function(r=""){let n=t.options.selected,o=lt().filter(({title:i})=>hn(i,r)).filter(({id:i,deleted:s})=>!s&&i!==O.getPageId()).sort((i,s)=>{let c=we(i.title);return we(s.title)-c}).map(({id:i,title:s},c)=>{let l=we(s),d=`${globalThis.location.origin}${globalThis.location.pathname}#${i}`,m=Ls(wt({content:s,highlight:r}),d);return xt({title:m,secondary:ce(l),onclick:()=>{this.hide(),g(".terminal").focus()}},c===n)});return g("#commands").html(o),g("#commander input").placeholder(`Search from ${o.length} saved notes...`),t.options={...t.options,length:o.length},this},generateCommands:function(r=""){let n=t.options.selected,o=this.commands().filter(({title:i})=>hn(i,r)).filter(({experimental:i=!1})=>I.get("__experimental__")?!0:!i).map(({title:i,key:s,call:c,icon:l},d)=>xt({title:wt({content:i,highlight:r}),icon:l,secondary:$s(s),onclick:c},d===n));return g("#commands").html(o),t.options={...t.options,length:o.length},this}}})(),B=kh;var Rs="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var Us=(e=21)=>{let t="",r=crypto.getRandomValues(new Uint8Array(e));for(;e--;)t+=Rs[r[e]&63];return t};var qs=mn(Vs());var Ch=e=>{let t=e.replace(/[\r\n\t]+/g,"").toLowerCase();return le.getMatchingWords(t)},un=(e,t)=>{let r="",n=t-1;do{let o=e[n]||"";n=o.trim()===""?-1:n-1,r=o.trim()!==""?`${o}${r}`:r}while(n>=0);return r},pn=e=>{let t=(0,qs.default)(e,e.selectionEnd),{top:r,left:n}=t,o=g(".terminal").el.scrollHeight,i=g("main").el;i.style.height=`${o}px`,g(".suggestion").el.style.top=`${r}px`,g(".suggestion").el.style.left=`${n}px`},fn=(e,t)=>e[t]===void 0||e[t].trim()==="",Ws=e=>{let t=e.target.selectionEnd,r=z.el.getValue(),n=r[t-1];if(e.inputType==="deleteContentBackward"||n===" ")return z.setState({prediction:null,currentWord:null}),g(".suggestion").hide();let o=un(r,t);if(e.inputType==="insertText"&&fn(r,t)&&!o.startsWith("#")){pn(e.target);let s=Ch(o),[c]=s,l=c||"";z.setState({prediction:l,currentWord:o,matches:s.slice(0,10),options:{selected:0,length:s.length}});let d=z.getState();d.currentWord&&d.prediction&&d.currentWord.length>1?(z.renderInlineSuggestion(),z.renderOptions()):g(".suggestion").hide()}};var Hs=(e,t)=>e.split(`
`).reduce((o,i)=>{let{isFound:s}=o;if(s)return o;let c=`${o.text}${i}
`,l=c.length;return t>=l?{text:c,isFound:!1}:{text:i,isFound:!0}},{text:"",isFound:!1}).text;var Ys=e=>{let t=Hs(e.target.value,e.target.selectionEnd),r={"* [":`
* [ ] `,"* ":`
* `," * [":`
 * [ ] `," * ":`
 * `};for(let[n,o]of Object.entries(r))if(t.startsWith(n)){e.preventDefault(),g(".terminal").insertAtCaret(o);break}};var Js=e=>{let t=e.target;if(!t)return;let r=t.selectionEnd,n=z.el.getValue(),o=n[r-1];if(e.inputType==="deleteContentBackward"||o===" ")return z.setState({prediction:null,currentWord:null}),g(".suggestion").hide();let i=un(n,r);if(i.startsWith("#")&&e.inputType==="insertText"&&fn(n,r)){pn(e.target);let c=lt().map(N=>N.id),l=i.slice(1),d=c.filter(N=>N.startsWith(l)),[m]=d,y=m,C=l;z.setState({prediction:y,currentWord:C,matches:d.slice(0,10),options:{selected:0,length:d.length}});let P=z.getState();P.currentWord&&P.prediction&&P.currentWord.length>1?(z.renderInlineSuggestion(),z.renderOptions()):g(".suggestion").hide()}};var z=(()=>{let e={matches:[],currentWord:null,prediction:null,options:{selected:0,length:0}},t=e;return{el:g(".terminal"),getState:function(){return t},setState:function(r){return t={...t,...r},t},resetState:function(){z.setState(e)},selectOption:function(r="down"){let n=t.options.selected,o=t.options.length-1,l=r==="down"?n===o?0:n+1:n===0?o:n-1;t.options={...t.options,selected:l},z.setState({prediction:t.matches[t.options.selected]}),z.renderInlineSuggestion(),z.renderOptions()},acceptCompletion:r=>{let n=(s,c)=>{let l=s.toLowerCase().replace(c.toLowerCase(),"");l?g(".terminal").insertAtCaret(`${l} `):g(".terminal").insertAtCaret("  "),g(".suggestion").hide(),z.resetState()},{prediction:o,currentWord:i}=t;if(r&&i)return n(r,i);o&&i&&(n(o,i),le.insert(o))},renderInlineSuggestion:()=>{let{prediction:r,currentWord:n}=t;if(r&&n){let o=wt({content:`${r.slice(n.length)}`});o.setAttribute("id","inlineSuggestion"),g(".suggestion").show().html(o)}},renderOptions:()=>{let r=g(".suggestion .options");r&&r.el&&r.el.remove();let n=t.options.selected,o=t.matches.map((s,c)=>xt({title:wt({content:s}),secondary:V(ae,"delete word"),onSecondaryClick:()=>{I.removeFromDictionary(s),z.setState({matches:t.matches.filter(l=>l!==s)}),z.renderOptions()},onclick:()=>{z.acceptCompletion(s)},icon:null},c===n)),i=document.createElement("ul");i.classList.add("options"),i.classList.add("frost"),o.forEach(s=>i.append(s)),g(".suggestion").el.append(i)},onFocus:()=>{B.hide(),g(".note-info").hide()},onInput:r=>{!!I.get("__autocomplete__")&&Ws(r),Js(r)},onArrowDown:r=>{t.matches.length>0&&(r.preventDefault(),z.selectOption("down"))},onArrowUp:r=>{t.matches.length>0&&(r.preventDefault(),z.selectOption("up"))},onEnter:r=>{t.matches.length>0&&(r.preventDefault(),z.acceptCompletion()),Ys(r)},onEscape:()=>{z.resetState(),g(".suggestion").hide()},onTab:r=>{r.preventDefault(),z.acceptCompletion()},onKeyDown:r=>{r.keyCode===13&&z.onEnter(r),r.keyCode===40&&z.onArrowDown(r),r.keyCode===38&&z.onArrowUp(r),r.keyCode===9&&z.onTab(r),r.keyCode===32&&z.setState({prediction:""}),r.keyCode===27&&z.onEscape()},onKeyUp:r=>{let n=Y(),o=Gt(r.target.value);g(".title h3").html(o);let{text:i=""}=n||{},s=!!(n&&z.el.getValue()===i);_t(s)},onPaste:async()=>{var n;let r=await navigator.clipboard.read();for(let o of r){let i=(n=o.types)==null?void 0:n.filter(s=>s.startsWith("image/"));for(let s of i){let c=await o.getType(s),l=I.get("MIROPAD_SECRET_TOKEN");if(l){let[d,m]=s.split("/"),y=`${Us()}.${m}`;g("#logo").addClass("loading");try{let{url:C}=await fetch(`${dt.file_service.api}?fileName=${y}`,{method:"POST",headers:{"x-secret-token":l,accept:"application/json","content-type":"application/octet-stream"},body:c}).then(Qr).then(P=>P.json());g(".terminal").insertAtCaret(`![image](${C})`)}catch(C){console.error(C),M.error("Uploading file failed \u{1F4A5}!")}g("#logo").removeClass("loading")}else{let d=URL.createObjectURL(c);g(".terminal").insertAtCaret(`![image](${d})`)}St.update()}}},init:function(){this.el.listen("focus",this.onFocus).listen("input",this.onInput).listen("keydown",this.onKeyDown).listen("keyup",this.onKeyUp).listen("paste",this.onPaste)}}})();var Ks=()=>{let{authToken:e,gistId:t}=I.get(["authToken","gistId"]);return!!(e&&t)};var Sh=e=>Object.entries(e).reduce((t,[r,n])=>{let o=t[n]||[];return{...t,[`${n}`]:[r,...o]}},{}),Xs=()=>({char:null,children:{},frequency:0,hasChildren:function(){return Object.keys(this.children).length>0},isWord:function(){return this.frequency>0},contains:function(e){return Object.keys(this.children).includes(e)},getWords:function(e,t={}){let r=this;if(r.isWord()&&(t={...t,[e]:this.frequency}),r.hasChildren())for(let n of Object.values(r.children))t=n.getWords(`${e}${n.char}`,t);return t},increaseFrequency:function(){this.frequency=this.frequency+1},insert:function(e){let[t,...r]=e;if(t){let n=r.length===0;if(this.contains(t)){let o=this.children[t];return o.char=t,n&&o.increaseFrequency(),o.insert(r.join(""))}else return this.insertNode(t,n).insert(r.join(""))}},insertNode:function(e,t=!1){let r=Xs();return t&&r.increaseFrequency(),r.char=e,this.children={...this.children,[e]:r},r}}),Qs=()=>{let e=Xs();return{insert:function(t=[]){return(Array.isArray(t)?t:[t]).forEach(n=>e.insert(n)),this},search:function(t=""){let r=e;return t.split("").forEach(n=>{r&&(r=r.children[n])}),r?r.getWords(t):{}},getMatchingWords:function(t=""){let r=Sh(this.search(t));return Object.keys(r).sort((n,o)=>parseInt(o,10)-parseInt(n,10)).flatMap(n=>r[n].sort())}}};var _h=e=>{let{message:t="Unexpected error occurred!"}=e;M.error(t)},Zs=_h;var Th=async e=>{if(e){let t=await fetch(e).then(r=>{if(r.ok)return r.text();throw new Error(`Remote note could not be retrieved! code: ${r.status}`)});g(".terminal").setValue(t)}},Ah=async e=>{if(e)try{let t=await ue(e),{files:r}=t,n=Object.values(r),[o]=n,{content:i}=o;g(".terminal").setValue(i)}catch{M.error("MiroPad note not found! \u{1F937}\u200D\u2642\uFE0F")}},ta=async e=>{try{let{oldURL:o,newURL:i}=e,s=O.getPageId(o),c=O.getPageId(i),l=s!==c,{v:d}=O.getParamsObject(o),{v:m}=O.getParamsObject(i);[l,d!==m].some(E=>E)&&ye();let{gistId:P,raw:N}=O.getParamsObject(i);await Ah(P),await Th(N)}catch(o){o instanceof Error?M.error(o.message):M.error("An unknown error occurred")}let t=!O.getPageId();g("#note-info-button").show(!t),g("#new-note").disable(t),O.getSearchParam("md")==="full"?g(".terminal").hide():g(".terminal").show(),O.getSearchParam("zen")==="true"?g(".header").hide():g(".header").show(),g(".note-info").hide();let r=O.getSearchParam("q"),n=bo(r);n&&g(".terminal").setValue(n.text)};var ea=()=>{g(".task-list-item").listenAll("click",e=>{e.firstChild.checked=!e.firstChild.checked})};var le=Qs(),Mh=()=>{g("#note-info-close").listen("click",()=>{g(".note-info").hide()}),g("#note-info-button").listen("click",()=>{let e=Y();if(g(".note-info").show(),g(".note-info .details").innerHTML(`<p>
      <label>
      Title
      </label>
      ${e.title}
      </p>
      <p>
        <label>
        Modified
        </label>
        ${ce(e.dateCreated)}
      </p>
      <p>
        <label>
        No. of revisions
        </label>
        ${e.numberOfRevisions}
      </p>
      `),Ks()&&e){let n=(()=>{let{disableSync:o}=e,i=document.createElement("P");return i.innerHTML=`
          <label>Sync</label>
            <label class="switch" title="Cloud Sync">
              <input id="sync" type="checkbox" ${!o&&"checked"}>
            <span class="slider round"></span>
          </label>
        `,i})();g(".note-info .details").append(n),g("#sync").listen("click",o=>{fo(!o.target.checked)})}let r=(()=>{let n=document.createElement("P");return n.innerHTML=`
          <button
            class="icon-button"
            type="button"
            id="delete-note"
          >
            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30" viewBox="-3 -3 27.5 27.5">
              <path  d="M15.5 2h-3.5v-0.5c0-0.827-0.673-1.5-1.5-1.5h-2c-0.827 0-1.5 0.673-1.5 1.5v0.5h-3.5c-0.827 0-1.5 0.673-1.5 1.5v1c0 0.652 0.418 1.208 1 1.414v12.586c0 0.827 0.673 1.5 1.5 1.5h10c0.827 0 1.5-0.673 1.5-1.5v-12.586c0.582-0.206 1-0.762 1-1.414v-1c0-0.827-0.673-1.5-1.5-1.5zM8 1.5c0-0.276 0.224-0.5 0.5-0.5h2c0.276 0 0.5 0.224 0.5 0.5v0.5h-3v-0.5zM14.5 19h-10c-0.276 0-0.5-0.224-0.5-0.5v-12.5h11v12.5c0 0.276-0.224 0.5-0.5 0.5zM16 4.5c0 0.276-0.224 0.5-0.5 0.5h-12c-0.276 0-0.5-0.224-0.5-0.5v-1c0-0.276 0.224-0.5 0.5-0.5h12c0.276 0 0.5 0.224 0.5 0.5v1z"></path>
              <path  d="M12.5 7c-0.276 0-0.5 0.224-0.5 0.5v10c0 0.276 0.224 0.5 0.5 0.5s0.5-0.224 0.5-0.5v-10c0-0.276-0.224-0.5-0.5-0.5z"></path>
              <path  d="M9.5 7c-0.276 0-0.5 0.224-0.5 0.5v10c0 0.276 0.224 0.5 0.5 0.5s0.5-0.224 0.5-0.5v-10c0-0.276-0.224-0.5-0.5-0.5z"></path>
              <path  d="M6.5 7c-0.276 0-0.5 0.224-0.5 0.5v10c0 0.276 0.224 0.5 0.5 0.5s0.5-0.224 0.5-0.5v-10c0-0.276-0.224-0.5-0.5-0.5z"></path>
            </svg>
            Delete
          </button>
        `,n})();g(".note-info .details").append(r),g("#delete-note").listen("click",()=>{ke()})})},Nh=async()=>{let e=I.getDictionary();le.insert(e),globalThis.addEventListener("error",Zs),Gn(),B.init(),Mh(),z.init(),be(),ye(O.getPageId()),g(".logo").listen("click",()=>{B.toggle(B.getModes().notes)}),g("#permalink").listen("click",async()=>{await kt(O.get())}),St.init(),globalThis.addEventListener("hashchange",ta),js(),ea(),await ee(),await Co()},ra=Nh;ra();
/*! Bundled license information:

mermaid/dist/mermaid.core.mjs:
  (*! Check if previously processed *)
  (*!
   * Wait for document loaded before starting the execution
   *)
*/
