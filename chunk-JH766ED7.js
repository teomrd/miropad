import{a as Qt}from"./chunk-RZDB7PMI.js";import{a as Ps,b as Mt,d as H,e as W}from"./chunk-DY3N5KYM.js";import{d as vt,g as ht}from"./chunk-BGEFB44P.js";import{i as kt,k as Bs,o as xt,q as U}from"./chunk-C5V5A4EQ.js";import{D as Wt,F as J,G as Yt,H as Vt,J as vs,K as Ds,W as Z,Z as Zt,q as ks,y as dt}from"./chunk-MBS5FVM4.js";import{b as $,d as F,j as Y}from"./chunk-RKLTPE72.js";function Jt(o,t,i){if(o&&o.length){let[e,s]=t,r=Math.PI/180*i,h=Math.cos(r),a=Math.sin(r);for(let c of o){let[n,l]=c;c[0]=(n-e)*h-(l-s)*a+e,c[1]=(n-e)*a+(l-s)*h+s}}}function ha(o,t){return o[0]===t[0]&&o[1]===t[1]}function ga(o,t,i,e=1){let s=i,r=Math.max(t,.1),h=o[0]&&o[0][0]&&typeof o[0][0]=="number"?[o]:o,a=[0,0];if(s)for(let n of h)Jt(n,a,s);let c=function(n,l,g){let f=[];for(let x of n){let b=[...x];ha(b[0],b[b.length-1])||b.push([b[0][0],b[0][1]]),b.length>2&&f.push(b)}let p=[];l=Math.max(l,.1);let u=[];for(let x of f)for(let b=0;b<x.length-1;b++){let M=x[b],w=x[b+1];if(M[1]!==w[1]){let v=Math.min(M[1],w[1]);u.push({ymin:v,ymax:Math.max(M[1],w[1]),x:v===M[1]?M[0]:w[0],islope:(w[0]-M[0])/(w[1]-M[1])})}}if(u.sort((x,b)=>x.ymin<b.ymin?-1:x.ymin>b.ymin?1:x.x<b.x?-1:x.x>b.x?1:x.ymax===b.ymax?0:(x.ymax-b.ymax)/Math.abs(x.ymax-b.ymax)),!u.length)return p;let y=[],d=u[0].ymin,m=0;for(;y.length||u.length;){if(u.length){let x=-1;for(let b=0;b<u.length&&!(u[b].ymin>d);b++)x=b;u.splice(0,x+1).forEach(b=>{y.push({s:d,edge:b})})}if(y=y.filter(x=>!(x.edge.ymax<=d)),y.sort((x,b)=>x.edge.x===b.edge.x?0:(x.edge.x-b.edge.x)/Math.abs(x.edge.x-b.edge.x)),(g!==1||m%l==0)&&y.length>1)for(let x=0;x<y.length;x+=2){let b=x+1;if(b>=y.length)break;let M=y[x].edge,w=y[b].edge;p.push([[Math.round(M.x),d],[Math.round(w.x),d]])}d+=g,y.forEach(x=>{x.edge.x=x.edge.x+g*x.edge.islope}),m++}return p}(h,r,e);if(s){for(let n of h)Jt(n,a,-s);(function(n,l,g){let f=[];n.forEach(p=>f.push(...p)),Jt(f,l,g)})(c,a,-s)}return c}function Ct(o,t){var i;let e=t.hachureAngle+90,s=t.hachureGap;s<0&&(s=4*t.strokeWidth),s=Math.round(Math.max(s,.1));let r=1;return t.roughness>=1&&(((i=t.randomizer)===null||i===void 0?void 0:i.next())||Math.random())>.7&&(r=s),ga(o,s,e,r||1)}var Bt=class{constructor(t){this.helper=t}fillPolygons(t,i){return this._fillPolygons(t,i)}_fillPolygons(t,i){let e=Ct(t,i);return{type:"fillSketch",ops:this.renderLines(e,i)}}renderLines(t,i){let e=[];for(let s of t)e.push(...this.helper.doubleLineOps(s[0][0],s[0][1],s[1][0],s[1][1],i));return e}};function Gt(o){let t=o[0],i=o[1];return Math.sqrt(Math.pow(t[0]-i[0],2)+Math.pow(t[1]-i[1],2))}var es=class extends Bt{fillPolygons(t,i){let e=i.hachureGap;e<0&&(e=4*i.strokeWidth),e=Math.max(e,.1);let s=Ct(t,Object.assign({},i,{hachureGap:e})),r=Math.PI/180*i.hachureAngle,h=[],a=.5*e*Math.cos(r),c=.5*e*Math.sin(r);for(let[n,l]of s)Gt([n,l])&&h.push([[n[0]-a,n[1]+c],[...l]],[[n[0]+a,n[1]-c],[...l]]);return{type:"fillSketch",ops:this.renderLines(h,i)}}},as=class extends Bt{fillPolygons(t,i){let e=this._fillPolygons(t,i),s=Object.assign({},i,{hachureAngle:i.hachureAngle+90}),r=this._fillPolygons(t,s);return e.ops=e.ops.concat(r.ops),e}},rs=class{constructor(t){this.helper=t}fillPolygons(t,i){let e=Ct(t,i=Object.assign({},i,{hachureAngle:0}));return this.dotsOnLines(e,i)}dotsOnLines(t,i){let e=[],s=i.hachureGap;s<0&&(s=4*i.strokeWidth),s=Math.max(s,.1);let r=i.fillWeight;r<0&&(r=i.strokeWidth/2);let h=s/4;for(let a of t){let c=Gt(a),n=c/s,l=Math.ceil(n)-1,g=c-l*s,f=(a[0][0]+a[1][0])/2-s/4,p=Math.min(a[0][1],a[1][1]);for(let u=0;u<l;u++){let y=p+g+u*s,d=f-h+2*Math.random()*h,m=y-h+2*Math.random()*h,x=this.helper.ellipse(d,m,r,r,i);e.push(...x.ops)}}return{type:"fillSketch",ops:e}}},is=class{constructor(t){this.helper=t}fillPolygons(t,i){let e=Ct(t,i);return{type:"fillSketch",ops:this.dashedLine(e,i)}}dashedLine(t,i){let e=i.dashOffset<0?i.hachureGap<0?4*i.strokeWidth:i.hachureGap:i.dashOffset,s=i.dashGap<0?i.hachureGap<0?4*i.strokeWidth:i.hachureGap:i.dashGap,r=[];return t.forEach(h=>{let a=Gt(h),c=Math.floor(a/(e+s)),n=(a+s-c*(e+s))/2,l=h[0],g=h[1];l[0]>g[0]&&(l=h[1],g=h[0]);let f=Math.atan((g[1]-l[1])/(g[0]-l[0]));for(let p=0;p<c;p++){let u=p*(e+s),y=u+e,d=[l[0]+u*Math.cos(f)+n*Math.cos(f),l[1]+u*Math.sin(f)+n*Math.sin(f)],m=[l[0]+y*Math.cos(f)+n*Math.cos(f),l[1]+y*Math.sin(f)+n*Math.sin(f)];r.push(...this.helper.doubleLineOps(d[0],d[1],m[0],m[1],i))}}),r}},ns=class{constructor(t){this.helper=t}fillPolygons(t,i){let e=i.hachureGap<0?4*i.strokeWidth:i.hachureGap,s=i.zigzagOffset<0?e:i.zigzagOffset,r=Ct(t,i=Object.assign({},i,{hachureGap:e+s}));return{type:"fillSketch",ops:this.zigzagLines(r,s,i)}}zigzagLines(t,i,e){let s=[];return t.forEach(r=>{let h=Gt(r),a=Math.round(h/(2*i)),c=r[0],n=r[1];c[0]>n[0]&&(c=r[1],n=r[0]);let l=Math.atan((n[1]-c[1])/(n[0]-c[0]));for(let g=0;g<a;g++){let f=2*g*i,p=2*(g+1)*i,u=Math.sqrt(2*Math.pow(i,2)),y=[c[0]+f*Math.cos(l),c[1]+f*Math.sin(l)],d=[c[0]+p*Math.cos(l),c[1]+p*Math.sin(l)],m=[y[0]+u*Math.cos(l+Math.PI/4),y[1]+u*Math.sin(l+Math.PI/4)];s.push(...this.helper.doubleLineOps(y[0],y[1],m[0],m[1],e),...this.helper.doubleLineOps(m[0],m[1],d[0],d[1],e))}}),s}},at={},ls=class{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}},pa=0,Kt=1,Cs=2,Tt={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function Ut(o,t){return o.type===t}function fs(o){let t=[],i=function(h){let a=new Array;for(;h!=="";)if(h.match(/^([ \t\r\n,]+)/))h=h.substr(RegExp.$1.length);else if(h.match(/^([aAcChHlLmMqQsStTvVzZ])/))a[a.length]={type:pa,text:RegExp.$1},h=h.substr(RegExp.$1.length);else{if(!h.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];a[a.length]={type:Kt,text:`${parseFloat(RegExp.$1)}`},h=h.substr(RegExp.$1.length)}return a[a.length]={type:Cs,text:""},a}(o),e="BOD",s=0,r=i[s];for(;!Ut(r,Cs);){let h=0,a=[];if(e==="BOD"){if(r.text!=="M"&&r.text!=="m")return fs("M0,0"+o);s++,h=Tt[r.text],e=r.text}else Ut(r,Kt)?h=Tt[e]:(s++,h=Tt[r.text],e=r.text);if(!(s+h<i.length))throw new Error("Path data ended short");for(let c=s;c<s+h;c++){let n=i[c];if(!Ut(n,Kt))throw new Error("Param not a number: "+e+","+n.text);a[a.length]=+n.text}if(typeof Tt[e]!="number")throw new Error("Bad segment: "+e);{let c={key:e,data:a};t.push(c),s+=h,r=i[s],e==="M"&&(e="L"),e==="m"&&(e="l")}}return t}function Is(o){let t=0,i=0,e=0,s=0,r=[];for(let{key:h,data:a}of o)switch(h){case"M":r.push({key:"M",data:[...a]}),[t,i]=a,[e,s]=a;break;case"m":t+=a[0],i+=a[1],r.push({key:"M",data:[t,i]}),e=t,s=i;break;case"L":r.push({key:"L",data:[...a]}),[t,i]=a;break;case"l":t+=a[0],i+=a[1],r.push({key:"L",data:[t,i]});break;case"C":r.push({key:"C",data:[...a]}),t=a[4],i=a[5];break;case"c":{let c=a.map((n,l)=>l%2?n+i:n+t);r.push({key:"C",data:c}),t=c[4],i=c[5];break}case"Q":r.push({key:"Q",data:[...a]}),t=a[2],i=a[3];break;case"q":{let c=a.map((n,l)=>l%2?n+i:n+t);r.push({key:"Q",data:c}),t=c[2],i=c[3];break}case"A":r.push({key:"A",data:[...a]}),t=a[5],i=a[6];break;case"a":t+=a[5],i+=a[6],r.push({key:"A",data:[a[0],a[1],a[2],a[3],a[4],t,i]});break;case"H":r.push({key:"H",data:[...a]}),t=a[0];break;case"h":t+=a[0],r.push({key:"H",data:[t]});break;case"V":r.push({key:"V",data:[...a]}),i=a[0];break;case"v":i+=a[0],r.push({key:"V",data:[i]});break;case"S":r.push({key:"S",data:[...a]}),t=a[2],i=a[3];break;case"s":{let c=a.map((n,l)=>l%2?n+i:n+t);r.push({key:"S",data:c}),t=c[2],i=c[3];break}case"T":r.push({key:"T",data:[...a]}),t=a[0],i=a[1];break;case"t":t+=a[0],i+=a[1],r.push({key:"T",data:[t,i]});break;case"Z":case"z":r.push({key:"Z",data:[]}),t=e,i=s}return r}function Es(o){let t=[],i="",e=0,s=0,r=0,h=0,a=0,c=0;for(let{key:n,data:l}of o){switch(n){case"M":t.push({key:"M",data:[...l]}),[e,s]=l,[r,h]=l;break;case"C":t.push({key:"C",data:[...l]}),e=l[4],s=l[5],a=l[2],c=l[3];break;case"L":t.push({key:"L",data:[...l]}),[e,s]=l;break;case"H":e=l[0],t.push({key:"L",data:[e,s]});break;case"V":s=l[0],t.push({key:"L",data:[e,s]});break;case"S":{let g=0,f=0;i==="C"||i==="S"?(g=e+(e-a),f=s+(s-c)):(g=e,f=s),t.push({key:"C",data:[g,f,...l]}),a=l[0],c=l[1],e=l[2],s=l[3];break}case"T":{let[g,f]=l,p=0,u=0;i==="Q"||i==="T"?(p=e+(e-a),u=s+(s-c)):(p=e,u=s);let y=e+2*(p-e)/3,d=s+2*(u-s)/3,m=g+2*(p-g)/3,x=f+2*(u-f)/3;t.push({key:"C",data:[y,d,m,x,g,f]}),a=p,c=u,e=g,s=f;break}case"Q":{let[g,f,p,u]=l,y=e+2*(g-e)/3,d=s+2*(f-s)/3,m=p+2*(g-p)/3,x=u+2*(f-u)/3;t.push({key:"C",data:[y,d,m,x,p,u]}),a=g,c=f,e=p,s=u;break}case"A":{let g=Math.abs(l[0]),f=Math.abs(l[1]),p=l[2],u=l[3],y=l[4],d=l[5],m=l[6];g===0||f===0?(t.push({key:"C",data:[e,s,d,m,d,m]}),e=d,s=m):(e!==d||s!==m)&&(Os(e,s,d,m,g,f,p,u,y).forEach(function(x){t.push({key:"C",data:x})}),e=d,s=m);break}case"Z":t.push({key:"Z",data:[]}),e=r,s=h}i=n}return t}function Dt(o,t,i){return[o*Math.cos(i)-t*Math.sin(i),o*Math.sin(i)+t*Math.cos(i)]}function Os(o,t,i,e,s,r,h,a,c,n){let l=(g=h,Math.PI*g/180);var g;let f=[],p=0,u=0,y=0,d=0;if(n)[p,u,y,d]=n;else{[o,t]=Dt(o,t,-l),[i,e]=Dt(i,e,-l);let P=(o-i)/2,B=(t-e)/2,T=P*P/(s*s)+B*B/(r*r);T>1&&(T=Math.sqrt(T),s*=T,r*=T);let N=s*s,O=r*r,_=N*O-N*B*B-O*P*P,Q=N*B*B+O*P*P,tt=(a===c?-1:1)*Math.sqrt(Math.abs(_/Q));y=tt*s*B/r+(o+i)/2,d=tt*-r*P/s+(t+e)/2,p=Math.asin(parseFloat(((t-d)/r).toFixed(9))),u=Math.asin(parseFloat(((e-d)/r).toFixed(9))),o<y&&(p=Math.PI-p),i<y&&(u=Math.PI-u),p<0&&(p=2*Math.PI+p),u<0&&(u=2*Math.PI+u),c&&p>u&&(p-=2*Math.PI),!c&&u>p&&(u-=2*Math.PI)}let m=u-p;if(Math.abs(m)>120*Math.PI/180){let P=u,B=i,T=e;u=c&&u>p?p+120*Math.PI/180*1:p+120*Math.PI/180*-1,f=Os(i=y+s*Math.cos(u),e=d+r*Math.sin(u),B,T,s,r,h,0,c,[u,P,y,d])}m=u-p;let x=Math.cos(p),b=Math.sin(p),M=Math.cos(u),w=Math.sin(u),v=Math.tan(m/4),k=4/3*s*v,D=4/3*r*v,R=[o,t],L=[o+k*b,t-D*x],C=[i+k*w,e-D*M],E=[i,e];if(L[0]=2*R[0]-L[0],L[1]=2*R[1]-L[1],n)return[L,C,E].concat(f);{f=[L,C,E].concat(f);let P=[];for(let B=0;B<f.length;B+=3){let T=Dt(f[B][0],f[B][1],l),N=Dt(f[B+1][0],f[B+1][1],l),O=Dt(f[B+2][0],f[B+2][1],l);P.push([T[0],T[1],N[0],N[1],O[0],O[1]])}return P}}var fa={randOffset:function(o,t){return j(o,t)},randOffsetWithRange:function(o,t,i){return _t(o,t,i)},ellipse:function(o,t,i,e,s){let r=zs(i,e,s);return cs(o,t,s,r).opset},doubleLineOps:function(o,t,i,e,s){return gt(o,t,i,e,s,!0)}};function _s(o,t,i,e,s){return{type:"path",ops:gt(o,t,i,e,s)}}function Et(o,t,i){let e=(o||[]).length;if(e>2){let s=[];for(let r=0;r<e-1;r++)s.push(...gt(o[r][0],o[r][1],o[r+1][0],o[r+1][1],i));return t&&s.push(...gt(o[e-1][0],o[e-1][1],o[0][0],o[0][1],i)),{type:"path",ops:s}}return e===2?_s(o[0][0],o[0][1],o[1][0],o[1][1],i):{type:"path",ops:[]}}function ua(o,t,i,e,s){return function(r,h){return Et(r,!0,h)}([[o,t],[o+i,t],[o+i,t+e],[o,t+e]],s)}function Rs(o,t){if(o.length){let i=typeof o[0][0]=="number"?[o]:o,e=Ht(i[0],1*(1+.2*t.roughness),t),s=t.disableMultiStroke?[]:Ht(i[0],1.5*(1+.22*t.roughness),Ls(t));for(let r=1;r<i.length;r++){let h=i[r];if(h.length){let a=Ht(h,1*(1+.2*t.roughness),t),c=t.disableMultiStroke?[]:Ht(h,1.5*(1+.22*t.roughness),Ls(t));for(let n of a)n.op!=="move"&&e.push(n);for(let n of c)n.op!=="move"&&s.push(n)}}return{type:"path",ops:e.concat(s)}}return{type:"path",ops:[]}}function zs(o,t,i){let e=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(o/2,2)+Math.pow(t/2,2))/2)),s=Math.ceil(Math.max(i.curveStepCount,i.curveStepCount/Math.sqrt(200)*e)),r=2*Math.PI/s,h=Math.abs(o/2),a=Math.abs(t/2),c=1-i.curveFitting;return h+=j(h*c,i),a+=j(a*c,i),{increment:r,rx:h,ry:a}}function cs(o,t,i,e){let[s,r]=Ws(e.increment,o,t,e.rx,e.ry,1,e.increment*_t(.1,_t(.4,1,i),i),i),h=zt(s,null,i);if(!i.disableMultiStroke&&i.roughness!==0){let[a]=Ws(e.increment,o,t,e.rx,e.ry,1.5,0,i),c=zt(a,null,i);h=h.concat(c)}return{estimatedPoints:r,opset:{type:"path",ops:h}}}function Ns(o,t,i,e,s,r,h,a,c){let n=o,l=t,g=Math.abs(i/2),f=Math.abs(e/2);g+=j(.01*g,c),f+=j(.01*f,c);let p=s,u=r;for(;p<0;)p+=2*Math.PI,u+=2*Math.PI;u-p>2*Math.PI&&(p=0,u=2*Math.PI);let y=2*Math.PI/c.curveStepCount,d=Math.min(y/2,(u-p)/2),m=Ts(d,n,l,g,f,p,u,1,c);if(!c.disableMultiStroke){let x=Ts(d,n,l,g,f,p,u,1.5,c);m.push(...x)}return h&&(a?m.push(...gt(n,l,n+g*Math.cos(p),l+f*Math.sin(p),c),...gt(n,l,n+g*Math.cos(u),l+f*Math.sin(u),c)):m.push({op:"lineTo",data:[n,l]},{op:"lineTo",data:[n+g*Math.cos(p),l+f*Math.sin(p)]})),{type:"path",ops:m}}function As(o,t){let i=Es(Is(fs(o))),e=[],s=[0,0],r=[0,0];for(let{key:h,data:a}of i)switch(h){case"M":r=[a[0],a[1]],s=[a[0],a[1]];break;case"L":e.push(...gt(r[0],r[1],a[0],a[1],t)),r=[a[0],a[1]];break;case"C":{let[c,n,l,g,f,p]=a;e.push(...ya(c,n,l,g,f,p,r,t)),r=[f,p];break}case"Z":e.push(...gt(r[0],r[1],s[0],s[1],t)),r=[s[0],s[1]]}return{type:"path",ops:e}}function ts(o,t){let i=[];for(let e of o)if(e.length){let s=t.maxRandomnessOffset||0,r=e.length;if(r>2){i.push({op:"move",data:[e[0][0]+j(s,t),e[0][1]+j(s,t)]});for(let h=1;h<r;h++)i.push({op:"lineTo",data:[e[h][0]+j(s,t),e[h][1]+j(s,t)]})}}return{type:"fillPath",ops:i}}function bt(o,t){return function(i,e){let s=i.fillStyle||"hachure";if(!at[s])switch(s){case"zigzag":at[s]||(at[s]=new es(e));break;case"cross-hatch":at[s]||(at[s]=new as(e));break;case"dots":at[s]||(at[s]=new rs(e));break;case"dashed":at[s]||(at[s]=new is(e));break;case"zigzag-line":at[s]||(at[s]=new ns(e));break;default:s="hachure",at[s]||(at[s]=new Bt(e))}return at[s]}(t,fa).fillPolygons(o,t)}function Ls(o){let t=Object.assign({},o);return t.randomizer=void 0,o.seed&&(t.seed=o.seed+1),t}function js(o){return o.randomizer||(o.randomizer=new ls(o.seed||0)),o.randomizer.next()}function _t(o,t,i,e=1){return i.roughness*e*(js(i)*(t-o)+o)}function j(o,t,i=1){return _t(-o,o,t,i)}function gt(o,t,i,e,s,r=!1){let h=r?s.disableMultiStrokeFill:s.disableMultiStroke,a=os(o,t,i,e,s,!0,!1);if(h)return a;let c=os(o,t,i,e,s,!0,!0);return a.concat(c)}function os(o,t,i,e,s,r,h){let a=Math.pow(o-i,2)+Math.pow(t-e,2),c=Math.sqrt(a),n=1;n=c<200?1:c>500?.4:-.0016668*c+1.233334;let l=s.maxRandomnessOffset||0;l*l*100>a&&(l=c/10);let g=l/2,f=.2+.2*js(s),p=s.bowing*s.maxRandomnessOffset*(e-t)/200,u=s.bowing*s.maxRandomnessOffset*(o-i)/200;p=j(p,s,n),u=j(u,s,n);let y=[],d=()=>j(g,s,n),m=()=>j(l,s,n),x=s.preserveVertices;return r&&(h?y.push({op:"move",data:[o+(x?0:d()),t+(x?0:d())]}):y.push({op:"move",data:[o+(x?0:j(l,s,n)),t+(x?0:j(l,s,n))]})),h?y.push({op:"bcurveTo",data:[p+o+(i-o)*f+d(),u+t+(e-t)*f+d(),p+o+2*(i-o)*f+d(),u+t+2*(e-t)*f+d(),i+(x?0:d()),e+(x?0:d())]}):y.push({op:"bcurveTo",data:[p+o+(i-o)*f+m(),u+t+(e-t)*f+m(),p+o+2*(i-o)*f+m(),u+t+2*(e-t)*f+m(),i+(x?0:m()),e+(x?0:m())]}),y}function Ht(o,t,i){if(!o.length)return[];let e=[];e.push([o[0][0]+j(t,i),o[0][1]+j(t,i)]),e.push([o[0][0]+j(t,i),o[0][1]+j(t,i)]);for(let s=1;s<o.length;s++)e.push([o[s][0]+j(t,i),o[s][1]+j(t,i)]),s===o.length-1&&e.push([o[s][0]+j(t,i),o[s][1]+j(t,i)]);return zt(e,null,i)}function zt(o,t,i){let e=o.length,s=[];if(e>3){let r=[],h=1-i.curveTightness;s.push({op:"move",data:[o[1][0],o[1][1]]});for(let a=1;a+2<e;a++){let c=o[a];r[0]=[c[0],c[1]],r[1]=[c[0]+(h*o[a+1][0]-h*o[a-1][0])/6,c[1]+(h*o[a+1][1]-h*o[a-1][1])/6],r[2]=[o[a+1][0]+(h*o[a][0]-h*o[a+2][0])/6,o[a+1][1]+(h*o[a][1]-h*o[a+2][1])/6],r[3]=[o[a+1][0],o[a+1][1]],s.push({op:"bcurveTo",data:[r[1][0],r[1][1],r[2][0],r[2][1],r[3][0],r[3][1]]})}if(t&&t.length===2){let a=i.maxRandomnessOffset;s.push({op:"lineTo",data:[t[0]+j(a,i),t[1]+j(a,i)]})}}else e===3?(s.push({op:"move",data:[o[1][0],o[1][1]]}),s.push({op:"bcurveTo",data:[o[1][0],o[1][1],o[2][0],o[2][1],o[2][0],o[2][1]]})):e===2&&s.push(...os(o[0][0],o[0][1],o[1][0],o[1][1],i,!0,!0));return s}function Ws(o,t,i,e,s,r,h,a){let c=[],n=[];if(a.roughness===0){o/=4,n.push([t+e*Math.cos(-o),i+s*Math.sin(-o)]);for(let l=0;l<=2*Math.PI;l+=o){let g=[t+e*Math.cos(l),i+s*Math.sin(l)];c.push(g),n.push(g)}n.push([t+e*Math.cos(0),i+s*Math.sin(0)]),n.push([t+e*Math.cos(o),i+s*Math.sin(o)])}else{let l=j(.5,a)-Math.PI/2;n.push([j(r,a)+t+.9*e*Math.cos(l-o),j(r,a)+i+.9*s*Math.sin(l-o)]);let g=2*Math.PI+l-.01;for(let f=l;f<g;f+=o){let p=[j(r,a)+t+e*Math.cos(f),j(r,a)+i+s*Math.sin(f)];c.push(p),n.push(p)}n.push([j(r,a)+t+e*Math.cos(l+2*Math.PI+.5*h),j(r,a)+i+s*Math.sin(l+2*Math.PI+.5*h)]),n.push([j(r,a)+t+.98*e*Math.cos(l+h),j(r,a)+i+.98*s*Math.sin(l+h)]),n.push([j(r,a)+t+.9*e*Math.cos(l+.5*h),j(r,a)+i+.9*s*Math.sin(l+.5*h)])}return[n,c]}function Ts(o,t,i,e,s,r,h,a,c){let n=r+j(.1,c),l=[];l.push([j(a,c)+t+.9*e*Math.cos(n-o),j(a,c)+i+.9*s*Math.sin(n-o)]);for(let g=n;g<=h;g+=o)l.push([j(a,c)+t+e*Math.cos(g),j(a,c)+i+s*Math.sin(g)]);return l.push([t+e*Math.cos(h),i+s*Math.sin(h)]),l.push([t+e*Math.cos(h),i+s*Math.sin(h)]),zt(l,null,c)}function ya(o,t,i,e,s,r,h,a){let c=[],n=[a.maxRandomnessOffset||1,(a.maxRandomnessOffset||1)+.3],l=[0,0],g=a.disableMultiStroke?1:2,f=a.preserveVertices;for(let p=0;p<g;p++)p===0?c.push({op:"move",data:[h[0],h[1]]}):c.push({op:"move",data:[h[0]+(f?0:j(n[0],a)),h[1]+(f?0:j(n[0],a))]}),l=f?[s,r]:[s+j(n[p],a),r+j(n[p],a)],c.push({op:"bcurveTo",data:[o+j(n[p],a),t+j(n[p],a),i+j(n[p],a),e+j(n[p],a),l[0],l[1]]});return c}function Pt(o){return[...o]}function Hs(o,t=0){let i=o.length;if(i<3)throw new Error("A curve must have at least three points.");let e=[];if(i===3)e.push(Pt(o[0]),Pt(o[1]),Pt(o[2]),Pt(o[2]));else{let s=[];s.push(o[0],o[0]);for(let a=1;a<o.length;a++)s.push(o[a]),a===o.length-1&&s.push(o[a]);let r=[],h=1-t;e.push(Pt(s[0]));for(let a=1;a+2<s.length;a++){let c=s[a];r[0]=[c[0],c[1]],r[1]=[c[0]+(h*s[a+1][0]-h*s[a-1][0])/6,c[1]+(h*s[a+1][1]-h*s[a-1][1])/6],r[2]=[s[a+1][0]+(h*s[a][0]-h*s[a+2][0])/6,s[a+1][1]+(h*s[a][1]-h*s[a+2][1])/6],r[3]=[s[a+1][0],s[a+1][1]],e.push(r[1],r[2],r[3])}}return e}function Ot(o,t){return Math.pow(o[0]-t[0],2)+Math.pow(o[1]-t[1],2)}function ma(o,t,i){let e=Ot(t,i);if(e===0)return Ot(o,t);let s=((o[0]-t[0])*(i[0]-t[0])+(o[1]-t[1])*(i[1]-t[1]))/e;return s=Math.max(0,Math.min(1,s)),Ot(o,mt(t,i,s))}function mt(o,t,i){return[o[0]+(t[0]-o[0])*i,o[1]+(t[1]-o[1])*i]}function hs(o,t,i,e){let s=e||[];if(function(a,c){let n=a[c+0],l=a[c+1],g=a[c+2],f=a[c+3],p=3*l[0]-2*n[0]-f[0];p*=p;let u=3*l[1]-2*n[1]-f[1];u*=u;let y=3*g[0]-2*f[0]-n[0];y*=y;let d=3*g[1]-2*f[1]-n[1];return d*=d,p<y&&(p=y),u<d&&(u=d),p+u}(o,t)<i){let a=o[t+0];s.length?(r=s[s.length-1],h=a,Math.sqrt(Ot(r,h))>1&&s.push(a)):s.push(a),s.push(o[t+3])}else{let c=o[t+0],n=o[t+1],l=o[t+2],g=o[t+3],f=mt(c,n,.5),p=mt(n,l,.5),u=mt(l,g,.5),y=mt(f,p,.5),d=mt(p,u,.5),m=mt(y,d,.5);hs([c,f,y,m],0,i,s),hs([m,d,u,g],0,i,s)}var r,h;return s}function da(o,t){return jt(o,0,o.length,t)}function jt(o,t,i,e,s){let r=s||[],h=o[t],a=o[i-1],c=0,n=1;for(let l=t+1;l<i-1;++l){let g=ma(o[l],h,a);g>c&&(c=g,n=l)}return Math.sqrt(c)>e?(jt(o,t,n+1,e,r),jt(o,n,i,e,r)):(r.length||r.push(h),r.push(a)),r}function ss(o,t=.15,i){let e=[],s=(o.length-1)/3;for(let r=0;r<s;r++)hs(o,3*r,t,e);return i&&i>0?jt(e,0,e.length,i):e}var it="none",wt=class{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,i,e){return{shape:t,sets:i||[],options:e||this.defaultOptions}}line(t,i,e,s,r){let h=this._o(r);return this._d("line",[_s(t,i,e,s,h)],h)}rectangle(t,i,e,s,r){let h=this._o(r),a=[],c=ua(t,i,e,s,h);if(h.fill){let n=[[t,i],[t+e,i],[t+e,i+s],[t,i+s]];h.fillStyle==="solid"?a.push(ts([n],h)):a.push(bt([n],h))}return h.stroke!==it&&a.push(c),this._d("rectangle",a,h)}ellipse(t,i,e,s,r){let h=this._o(r),a=[],c=zs(e,s,h),n=cs(t,i,h,c);if(h.fill)if(h.fillStyle==="solid"){let l=cs(t,i,h,c).opset;l.type="fillPath",a.push(l)}else a.push(bt([n.estimatedPoints],h));return h.stroke!==it&&a.push(n.opset),this._d("ellipse",a,h)}circle(t,i,e,s){let r=this.ellipse(t,i,e,e,s);return r.shape="circle",r}linearPath(t,i){let e=this._o(i);return this._d("linearPath",[Et(t,!1,e)],e)}arc(t,i,e,s,r,h,a=!1,c){let n=this._o(c),l=[],g=Ns(t,i,e,s,r,h,a,!0,n);if(a&&n.fill)if(n.fillStyle==="solid"){let f=Object.assign({},n);f.disableMultiStroke=!0;let p=Ns(t,i,e,s,r,h,!0,!1,f);p.type="fillPath",l.push(p)}else l.push(function(f,p,u,y,d,m,x){let b=f,M=p,w=Math.abs(u/2),v=Math.abs(y/2);w+=j(.01*w,x),v+=j(.01*v,x);let k=d,D=m;for(;k<0;)k+=2*Math.PI,D+=2*Math.PI;D-k>2*Math.PI&&(k=0,D=2*Math.PI);let R=(D-k)/x.curveStepCount,L=[];for(let C=k;C<=D;C+=R)L.push([b+w*Math.cos(C),M+v*Math.sin(C)]);return L.push([b+w*Math.cos(D),M+v*Math.sin(D)]),L.push([b,M]),bt([L],x)}(t,i,e,s,r,h,n));return n.stroke!==it&&l.push(g),this._d("arc",l,n)}curve(t,i){let e=this._o(i),s=[],r=Rs(t,e);if(e.fill&&e.fill!==it)if(e.fillStyle==="solid"){let h=Rs(t,Object.assign(Object.assign({},e),{disableMultiStroke:!0,roughness:e.roughness?e.roughness+e.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(h.ops)})}else{let h=[],a=t;if(a.length){let c=typeof a[0][0]=="number"?[a]:a;for(let n of c)n.length<3?h.push(...n):n.length===3?h.push(...ss(Hs([n[0],n[0],n[1],n[2]]),10,(1+e.roughness)/2)):h.push(...ss(Hs(n),10,(1+e.roughness)/2))}h.length&&s.push(bt([h],e))}return e.stroke!==it&&s.push(r),this._d("curve",s,e)}polygon(t,i){let e=this._o(i),s=[],r=Et(t,!0,e);return e.fill&&(e.fillStyle==="solid"?s.push(ts([t],e)):s.push(bt([t],e))),e.stroke!==it&&s.push(r),this._d("polygon",s,e)}path(t,i){let e=this._o(i),s=[];if(!t)return this._d("path",s,e);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");let r=e.fill&&e.fill!=="transparent"&&e.fill!==it,h=e.stroke!==it,a=!!(e.simplification&&e.simplification<1),c=function(l,g,f){let p=Es(Is(fs(l))),u=[],y=[],d=[0,0],m=[],x=()=>{m.length>=4&&y.push(...ss(m,g)),m=[]},b=()=>{x(),y.length&&(u.push(y),y=[])};for(let{key:w,data:v}of p)switch(w){case"M":b(),d=[v[0],v[1]],y.push(d);break;case"L":x(),y.push([v[0],v[1]]);break;case"C":if(!m.length){let k=y.length?y[y.length-1]:d;m.push([k[0],k[1]])}m.push([v[0],v[1]]),m.push([v[2],v[3]]),m.push([v[4],v[5]]);break;case"Z":x(),y.push([d[0],d[1]])}if(b(),!f)return u;let M=[];for(let w of u){let v=da(w,f);v.length&&M.push(v)}return M}(t,1,a?4-4*(e.simplification||1):(1+e.roughness)/2),n=As(t,e);if(r)if(e.fillStyle==="solid")if(c.length===1){let l=As(t,Object.assign(Object.assign({},e),{disableMultiStroke:!0,roughness:e.roughness?e.roughness+e.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(l.ops)})}else s.push(ts(c,e));else s.push(bt(c,e));return h&&(a?c.forEach(l=>{s.push(Et(l,!1,e))}):s.push(n)),this._d("path",s,e)}opsToPath(t,i){let e="";for(let s of t.ops){let r=typeof i=="number"&&i>=0?s.data.map(h=>+h.toFixed(i)):s.data;switch(s.op){case"move":e+=`M${r[0]} ${r[1]} `;break;case"bcurveTo":e+=`C${r[0]} ${r[1]}, ${r[2]} ${r[3]}, ${r[4]} ${r[5]} `;break;case"lineTo":e+=`L${r[0]} ${r[1]} `}}return e.trim()}toPaths(t){let i=t.sets||[],e=t.options||this.defaultOptions,s=[];for(let r of i){let h=null;switch(r.type){case"path":h={d:this.opsToPath(r),stroke:e.stroke,strokeWidth:e.strokeWidth,fill:it};break;case"fillPath":h={d:this.opsToPath(r),stroke:it,strokeWidth:0,fill:e.fill||it};break;case"fillSketch":h=this.fillSketch(r,e)}h&&s.push(h)}return s}fillSketch(t,i){let e=i.fillWeight;return e<0&&(e=i.strokeWidth/2),{d:this.opsToPath(t),stroke:i.fill||it,strokeWidth:e,fill:it}}_mergedShape(t){return t.filter((i,e)=>e===0||i.op!=="move")}},gs=class{constructor(t,i){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new wt(i)}draw(t){let i=t.sets||[],e=t.options||this.getDefaultOptions(),s=this.ctx,r=t.options.fixedDecimalPlaceDigits;for(let h of i)switch(h.type){case"path":s.save(),s.strokeStyle=e.stroke==="none"?"transparent":e.stroke,s.lineWidth=e.strokeWidth,e.strokeLineDash&&s.setLineDash(e.strokeLineDash),e.strokeLineDashOffset&&(s.lineDashOffset=e.strokeLineDashOffset),this._drawToContext(s,h,r),s.restore();break;case"fillPath":{s.save(),s.fillStyle=e.fill||"";let a=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(s,h,r,a),s.restore();break}case"fillSketch":this.fillSketch(s,h,e)}}fillSketch(t,i,e){let s=e.fillWeight;s<0&&(s=e.strokeWidth/2),t.save(),e.fillLineDash&&t.setLineDash(e.fillLineDash),e.fillLineDashOffset&&(t.lineDashOffset=e.fillLineDashOffset),t.strokeStyle=e.fill||"",t.lineWidth=s,this._drawToContext(t,i,e.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,i,e,s="nonzero"){t.beginPath();for(let r of i.ops){let h=typeof e=="number"&&e>=0?r.data.map(a=>+a.toFixed(e)):r.data;switch(r.op){case"move":t.moveTo(h[0],h[1]);break;case"bcurveTo":t.bezierCurveTo(h[0],h[1],h[2],h[3],h[4],h[5]);break;case"lineTo":t.lineTo(h[0],h[1])}}i.type==="fillPath"?t.fill(s):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,i,e,s,r){let h=this.gen.line(t,i,e,s,r);return this.draw(h),h}rectangle(t,i,e,s,r){let h=this.gen.rectangle(t,i,e,s,r);return this.draw(h),h}ellipse(t,i,e,s,r){let h=this.gen.ellipse(t,i,e,s,r);return this.draw(h),h}circle(t,i,e,s){let r=this.gen.circle(t,i,e,s);return this.draw(r),r}linearPath(t,i){let e=this.gen.linearPath(t,i);return this.draw(e),e}polygon(t,i){let e=this.gen.polygon(t,i);return this.draw(e),e}arc(t,i,e,s,r,h,a=!1,c){let n=this.gen.arc(t,i,e,s,r,h,a,c);return this.draw(n),n}curve(t,i){let e=this.gen.curve(t,i);return this.draw(e),e}path(t,i){let e=this.gen.path(t,i);return this.draw(e),e}},It="http://www.w3.org/2000/svg",ps=class{constructor(t,i){this.svg=t,this.gen=new wt(i)}draw(t){let i=t.sets||[],e=t.options||this.getDefaultOptions(),s=this.svg.ownerDocument||window.document,r=s.createElementNS(It,"g"),h=t.options.fixedDecimalPlaceDigits;for(let a of i){let c=null;switch(a.type){case"path":c=s.createElementNS(It,"path"),c.setAttribute("d",this.opsToPath(a,h)),c.setAttribute("stroke",e.stroke),c.setAttribute("stroke-width",e.strokeWidth+""),c.setAttribute("fill","none"),e.strokeLineDash&&c.setAttribute("stroke-dasharray",e.strokeLineDash.join(" ").trim()),e.strokeLineDashOffset&&c.setAttribute("stroke-dashoffset",`${e.strokeLineDashOffset}`);break;case"fillPath":c=s.createElementNS(It,"path"),c.setAttribute("d",this.opsToPath(a,h)),c.setAttribute("stroke","none"),c.setAttribute("stroke-width","0"),c.setAttribute("fill",e.fill||""),t.shape!=="curve"&&t.shape!=="polygon"||c.setAttribute("fill-rule","evenodd");break;case"fillSketch":c=this.fillSketch(s,a,e)}c&&r.appendChild(c)}return r}fillSketch(t,i,e){let s=e.fillWeight;s<0&&(s=e.strokeWidth/2);let r=t.createElementNS(It,"path");return r.setAttribute("d",this.opsToPath(i,e.fixedDecimalPlaceDigits)),r.setAttribute("stroke",e.fill||""),r.setAttribute("stroke-width",s+""),r.setAttribute("fill","none"),e.fillLineDash&&r.setAttribute("stroke-dasharray",e.fillLineDash.join(" ").trim()),e.fillLineDashOffset&&r.setAttribute("stroke-dashoffset",`${e.fillLineDashOffset}`),r}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,i){return this.gen.opsToPath(t,i)}line(t,i,e,s,r){let h=this.gen.line(t,i,e,s,r);return this.draw(h)}rectangle(t,i,e,s,r){let h=this.gen.rectangle(t,i,e,s,r);return this.draw(h)}ellipse(t,i,e,s,r){let h=this.gen.ellipse(t,i,e,s,r);return this.draw(h)}circle(t,i,e,s){let r=this.gen.circle(t,i,e,s);return this.draw(r)}linearPath(t,i){let e=this.gen.linearPath(t,i);return this.draw(e)}polygon(t,i){let e=this.gen.polygon(t,i);return this.draw(e)}arc(t,i,e,s,r,h,a=!1,c){let n=this.gen.arc(t,i,e,s,r,h,a,c);return this.draw(n)}curve(t,i){let e=this.gen.curve(t,i);return this.draw(e)}path(t,i){let e=this.gen.path(t,i);return this.draw(e)}},S={canvas:(o,t)=>new gs(o,t),svg:(o,t)=>new ps(o,t),generator:o=>new wt(o),newSeed:()=>wt.newSeed()};var G=$(async(o,t,i)=>{var g,f;let e,s=t.useHtmlLabels||J((g=Z())==null?void 0:g.htmlLabels);i?e=i:e="node default";let r=o.insert("g").attr("class",e).attr("id",t.domId||t.id),h=r.insert("g").attr("class","label").attr("style",U(t.labelStyle)),a;t.label===void 0?a="":a=typeof t.label=="string"?t.label:t.label[0];let c=await ht(h,Wt(xt(a),Z()),{useHtmlLabels:s,width:t.width||((f=Z().flowchart)==null?void 0:f.wrappingWidth),cssClasses:"markdown-node-label",style:t.labelStyle,addSvgBackground:!!t.icon||!!t.img}),n=c.getBBox(),l=((t==null?void 0:t.padding)??0)/2;if(s){let p=c.children[0],u=Y(c),y=p.getElementsByTagName("img");if(y){let d=a.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...y].map(m=>new Promise(x=>{function b(){if(m.style.display="flex",m.style.flexDirection="column",d){let M=Z().fontSize?Z().fontSize:window.getComputedStyle(document.body).fontSize,w=5,[v=ks.fontSize]=Bs(M),k=v*w+"px";m.style.minWidth=k,m.style.maxWidth=k}else m.style.width="100%";x(m)}$(b,"setupImage"),setTimeout(()=>{m.complete&&b()}),m.addEventListener("error",b),m.addEventListener("load",b)})))}n=p.getBoundingClientRect(),u.attr("width",n.width),u.attr("height",n.height)}return s?h.attr("transform","translate("+-n.width/2+", "+-n.height/2+")"):h.attr("transform","translate(0, "+-n.height/2+")"),t.centerLabel&&h.attr("transform","translate("+-n.width/2+", "+-n.height/2+")"),h.insert("rect",":first-child"),{shapeSvg:r,bbox:n,halfPadding:l,label:h}},"labelHelper"),us=$(async(o,t,i)=>{var c,n,l,g,f,p;let e=i.useHtmlLabels||J((n=(c=Z())==null?void 0:c.flowchart)==null?void 0:n.htmlLabels),s=o.insert("g").attr("class","label").attr("style",i.labelStyle||""),r=await ht(s,Wt(xt(t),Z()),{useHtmlLabels:e,width:i.width||((g=(l=Z())==null?void 0:l.flowchart)==null?void 0:g.wrappingWidth),style:i.labelStyle,addSvgBackground:!!i.icon||!!i.img}),h=r.getBBox(),a=i.padding/2;if(J((p=(f=Z())==null?void 0:f.flowchart)==null?void 0:p.htmlLabels)){let u=r.children[0],y=Y(r);h=u.getBoundingClientRect(),y.attr("width",h.width),y.attr("height",h.height)}return e?s.attr("transform","translate("+-h.width/2+", "+-h.height/2+")"):s.attr("transform","translate(0, "+-h.height/2+")"),i.centerLabel&&s.attr("transform","translate("+-h.width/2+", "+-h.height/2+")"),s.insert("rect",":first-child"),{shapeSvg:o,bbox:h,halfPadding:a,label:s}},"insertLabel"),I=$((o,t)=>{let i=t.node().getBBox();o.width=i.width,o.height=i.height},"updateNodeBounds"),z=$((o,t)=>(o.look==="handDrawn"?"rough-node":"node")+" "+o.cssClasses+" "+(t||""),"getNodeClasses");function q(o){let t=o.map((i,e)=>`${e===0?"M":"L"}${i.x},${i.y}`);return t.push("Z"),t.join(" ")}$(q,"createPathFromPoints");function pt(o,t,i,e,s,r){let h=[],c=i-o,n=e-t,l=c/r,g=2*Math.PI/l,f=t+n/2;for(let p=0;p<=50;p++){let u=p/50,y=o+u*c,d=f+s*Math.sin(g*(y-o));h.push({x:y,y:d})}return h}$(pt,"generateFullSineWavePoints");function At(o,t,i,e,s,r){let h=[],a=s*Math.PI/180,l=(r*Math.PI/180-a)/(e-1);for(let g=0;g<e;g++){let f=a+g*l,p=o+i*Math.cos(f),u=t+i*Math.sin(f);h.push({x:-p,y:-u})}return h}$(At,"generateCirclePoints");var xa=$((o,t)=>{var i=o.x,e=o.y,s=t.x-i,r=t.y-e,h=o.width/2,a=o.height/2,c,n;return Math.abs(r)*h>Math.abs(s)*a?(r<0&&(a=-a),c=r===0?0:a*s/r,n=a):(s<0&&(h=-h),c=h,n=s===0?0:h*r/s),{x:i+c,y:e+n}},"intersectRect"),$t=xa;function Gs(o,t){t&&o.attr("style",t)}$(Gs,"applyStyle");async function qs(o){let t=Y(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),i=t.append("xhtml:div"),e=Z(),s=o.label;o.label&&Vt(o.label)&&(s=await vs(o.label.replace(Ds.lineBreakRegex,`
`),e));let h='<span class="'+(o.isNode?"nodeLabel":"edgeLabel")+'" '+(o.labelStyle?'style="'+o.labelStyle+'"':"")+">"+s+"</span>";return i.html(Wt(h,e)),Gs(i,o.labelStyle),i.style("display","inline-block"),i.style("padding-right","1px"),i.style("white-space","nowrap"),i.attr("xmlns","http://www.w3.org/1999/xhtml"),t.node()}$(qs,"addHtmlLabel");var ba=$(async(o,t,i,e)=>{let s=o||"";if(typeof s=="object"&&(s=s[0]),J(Z().flowchart.htmlLabels)){s=s.replace(/\\n|\n/g,"<br />"),F.info("vertexText"+s);let r={isNode:e,label:xt(s).replace(/fa[blrs]?:fa-[\w-]+/g,a=>`<i class='${a.replace(":"," ")}'></i>`),labelStyle:t&&t.replace("fill:","color:")};return await qs(r)}else{let r=document.createElementNS("http://www.w3.org/2000/svg","text");r.setAttribute("style",t.replace("color:","fill:"));let h=[];typeof s=="string"?h=s.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(s)?h=s:h=[];for(let a of h){let c=document.createElementNS("http://www.w3.org/2000/svg","tspan");c.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),c.setAttribute("dy","1em"),c.setAttribute("x","0"),i?c.setAttribute("class","title-row"):c.setAttribute("class","row"),c.textContent=a.trim(),r.appendChild(c)}return r}},"createLabel"),ys=ba,ft=$((o,t,i,e,s)=>["M",o+s,t,"H",o+i-s,"A",s,s,0,0,1,o+i,t+s,"V",t+e-s,"A",s,s,0,0,1,o+i-s,t+e,"H",o+s,"A",s,s,0,0,1,o,t+e-s,"V",t+s,"A",s,s,0,0,1,o+s,t,"Z"].join(" "),"createRoundedRectPathD"),Fs=$(async(o,t)=>{F.info("Creating subgraph rect for ",t.id,t);let i=Z(),{themeVariables:e,handDrawnSeed:s}=i,{clusterBkg:r,clusterBorder:h}=e,{labelStyles:a,nodeStyles:c,borderStyles:n,backgroundStyles:l}=H(t),g=o.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),f=J(i.flowchart.htmlLabels),p=g.insert("g").attr("class","cluster-label "),u=await ht(p,t.label,{style:t.labelStyle,useHtmlLabels:f,isNode:!0}),y=u.getBBox();if(J(i.flowchart.htmlLabels)){let k=u.children[0],D=Y(u);y=k.getBoundingClientRect(),D.attr("width",y.width),D.attr("height",y.height)}let d=t.width<=y.width+t.padding?y.width+t.padding:t.width;t.width<=y.width+t.padding?t.diff=(d-t.width)/2-t.padding:t.diff=-t.padding;let m=t.height,x=t.x-d/2,b=t.y-m/2;F.trace("Data ",t,JSON.stringify(t));let M;if(t.look==="handDrawn"){let k=S.svg(g),D=W(t,{roughness:.7,fill:r,stroke:h,fillWeight:3,seed:s}),R=k.path(ft(x,b,d,m,0),D);M=g.insert(()=>(F.debug("Rough node insert CXC",R),R),":first-child"),M.select("path:nth-child(2)").attr("style",n.join(";")),M.select("path").attr("style",l.join(";").replace("fill","stroke"))}else M=g.insert("rect",":first-child"),M.attr("style",c).attr("rx",t.rx).attr("ry",t.ry).attr("x",x).attr("y",b).attr("width",d).attr("height",m);let{subGraphTitleTopMargin:w}=Qt(i);if(p.attr("transform",`translate(${t.x-y.width/2}, ${t.y-t.height/2+w})`),a){let k=p.select("span");k&&k.attr("style",a)}let v=M.node().getBBox();return t.offsetX=0,t.width=v.width,t.height=v.height,t.offsetY=y.height-t.padding/2,t.intersect=function(k){return $t(t,k)},{cluster:g,labelBBox:y}},"rect"),wa=$((o,t)=>{let i=o.insert("g").attr("class","note-cluster").attr("id",t.id),e=i.insert("rect",":first-child"),s=0*t.padding,r=s/2;e.attr("rx",t.rx).attr("ry",t.ry).attr("x",t.x-t.width/2-r).attr("y",t.y-t.height/2-r).attr("width",t.width+s).attr("height",t.height+s).attr("fill","none");let h=e.node().getBBox();return t.width=h.width,t.height=h.height,t.intersect=function(a){return $t(t,a)},{cluster:i,labelBBox:{width:0,height:0}}},"noteGroup"),Sa=$(async(o,t)=>{let i=Z(),{themeVariables:e,handDrawnSeed:s}=i,{altBackground:r,compositeBackground:h,compositeTitleBackground:a,nodeBorder:c}=e,n=o.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-id",t.id).attr("data-look",t.look),l=n.insert("g",":first-child"),g=n.insert("g").attr("class","cluster-label"),f=n.append("rect"),p=g.node().appendChild(await ys(t.label,t.labelStyle,void 0,!0)),u=p.getBBox();if(J(i.flowchart.htmlLabels)){let R=p.children[0],L=Y(p);u=R.getBoundingClientRect(),L.attr("width",u.width),L.attr("height",u.height)}let y=0*t.padding,d=y/2,m=(t.width<=u.width+t.padding?u.width+t.padding:t.width)+y;t.width<=u.width+t.padding?t.diff=(m-t.width)/2-t.padding:t.diff=-t.padding;let x=t.height+y,b=t.height+y-u.height-6,M=t.x-m/2,w=t.y-x/2;t.width=m;let v=t.y-t.height/2-d+u.height+2,k;if(t.look==="handDrawn"){let R=t.cssClasses.includes("statediagram-cluster-alt"),L=S.svg(n),C=t.rx||t.ry?L.path(ft(M,w,m,x,10),{roughness:.7,fill:a,fillStyle:"solid",stroke:c,seed:s}):L.rectangle(M,w,m,x,{seed:s});k=n.insert(()=>C,":first-child");let E=L.rectangle(M,v,m,b,{fill:R?r:h,fillStyle:R?"hachure":"solid",stroke:c,seed:s});k=n.insert(()=>C,":first-child"),f=n.insert(()=>E)}else k=l.insert("rect",":first-child"),k.attr("class","outer").attr("x",M).attr("y",w).attr("width",m).attr("height",x).attr("data-look",t.look),f.attr("class","inner").attr("x",M).attr("y",v).attr("width",m).attr("height",b);g.attr("transform",`translate(${t.x-u.width/2}, ${w+1-(J(i.flowchart.htmlLabels)?0:3)})`);let D=k.node().getBBox();return t.height=D.height,t.offsetX=0,t.offsetY=u.height-t.padding/2,t.labelBBox=u,t.intersect=function(R){return $t(t,R)},{cluster:n,labelBBox:u}},"roundedWithTitle"),$a=$(async(o,t)=>{F.info("Creating subgraph rect for ",t.id,t);let i=Z(),{themeVariables:e,handDrawnSeed:s}=i,{clusterBkg:r,clusterBorder:h}=e,{labelStyles:a,nodeStyles:c,borderStyles:n,backgroundStyles:l}=H(t),g=o.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),f=J(i.flowchart.htmlLabels),p=g.insert("g").attr("class","cluster-label "),u=await ht(p,t.label,{style:t.labelStyle,useHtmlLabels:f,isNode:!0,width:t.width}),y=u.getBBox();if(J(i.flowchart.htmlLabels)){let k=u.children[0],D=Y(u);y=k.getBoundingClientRect(),D.attr("width",y.width),D.attr("height",y.height)}let d=t.width<=y.width+t.padding?y.width+t.padding:t.width;t.width<=y.width+t.padding?t.diff=(d-t.width)/2-t.padding:t.diff=-t.padding;let m=t.height,x=t.x-d/2,b=t.y-m/2;F.trace("Data ",t,JSON.stringify(t));let M;if(t.look==="handDrawn"){let k=S.svg(g),D=W(t,{roughness:.7,fill:r,stroke:h,fillWeight:4,seed:s}),R=k.path(ft(x,b,d,m,t.rx),D);M=g.insert(()=>(F.debug("Rough node insert CXC",R),R),":first-child"),M.select("path:nth-child(2)").attr("style",n.join(";")),M.select("path").attr("style",l.join(";").replace("fill","stroke"))}else M=g.insert("rect",":first-child"),M.attr("style",c).attr("rx",t.rx).attr("ry",t.ry).attr("x",x).attr("y",b).attr("width",d).attr("height",m);let{subGraphTitleTopMargin:w}=Qt(i);if(p.attr("transform",`translate(${t.x-y.width/2}, ${t.y-t.height/2+w})`),a){let k=p.select("span");k&&k.attr("style",a)}let v=M.node().getBBox();return t.offsetX=0,t.width=v.width,t.height=v.height,t.offsetY=y.height-t.padding/2,t.intersect=function(k){return $t(t,k)},{cluster:g,labelBBox:y}},"kanbanSection"),Ma=$((o,t)=>{let i=Z(),{themeVariables:e,handDrawnSeed:s}=i,{nodeBorder:r}=e,h=o.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-look",t.look),a=h.insert("g",":first-child"),c=0*t.padding,n=t.width+c;t.diff=-t.padding;let l=t.height+c,g=t.x-n/2,f=t.y-l/2;t.width=n;let p;if(t.look==="handDrawn"){let d=S.svg(h).rectangle(g,f,n,l,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:r,seed:s});p=h.insert(()=>d,":first-child")}else p=a.insert("rect",":first-child"),p.attr("class","divider").attr("x",g).attr("y",f).attr("width",n).attr("height",l).attr("data-look",t.look);let u=p.node().getBBox();return t.height=u.height,t.offsetX=0,t.offsetY=0,t.intersect=function(y){return $t(t,y)},{cluster:h,labelBBox:{}}},"divider"),ka=Fs,va={rect:Fs,squareRect:ka,roundedWithTitle:Sa,noteGroup:wa,divider:Ma,kanbanSection:$a},Xs=new Map,ar=$(async(o,t)=>{let i=t.shape||"rect",e=await va[i](o,t);return Xs.set(t.id,e),e},"insertCluster"),rr=$(()=>{Xs=new Map},"clear");function Ys(o,t){return o.intersect(t)}$(Ys,"intersectNode");var Da=Ys;function Vs(o,t,i,e){var s=o.x,r=o.y,h=s-e.x,a=r-e.y,c=Math.sqrt(t*t*a*a+i*i*h*h),n=Math.abs(t*i*h/c);e.x<s&&(n=-n);var l=Math.abs(t*i*a/c);return e.y<r&&(l=-l),{x:s+n,y:r+l}}$(Vs,"intersectEllipse");var Zs=Vs;function Qs(o,t,i){return Zs(o,t,t,i)}$(Qs,"intersectCircle");var Pa=Qs;function Js(o,t,i,e){{let s=t.y-o.y,r=o.x-t.x,h=t.x*o.y-o.x*t.y,a=s*i.x+r*i.y+h,c=s*e.x+r*e.y+h,n=1e-6;if(a!==0&&c!==0&&ms(a,c))return;let l=e.y-i.y,g=i.x-e.x,f=e.x*i.y-i.x*e.y,p=l*o.x+g*o.y+f,u=l*t.x+g*t.y+f;if(Math.abs(p)<n&&Math.abs(u)<n&&ms(p,u))return;let y=s*g-l*r;if(y===0)return;let d=Math.abs(y/2),m=r*f-g*h,x=m<0?(m-d)/y:(m+d)/y;m=l*h-s*f;let b=m<0?(m-d)/y:(m+d)/y;return{x,y:b}}}$(Js,"intersectLine");function ms(o,t){return o*t>0}$(ms,"sameSign");var Ba=Js;function Ks(o,t,i){let e=o.x,s=o.y,r=[],h=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY;typeof t.forEach=="function"?t.forEach(function(l){h=Math.min(h,l.x),a=Math.min(a,l.y)}):(h=Math.min(h,t.x),a=Math.min(a,t.y));let c=e-o.width/2-h,n=s-o.height/2-a;for(let l=0;l<t.length;l++){let g=t[l],f=t[l<t.length-1?l+1:0],p=Ba(o,i,{x:c+g.x,y:n+g.y},{x:c+f.x,y:n+f.y});p&&r.push(p)}return r.length?(r.length>1&&r.sort(function(l,g){let f=l.x-i.x,p=l.y-i.y,u=Math.sqrt(f*f+p*p),y=g.x-i.x,d=g.y-i.y,m=Math.sqrt(y*y+d*d);return u<m?-1:u===m?0:1}),r[0]):o}$(Ks,"intersectPolygon");var Ca=Ks,A={node:Da,circle:Pa,ellipse:Zs,polygon:Ca,rect:$t};function Us(o,t){let{labelStyles:i}=H(t);t.labelStyle=i;let e=z(t),s=e;e||(s="anchor");let r=o.insert("g").attr("class",s).attr("id",t.domId||t.id),h=1,{cssStyles:a}=t,c=S.svg(r),n=W(t,{fill:"black",stroke:"none",fillStyle:"solid"});t.look!=="handDrawn"&&(n.roughness=0);let l=c.circle(0,0,h*2,n),g=r.insert(()=>l,":first-child");return g.attr("class","anchor").attr("style",U(a)),I(t,g),t.intersect=function(f){return F.info("Circle intersect",t,h,f),A.circle(t,h,f)},r}$(Us,"anchor");function ds(o,t,i,e,s,r,h){let c=(o+i)/2,n=(t+e)/2,l=Math.atan2(e-t,i-o),g=(i-o)/2,f=(e-t)/2,p=g/s,u=f/r,y=Math.sqrt(p**2+u**2);if(y>1)throw new Error("The given radii are too small to create an arc between the points.");let d=Math.sqrt(1-y**2),m=c+d*r*Math.sin(l)*(h?-1:1),x=n-d*s*Math.cos(l)*(h?-1:1),b=Math.atan2((t-x)/r,(o-m)/s),w=Math.atan2((e-x)/r,(i-m)/s)-b;h&&w<0&&(w+=2*Math.PI),!h&&w>0&&(w-=2*Math.PI);let v=[];for(let k=0;k<20;k++){let D=k/19,R=b+D*w,L=m+s*Math.cos(R),C=x+r*Math.sin(R);v.push({x:L,y:C})}return v}$(ds,"generateArcPoints");async function te(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r}=await G(o,t,z(t)),h=r.width+t.padding+20,a=r.height+t.padding,c=a/2,n=c/(2.5+a/50),{cssStyles:l}=t,g=[{x:h/2,y:-a/2},{x:-h/2,y:-a/2},...ds(-h/2,-a/2,-h/2,a/2,n,c,!1),{x:h/2,y:a/2},...ds(h/2,a/2,h/2,-a/2,n,c,!0)],f=S.svg(s),p=W(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=q(g),y=f.path(u,p),d=s.insert(()=>y,":first-child");return d.attr("class","basic label-container"),l&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",l),e&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",e),d.attr("transform",`translate(${n/2}, 0)`),I(t,d),t.intersect=function(m){return A.polygon(t,g,m)},s}$(te,"bowTieRect");function ut(o,t,i,e){return o.insert("polygon",":first-child").attr("points",e.map(function(s){return s.x+","+s.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-t/2+","+i/2+")")}$(ut,"insertPolygonShape");async function se(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r}=await G(o,t,z(t)),h=r.height+t.padding,a=12,c=r.width+t.padding+a,n=0,l=c,g=-h,f=0,p=[{x:n+a,y:g},{x:l,y:g},{x:l,y:f},{x:n,y:f},{x:n,y:g+a},{x:n+a,y:g}],u,{cssStyles:y}=t;if(t.look==="handDrawn"){let d=S.svg(s),m=W(t,{}),x=q(p),b=d.path(x,m);u=s.insert(()=>b,":first-child").attr("transform",`translate(${-c/2}, ${h/2})`),y&&u.attr("style",y)}else u=ut(s,c,h,p);return e&&u.attr("style",e),I(t,u),t.intersect=function(d){return A.polygon(t,p,d)},s}$(se,"card");function ee(o,t){let{nodeStyles:i}=H(t);t.label="";let e=o.insert("g").attr("class",z(t)).attr("id",t.domId??t.id),{cssStyles:s}=t,r=Math.max(28,t.width??0),h=[{x:0,y:r/2},{x:r/2,y:0},{x:0,y:-r/2},{x:-r/2,y:0}],a=S.svg(e),c=W(t,{});t.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");let n=q(h),l=a.path(n,c),g=e.insert(()=>l,":first-child");return s&&t.look!=="handDrawn"&&g.selectAll("path").attr("style",s),i&&t.look!=="handDrawn"&&g.selectAll("path").attr("style",i),t.width=28,t.height=28,t.intersect=function(f){return A.polygon(t,h,f)},e}$(ee,"choice");async function xs(o,t,i){let{labelStyles:e,nodeStyles:s}=H(t);t.labelStyle=e;let{shapeSvg:r,bbox:h,halfPadding:a}=await G(o,t,z(t)),c=(i==null?void 0:i.padding)??a,n=h.width/2+c,l,{cssStyles:g}=t;if(t.look==="handDrawn"){let f=S.svg(r),p=W(t,{}),u=f.circle(0,0,n*2,p);l=r.insert(()=>u,":first-child"),l.attr("class","basic label-container").attr("style",U(g))}else l=r.insert("circle",":first-child").attr("class","basic label-container").attr("style",s).attr("r",n).attr("cx",0).attr("cy",0);return I(t,l),t.calcIntersect=function(f,p){let u=f.width/2;return A.circle(f,u,p)},t.intersect=function(f){return F.info("Circle intersect",t,n,f),A.circle(t,n,f)},r}$(xs,"circle");function ae(o){let t=Math.cos(Math.PI/4),i=Math.sin(Math.PI/4),e=o*2,s={x:e/2*t,y:e/2*i},r={x:-(e/2)*t,y:e/2*i},h={x:-(e/2)*t,y:-(e/2)*i},a={x:e/2*t,y:-(e/2)*i};return`M ${r.x},${r.y} L ${a.x},${a.y}
                   M ${s.x},${s.y} L ${h.x},${h.y}`}$(ae,"createLine");function re(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i,t.label="";let s=o.insert("g").attr("class",z(t)).attr("id",t.domId??t.id),r=Math.max(30,(t==null?void 0:t.width)??0),{cssStyles:h}=t,a=S.svg(s),c=W(t,{});t.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");let n=a.circle(0,0,r*2,c),l=ae(r),g=a.path(l,c),f=s.insert(()=>n,":first-child");return f.insert(()=>g),h&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",h),e&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",e),I(t,f),t.intersect=function(p){return F.info("crossedCircle intersect",t,{radius:r,point:p}),A.circle(t,r,p)},s}$(re,"crossedCircle");function lt(o,t,i,e=100,s=0,r=180){let h=[],a=s*Math.PI/180,l=(r*Math.PI/180-a)/(e-1);for(let g=0;g<e;g++){let f=a+g*l,p=o+i*Math.cos(f),u=t+i*Math.sin(f);h.push({x:-p,y:-u})}return h}$(lt,"generateCirclePoints");async function ie(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,label:h}=await G(o,t,z(t)),a=r.width+(t.padding??0),c=r.height+(t.padding??0),n=Math.max(5,c*.1),{cssStyles:l}=t,g=[...lt(a/2,-c/2,n,30,-90,0),{x:-a/2-n,y:n},...lt(a/2+n*2,-n,n,20,-180,-270),...lt(a/2+n*2,n,n,20,-90,-180),{x:-a/2-n,y:-c/2},...lt(a/2,c/2,n,20,0,90)],f=[{x:a/2,y:-c/2-n},{x:-a/2,y:-c/2-n},...lt(a/2,-c/2,n,20,-90,0),{x:-a/2-n,y:-n},...lt(a/2+a*.1,-n,n,20,-180,-270),...lt(a/2+a*.1,n,n,20,-90,-180),{x:-a/2-n,y:c/2},...lt(a/2,c/2,n,20,0,90),{x:-a/2,y:c/2+n},{x:a/2,y:c/2+n}],p=S.svg(s),u=W(t,{fill:"none"});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let d=q(g).replace("Z",""),m=p.path(d,u),x=q(f),b=p.path(x,{...u}),M=s.insert("g",":first-child");return M.insert(()=>b,":first-child").attr("stroke-opacity",0),M.insert(()=>m,":first-child"),M.attr("class","text"),l&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",l),e&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",e),M.attr("transform",`translate(${n}, 0)`),h.attr("transform",`translate(${-a/2+n-(r.x-(r.left??0))},${-c/2+(t.padding??0)/2-(r.y-(r.top??0))})`),I(t,M),t.intersect=function(w){return A.polygon(t,f,w)},s}$(ie,"curlyBraceLeft");function ct(o,t,i,e=100,s=0,r=180){let h=[],a=s*Math.PI/180,l=(r*Math.PI/180-a)/(e-1);for(let g=0;g<e;g++){let f=a+g*l,p=o+i*Math.cos(f),u=t+i*Math.sin(f);h.push({x:p,y:u})}return h}$(ct,"generateCirclePoints");async function ne(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,label:h}=await G(o,t,z(t)),a=r.width+(t.padding??0),c=r.height+(t.padding??0),n=Math.max(5,c*.1),{cssStyles:l}=t,g=[...ct(a/2,-c/2,n,20,-90,0),{x:a/2+n,y:-n},...ct(a/2+n*2,-n,n,20,-180,-270),...ct(a/2+n*2,n,n,20,-90,-180),{x:a/2+n,y:c/2},...ct(a/2,c/2,n,20,0,90)],f=[{x:-a/2,y:-c/2-n},{x:a/2,y:-c/2-n},...ct(a/2,-c/2,n,20,-90,0),{x:a/2+n,y:-n},...ct(a/2+n*2,-n,n,20,-180,-270),...ct(a/2+n*2,n,n,20,-90,-180),{x:a/2+n,y:c/2},...ct(a/2,c/2,n,20,0,90),{x:a/2,y:c/2+n},{x:-a/2,y:c/2+n}],p=S.svg(s),u=W(t,{fill:"none"});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let d=q(g).replace("Z",""),m=p.path(d,u),x=q(f),b=p.path(x,{...u}),M=s.insert("g",":first-child");return M.insert(()=>b,":first-child").attr("stroke-opacity",0),M.insert(()=>m,":first-child"),M.attr("class","text"),l&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",l),e&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",e),M.attr("transform",`translate(${-n}, 0)`),h.attr("transform",`translate(${-a/2+(t.padding??0)/2-(r.x-(r.left??0))},${-c/2+(t.padding??0)/2-(r.y-(r.top??0))})`),I(t,M),t.intersect=function(w){return A.polygon(t,f,w)},s}$(ne,"curlyBraceRight");function K(o,t,i,e=100,s=0,r=180){let h=[],a=s*Math.PI/180,l=(r*Math.PI/180-a)/(e-1);for(let g=0;g<e;g++){let f=a+g*l,p=o+i*Math.cos(f),u=t+i*Math.sin(f);h.push({x:-p,y:-u})}return h}$(K,"generateCirclePoints");async function le(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,label:h}=await G(o,t,z(t)),a=r.width+(t.padding??0),c=r.height+(t.padding??0),n=Math.max(5,c*.1),{cssStyles:l}=t,g=[...K(a/2,-c/2,n,30,-90,0),{x:-a/2-n,y:n},...K(a/2+n*2,-n,n,20,-180,-270),...K(a/2+n*2,n,n,20,-90,-180),{x:-a/2-n,y:-c/2},...K(a/2,c/2,n,20,0,90)],f=[...K(-a/2+n+n/2,-c/2,n,20,-90,-180),{x:a/2-n/2,y:n},...K(-a/2-n/2,-n,n,20,0,90),...K(-a/2-n/2,n,n,20,-90,0),{x:a/2-n/2,y:-n},...K(-a/2+n+n/2,c/2,n,30,-180,-270)],p=[{x:a/2,y:-c/2-n},{x:-a/2,y:-c/2-n},...K(a/2,-c/2,n,20,-90,0),{x:-a/2-n,y:-n},...K(a/2+n*2,-n,n,20,-180,-270),...K(a/2+n*2,n,n,20,-90,-180),{x:-a/2-n,y:c/2},...K(a/2,c/2,n,20,0,90),{x:-a/2,y:c/2+n},{x:a/2-n-n/2,y:c/2+n},...K(-a/2+n+n/2,-c/2,n,20,-90,-180),{x:a/2-n/2,y:n},...K(-a/2-n/2,-n,n,20,0,90),...K(-a/2-n/2,n,n,20,-90,0),{x:a/2-n/2,y:-n},...K(-a/2+n+n/2,c/2,n,30,-180,-270)],u=S.svg(s),y=W(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let m=q(g).replace("Z",""),x=u.path(m,y),M=q(f).replace("Z",""),w=u.path(M,y),v=q(p),k=u.path(v,{...y}),D=s.insert("g",":first-child");return D.insert(()=>k,":first-child").attr("stroke-opacity",0),D.insert(()=>x,":first-child"),D.insert(()=>w,":first-child"),D.attr("class","text"),l&&t.look!=="handDrawn"&&D.selectAll("path").attr("style",l),e&&t.look!=="handDrawn"&&D.selectAll("path").attr("style",e),D.attr("transform",`translate(${n-n/4}, 0)`),h.attr("transform",`translate(${-a/2+(t.padding??0)/2-(r.x-(r.left??0))},${-c/2+(t.padding??0)/2-(r.y-(r.top??0))})`),I(t,D),t.intersect=function(R){return A.polygon(t,p,R)},s}$(le,"curlyBraces");async function ce(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r}=await G(o,t,z(t)),h=80,a=20,c=Math.max(h,(r.width+(t.padding??0)*2)*1.25,(t==null?void 0:t.width)??0),n=Math.max(a,r.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),l=n/2,{cssStyles:g}=t,f=S.svg(s),p=W(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=c,y=n,d=u-l,m=y/4,x=[{x:d,y:0},{x:m,y:0},{x:0,y:y/2},{x:m,y},{x:d,y},...At(-d,-y/2,l,50,270,90)],b=q(x),M=f.path(b,p),w=s.insert(()=>M,":first-child");return w.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&w.selectChildren("path").attr("style",g),e&&t.look!=="handDrawn"&&w.selectChildren("path").attr("style",e),w.attr("transform",`translate(${-c/2}, ${-n/2})`),I(t,w),t.intersect=function(v){return A.polygon(t,x,v)},s}$(ce,"curvedTrapezoid");var Ra=$((o,t,i,e,s,r)=>[`M${o},${t+r}`,`a${s},${r} 0,0,0 ${i},0`,`a${s},${r} 0,0,0 ${-i},0`,`l0,${e}`,`a${s},${r} 0,0,0 ${i},0`,`l0,${-e}`].join(" "),"createCylinderPathD"),Na=$((o,t,i,e,s,r)=>[`M${o},${t+r}`,`M${o+i},${t+r}`,`a${s},${r} 0,0,0 ${-i},0`,`l0,${e}`,`a${s},${r} 0,0,0 ${i},0`,`l0,${-e}`].join(" "),"createOuterCylinderPathD"),Aa=$((o,t,i,e,s,r)=>[`M${o-i/2},${-e/2}`,`a${s},${r} 0,0,0 ${i},0`].join(" "),"createInnerCylinderPathD");async function oe(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,label:h}=await G(o,t,z(t)),a=Math.max(r.width+t.padding,t.width??0),c=a/2,n=c/(2.5+a/50),l=Math.max(r.height+n+t.padding,t.height??0),g,{cssStyles:f}=t;if(t.look==="handDrawn"){let p=S.svg(s),u=Na(0,0,a,l,c,n),y=Aa(0,n,a,l,c,n),d=p.path(u,W(t,{})),m=p.path(y,W(t,{fill:"none"}));g=s.insert(()=>m,":first-child"),g=s.insert(()=>d,":first-child"),g.attr("class","basic label-container"),f&&g.attr("style",f)}else{let p=Ra(0,0,a,l,c,n);g=s.insert("path",":first-child").attr("d",p).attr("class","basic label-container").attr("style",U(f)).attr("style",e)}return g.attr("label-offset-y",n),g.attr("transform",`translate(${-a/2}, ${-(l/2+n)})`),I(t,g),h.attr("transform",`translate(${-(r.width/2)-(r.x-(r.left??0))}, ${-(r.height/2)+(t.padding??0)/1.5-(r.y-(r.top??0))})`),t.intersect=function(p){let u=A.rect(t,p),y=u.x-(t.x??0);if(c!=0&&(Math.abs(y)<(t.width??0)/2||Math.abs(y)==(t.width??0)/2&&Math.abs(u.y-(t.y??0))>(t.height??0)/2-n)){let d=n*n*(1-y*y/(c*c));d>0&&(d=Math.sqrt(d)),d=n-d,p.y-(t.y??0)>0&&(d=-d),u.y+=d}return u},s}$(oe,"cylinder");async function he(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,label:h}=await G(o,t,z(t)),a=r.width+t.padding,c=r.height+t.padding,n=c*.2,l=-a/2,g=-c/2-n/2,{cssStyles:f}=t,p=S.svg(s),u=W(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=[{x:l,y:g+n},{x:-l,y:g+n},{x:-l,y:-g},{x:l,y:-g},{x:l,y:g},{x:-l,y:g},{x:-l,y:g+n}],d=p.polygon(y.map(x=>[x.x,x.y]),u),m=s.insert(()=>d,":first-child");return m.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",f),e&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",e),h.attr("transform",`translate(${l+(t.padding??0)/2-(r.x-(r.left??0))}, ${g+n+(t.padding??0)/2-(r.y-(r.top??0))})`),I(t,m),t.intersect=function(x){return A.rect(t,x)},s}$(he,"dividedRectangle");async function ge(o,t){var f,p;let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,halfPadding:h}=await G(o,t,z(t)),c=r.width/2+h+5,n=r.width/2+h,l,{cssStyles:g}=t;if(t.look==="handDrawn"){let u=S.svg(s),y=W(t,{roughness:.2,strokeWidth:2.5}),d=W(t,{roughness:.2,strokeWidth:1.5}),m=u.circle(0,0,c*2,y),x=u.circle(0,0,n*2,d);l=s.insert("g",":first-child"),l.attr("class",U(t.cssClasses)).attr("style",U(g)),(f=l.node())==null||f.appendChild(m),(p=l.node())==null||p.appendChild(x)}else{l=s.insert("g",":first-child");let u=l.insert("circle",":first-child"),y=l.insert("circle");l.attr("class","basic label-container").attr("style",e),u.attr("class","outer-circle").attr("style",e).attr("r",c).attr("cx",0).attr("cy",0),y.attr("class","inner-circle").attr("style",e).attr("r",n).attr("cx",0).attr("cy",0)}return I(t,l),t.intersect=function(u){return F.info("DoubleCircle intersect",t,c,u),A.circle(t,c,u)},s}$(ge,"doublecircle");function pe(o,t,{config:{themeVariables:i}}){let{labelStyles:e,nodeStyles:s}=H(t);t.label="",t.labelStyle=e;let r=o.insert("g").attr("class",z(t)).attr("id",t.domId??t.id),h=7,{cssStyles:a}=t,c=S.svg(r),{nodeBorder:n}=i,l=W(t,{fillStyle:"solid"});t.look!=="handDrawn"&&(l.roughness=0);let g=c.circle(0,0,h*2,l),f=r.insert(()=>g,":first-child");return f.selectAll("path").attr("style",`fill: ${n} !important;`),a&&a.length>0&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",a),s&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",s),I(t,f),t.intersect=function(p){return F.info("filledCircle intersect",t,{radius:h,point:p}),A.circle(t,h,p)},r}$(pe,"filledCircle");async function fe(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,label:h}=await G(o,t,z(t)),a=r.width+(t.padding??0),c=a+r.height,n=a+r.height,l=[{x:0,y:-c},{x:n,y:-c},{x:n/2,y:0}],{cssStyles:g}=t,f=S.svg(s),p=W(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=q(l),y=f.path(u,p),d=s.insert(()=>y,":first-child").attr("transform",`translate(${-c/2}, ${c/2})`);return g&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",g),e&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",e),t.width=a,t.height=c,I(t,d),h.attr("transform",`translate(${-r.width/2-(r.x-(r.left??0))}, ${-c/2+(t.padding??0)/2+(r.y-(r.top??0))})`),t.intersect=function(m){return F.info("Triangle intersect",t,l,m),A.polygon(t,l,m)},s}$(fe,"flippedTriangle");function ue(o,t,{dir:i,config:{state:e,themeVariables:s}}){let{nodeStyles:r}=H(t);t.label="";let h=o.insert("g").attr("class",z(t)).attr("id",t.domId??t.id),{cssStyles:a}=t,c=Math.max(70,(t==null?void 0:t.width)??0),n=Math.max(10,(t==null?void 0:t.height)??0);i==="LR"&&(c=Math.max(10,(t==null?void 0:t.width)??0),n=Math.max(70,(t==null?void 0:t.height)??0));let l=-1*c/2,g=-1*n/2,f=S.svg(h),p=W(t,{stroke:s.lineColor,fill:s.lineColor});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=f.rectangle(l,g,c,n,p),y=h.insert(()=>u,":first-child");a&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",a),r&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",r),I(t,y);let d=(e==null?void 0:e.padding)??0;return t.width&&t.height&&(t.width+=d/2||0,t.height+=d/2||0),t.intersect=function(m){return A.rect(t,m)},h}$(ue,"forkJoin");async function ye(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let s=80,r=50,{shapeSvg:h,bbox:a}=await G(o,t,z(t)),c=Math.max(s,a.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),n=Math.max(r,a.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),l=n/2,{cssStyles:g}=t,f=S.svg(h),p=W(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=[{x:-c/2,y:-n/2},{x:c/2-l,y:-n/2},...At(-c/2+l,0,l,50,90,270),{x:c/2-l,y:n/2},{x:-c/2,y:n/2}],y=q(u),d=f.path(y,p),m=h.insert(()=>d,":first-child");return m.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",g),e&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",e),I(t,m),t.intersect=function(x){return F.info("Pill intersect",t,{radius:l,point:x}),A.polygon(t,u,x)},h}$(ye,"halfRoundedRectangle");async function me(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r}=await G(o,t,z(t)),h=r.height+(t.padding??0),a=r.width+(t.padding??0)*2.5,{cssStyles:c}=t,n=S.svg(s),l=W(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");let g=a/2,f=g/6;g=g+f;let p=h/2,u=p/2,y=g-u,d=[{x:-y,y:-p},{x:0,y:-p},{x:y,y:-p},{x:g,y:0},{x:y,y:p},{x:0,y:p},{x:-y,y:p},{x:-g,y:0}],m=q(d),x=n.path(m,l),b=s.insert(()=>x,":first-child");return b.attr("class","basic label-container"),c&&t.look!=="handDrawn"&&b.selectChildren("path").attr("style",c),e&&t.look!=="handDrawn"&&b.selectChildren("path").attr("style",e),t.width=a,t.height=h,I(t,b),t.intersect=function(M){return A.polygon(t,d,M)},s}$(me,"hexagon");async function de(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.label="",t.labelStyle=i;let{shapeSvg:s}=await G(o,t,z(t)),r=Math.max(30,(t==null?void 0:t.width)??0),h=Math.max(30,(t==null?void 0:t.height)??0),{cssStyles:a}=t,c=S.svg(s),n=W(t,{});t.look!=="handDrawn"&&(n.roughness=0,n.fillStyle="solid");let l=[{x:0,y:0},{x:r,y:0},{x:0,y:h},{x:r,y:h}],g=q(l),f=c.path(g,n),p=s.insert(()=>f,":first-child");return p.attr("class","basic label-container"),a&&t.look!=="handDrawn"&&p.selectChildren("path").attr("style",a),e&&t.look!=="handDrawn"&&p.selectChildren("path").attr("style",e),p.attr("transform",`translate(${-r/2}, ${-h/2})`),I(t,p),t.intersect=function(u){return F.info("Pill intersect",t,{points:l}),A.polygon(t,l,u)},s}$(de,"hourglass");async function xe(o,t,{config:{themeVariables:i,flowchart:e}}){let{labelStyles:s}=H(t);t.labelStyle=s;let r=t.assetHeight??48,h=t.assetWidth??48,a=Math.max(r,h),c=e==null?void 0:e.wrappingWidth;t.width=Math.max(a,c??0);let{shapeSvg:n,bbox:l,label:g}=await G(o,t,"icon-shape default"),f=t.pos==="t",p=a,u=a,{nodeBorder:y}=i,{stylesMap:d}=Mt(t),m=-u/2,x=-p/2,b=t.label?8:0,M=S.svg(n),w=W(t,{stroke:"none",fill:"none"});t.look!=="handDrawn"&&(w.roughness=0,w.fillStyle="solid");let v=M.rectangle(m,x,u,p,w),k=Math.max(u,l.width),D=p+l.height+b,R=M.rectangle(-k/2,-D/2,k,D,{...w,fill:"transparent",stroke:"none"}),L=n.insert(()=>v,":first-child"),C=n.insert(()=>R);if(t.icon){let E=n.append("g");E.html(`<g>${await vt(t.icon,{height:a,width:a,fallbackPrefix:""})}</g>`);let P=E.node().getBBox(),B=P.width,T=P.height,N=P.x,O=P.y;E.attr("transform",`translate(${-B/2-N},${f?l.height/2+b/2-T/2-O:-l.height/2-b/2-T/2-O})`),E.attr("style",`color: ${d.get("stroke")??y};`)}return g.attr("transform",`translate(${-l.width/2-(l.x-(l.left??0))},${f?-D/2:D/2-l.height})`),L.attr("transform",`translate(0,${f?l.height/2+b/2:-l.height/2-b/2})`),I(t,C),t.intersect=function(E){if(F.info("iconSquare intersect",t,E),!t.label)return A.rect(t,E);let P=t.x??0,B=t.y??0,T=t.height??0,N=[];return f?N=[{x:P-l.width/2,y:B-T/2},{x:P+l.width/2,y:B-T/2},{x:P+l.width/2,y:B-T/2+l.height+b},{x:P+u/2,y:B-T/2+l.height+b},{x:P+u/2,y:B+T/2},{x:P-u/2,y:B+T/2},{x:P-u/2,y:B-T/2+l.height+b},{x:P-l.width/2,y:B-T/2+l.height+b}]:N=[{x:P-u/2,y:B-T/2},{x:P+u/2,y:B-T/2},{x:P+u/2,y:B-T/2+p},{x:P+l.width/2,y:B-T/2+p},{x:P+l.width/2/2,y:B+T/2},{x:P-l.width/2,y:B+T/2},{x:P-l.width/2,y:B-T/2+p},{x:P-u/2,y:B-T/2+p}],A.polygon(t,N,E)},n}$(xe,"icon");async function be(o,t,{config:{themeVariables:i,flowchart:e}}){let{labelStyles:s}=H(t);t.labelStyle=s;let r=t.assetHeight??48,h=t.assetWidth??48,a=Math.max(r,h),c=e==null?void 0:e.wrappingWidth;t.width=Math.max(a,c??0);let{shapeSvg:n,bbox:l,label:g}=await G(o,t,"icon-shape default"),f=20,p=t.label?8:0,u=t.pos==="t",{nodeBorder:y,mainBkg:d}=i,{stylesMap:m}=Mt(t),x=S.svg(n),b=W(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");let M=m.get("fill");b.stroke=M??d;let w=n.append("g");t.icon&&w.html(`<g>${await vt(t.icon,{height:a,width:a,fallbackPrefix:""})}</g>`);let v=w.node().getBBox(),k=v.width,D=v.height,R=v.x,L=v.y,C=Math.max(k,D)*Math.SQRT2+f*2,E=x.circle(0,0,C,b),P=Math.max(C,l.width),B=C+l.height+p,T=x.rectangle(-P/2,-B/2,P,B,{...b,fill:"transparent",stroke:"none"}),N=n.insert(()=>E,":first-child"),O=n.insert(()=>T);return w.attr("transform",`translate(${-k/2-R},${u?l.height/2+p/2-D/2-L:-l.height/2-p/2-D/2-L})`),w.attr("style",`color: ${m.get("stroke")??y};`),g.attr("transform",`translate(${-l.width/2-(l.x-(l.left??0))},${u?-B/2:B/2-l.height})`),N.attr("transform",`translate(0,${u?l.height/2+p/2:-l.height/2-p/2})`),I(t,O),t.intersect=function(_){return F.info("iconSquare intersect",t,_),A.rect(t,_)},n}$(be,"iconCircle");async function we(o,t,{config:{themeVariables:i,flowchart:e}}){let{labelStyles:s}=H(t);t.labelStyle=s;let r=t.assetHeight??48,h=t.assetWidth??48,a=Math.max(r,h),c=e==null?void 0:e.wrappingWidth;t.width=Math.max(a,c??0);let{shapeSvg:n,bbox:l,halfPadding:g,label:f}=await G(o,t,"icon-shape default"),p=t.pos==="t",u=a+g*2,y=a+g*2,{nodeBorder:d,mainBkg:m}=i,{stylesMap:x}=Mt(t),b=-y/2,M=-u/2,w=t.label?8:0,v=S.svg(n),k=W(t,{});t.look!=="handDrawn"&&(k.roughness=0,k.fillStyle="solid");let D=x.get("fill");k.stroke=D??m;let R=v.path(ft(b,M,y,u,5),k),L=Math.max(y,l.width),C=u+l.height+w,E=v.rectangle(-L/2,-C/2,L,C,{...k,fill:"transparent",stroke:"none"}),P=n.insert(()=>R,":first-child").attr("class","icon-shape2"),B=n.insert(()=>E);if(t.icon){let T=n.append("g");T.html(`<g>${await vt(t.icon,{height:a,width:a,fallbackPrefix:""})}</g>`);let N=T.node().getBBox(),O=N.width,_=N.height,Q=N.x,tt=N.y;T.attr("transform",`translate(${-O/2-Q},${p?l.height/2+w/2-_/2-tt:-l.height/2-w/2-_/2-tt})`),T.attr("style",`color: ${x.get("stroke")??d};`)}return f.attr("transform",`translate(${-l.width/2-(l.x-(l.left??0))},${p?-C/2:C/2-l.height})`),P.attr("transform",`translate(0,${p?l.height/2+w/2:-l.height/2-w/2})`),I(t,B),t.intersect=function(T){if(F.info("iconSquare intersect",t,T),!t.label)return A.rect(t,T);let N=t.x??0,O=t.y??0,_=t.height??0,Q=[];return p?Q=[{x:N-l.width/2,y:O-_/2},{x:N+l.width/2,y:O-_/2},{x:N+l.width/2,y:O-_/2+l.height+w},{x:N+y/2,y:O-_/2+l.height+w},{x:N+y/2,y:O+_/2},{x:N-y/2,y:O+_/2},{x:N-y/2,y:O-_/2+l.height+w},{x:N-l.width/2,y:O-_/2+l.height+w}]:Q=[{x:N-y/2,y:O-_/2},{x:N+y/2,y:O-_/2},{x:N+y/2,y:O-_/2+u},{x:N+l.width/2,y:O-_/2+u},{x:N+l.width/2/2,y:O+_/2},{x:N-l.width/2,y:O+_/2},{x:N-l.width/2,y:O-_/2+u},{x:N-y/2,y:O-_/2+u}],A.polygon(t,Q,T)},n}$(we,"iconRounded");async function Se(o,t,{config:{themeVariables:i,flowchart:e}}){let{labelStyles:s}=H(t);t.labelStyle=s;let r=t.assetHeight??48,h=t.assetWidth??48,a=Math.max(r,h),c=e==null?void 0:e.wrappingWidth;t.width=Math.max(a,c??0);let{shapeSvg:n,bbox:l,halfPadding:g,label:f}=await G(o,t,"icon-shape default"),p=t.pos==="t",u=a+g*2,y=a+g*2,{nodeBorder:d,mainBkg:m}=i,{stylesMap:x}=Mt(t),b=-y/2,M=-u/2,w=t.label?8:0,v=S.svg(n),k=W(t,{});t.look!=="handDrawn"&&(k.roughness=0,k.fillStyle="solid");let D=x.get("fill");k.stroke=D??m;let R=v.path(ft(b,M,y,u,.1),k),L=Math.max(y,l.width),C=u+l.height+w,E=v.rectangle(-L/2,-C/2,L,C,{...k,fill:"transparent",stroke:"none"}),P=n.insert(()=>R,":first-child"),B=n.insert(()=>E);if(t.icon){let T=n.append("g");T.html(`<g>${await vt(t.icon,{height:a,width:a,fallbackPrefix:""})}</g>`);let N=T.node().getBBox(),O=N.width,_=N.height,Q=N.x,tt=N.y;T.attr("transform",`translate(${-O/2-Q},${p?l.height/2+w/2-_/2-tt:-l.height/2-w/2-_/2-tt})`),T.attr("style",`color: ${x.get("stroke")??d};`)}return f.attr("transform",`translate(${-l.width/2-(l.x-(l.left??0))},${p?-C/2:C/2-l.height})`),P.attr("transform",`translate(0,${p?l.height/2+w/2:-l.height/2-w/2})`),I(t,B),t.intersect=function(T){if(F.info("iconSquare intersect",t,T),!t.label)return A.rect(t,T);let N=t.x??0,O=t.y??0,_=t.height??0,Q=[];return p?Q=[{x:N-l.width/2,y:O-_/2},{x:N+l.width/2,y:O-_/2},{x:N+l.width/2,y:O-_/2+l.height+w},{x:N+y/2,y:O-_/2+l.height+w},{x:N+y/2,y:O+_/2},{x:N-y/2,y:O+_/2},{x:N-y/2,y:O-_/2+l.height+w},{x:N-l.width/2,y:O-_/2+l.height+w}]:Q=[{x:N-y/2,y:O-_/2},{x:N+y/2,y:O-_/2},{x:N+y/2,y:O-_/2+u},{x:N+l.width/2,y:O-_/2+u},{x:N+l.width/2/2,y:O+_/2},{x:N-l.width/2,y:O+_/2},{x:N-l.width/2,y:O-_/2+u},{x:N-y/2,y:O-_/2+u}],A.polygon(t,Q,T)},n}$(Se,"iconSquare");async function $e(o,t,{config:{flowchart:i}}){let e=new Image;e.src=(t==null?void 0:t.img)??"",await e.decode();let s=Number(e.naturalWidth.toString().replace("px","")),r=Number(e.naturalHeight.toString().replace("px",""));t.imageAspectRatio=s/r;let{labelStyles:h}=H(t);t.labelStyle=h;let a=i==null?void 0:i.wrappingWidth;t.defaultWidth=i==null?void 0:i.wrappingWidth;let c=Math.max(t.label?a??0:0,(t==null?void 0:t.assetWidth)??s),n=t.constraint==="on"&&t!=null&&t.assetHeight?t.assetHeight*t.imageAspectRatio:c,l=t.constraint==="on"?n/t.imageAspectRatio:(t==null?void 0:t.assetHeight)??r;t.width=Math.max(n,a??0);let{shapeSvg:g,bbox:f,label:p}=await G(o,t,"image-shape default"),u=t.pos==="t",y=-n/2,d=-l/2,m=t.label?8:0,x=S.svg(g),b=W(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");let M=x.rectangle(y,d,n,l,b),w=Math.max(n,f.width),v=l+f.height+m,k=x.rectangle(-w/2,-v/2,w,v,{...b,fill:"none",stroke:"none"}),D=g.insert(()=>M,":first-child"),R=g.insert(()=>k);if(t.img){let L=g.append("image");L.attr("href",t.img),L.attr("width",n),L.attr("height",l),L.attr("preserveAspectRatio","none"),L.attr("transform",`translate(${-n/2},${u?v/2-l:-v/2})`)}return p.attr("transform",`translate(${-f.width/2-(f.x-(f.left??0))},${u?-l/2-f.height/2-m/2:l/2-f.height/2+m/2})`),D.attr("transform",`translate(0,${u?f.height/2+m/2:-f.height/2-m/2})`),I(t,R),t.intersect=function(L){if(F.info("iconSquare intersect",t,L),!t.label)return A.rect(t,L);let C=t.x??0,E=t.y??0,P=t.height??0,B=[];return u?B=[{x:C-f.width/2,y:E-P/2},{x:C+f.width/2,y:E-P/2},{x:C+f.width/2,y:E-P/2+f.height+m},{x:C+n/2,y:E-P/2+f.height+m},{x:C+n/2,y:E+P/2},{x:C-n/2,y:E+P/2},{x:C-n/2,y:E-P/2+f.height+m},{x:C-f.width/2,y:E-P/2+f.height+m}]:B=[{x:C-n/2,y:E-P/2},{x:C+n/2,y:E-P/2},{x:C+n/2,y:E-P/2+l},{x:C+f.width/2,y:E-P/2+l},{x:C+f.width/2/2,y:E+P/2},{x:C-f.width/2,y:E+P/2},{x:C-f.width/2,y:E-P/2+l},{x:C-n/2,y:E-P/2+l}],A.polygon(t,B,L)},g}$($e,"imageSquare");async function Me(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r}=await G(o,t,z(t)),h=Math.max(r.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),a=Math.max(r.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=[{x:0,y:0},{x:h,y:0},{x:h+3*a/6,y:-a},{x:-3*a/6,y:-a}],n,{cssStyles:l}=t;if(t.look==="handDrawn"){let g=S.svg(s),f=W(t,{}),p=q(c),u=g.path(p,f);n=s.insert(()=>u,":first-child").attr("transform",`translate(${-h/2}, ${a/2})`),l&&n.attr("style",l)}else n=ut(s,h,a,c);return e&&n.attr("style",e),t.width=h,t.height=a,I(t,n),t.intersect=function(g){return A.polygon(t,c,g)},s}$(Me,"inv_trapezoid");async function qt(o,t,i){let{labelStyles:e,nodeStyles:s}=H(t);t.labelStyle=e;let{shapeSvg:r,bbox:h}=await G(o,t,z(t)),a=Math.max(h.width+i.labelPaddingX*2,(t==null?void 0:t.width)||0),c=Math.max(h.height+i.labelPaddingY*2,(t==null?void 0:t.height)||0),n=-a/2,l=-c/2,g,{rx:f,ry:p}=t,{cssStyles:u}=t;if(i!=null&&i.rx&&i.ry&&(f=i.rx,p=i.ry),t.look==="handDrawn"){let y=S.svg(r),d=W(t,{}),m=f||p?y.path(ft(n,l,a,c,f||0),d):y.rectangle(n,l,a,c,d);g=r.insert(()=>m,":first-child"),g.attr("class","basic label-container").attr("style",U(u))}else g=r.insert("rect",":first-child"),g.attr("class","basic label-container").attr("style",s).attr("rx",U(f)).attr("ry",U(p)).attr("x",n).attr("y",l).attr("width",a).attr("height",c);return I(t,g),t.calcIntersect=function(y,d){return A.rect(y,d)},t.intersect=function(y){return A.rect(t,y)},r}$(qt,"drawRect");async function ke(o,t){let{shapeSvg:i,bbox:e,label:s}=await G(o,t,"label"),r=i.insert("rect",":first-child");return r.attr("width",.1).attr("height",.1),i.attr("class","label edgeLabel"),s.attr("transform",`translate(${-(e.width/2)-(e.x-(e.left??0))}, ${-(e.height/2)-(e.y-(e.top??0))})`),I(t,r),t.intersect=function(c){return A.rect(t,c)},i}$(ke,"labelRect");async function ve(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r}=await G(o,t,z(t)),h=Math.max(r.width+(t.padding??0),(t==null?void 0:t.width)??0),a=Math.max(r.height+(t.padding??0),(t==null?void 0:t.height)??0),c=[{x:0,y:0},{x:h+3*a/6,y:0},{x:h,y:-a},{x:-(3*a)/6,y:-a}],n,{cssStyles:l}=t;if(t.look==="handDrawn"){let g=S.svg(s),f=W(t,{}),p=q(c),u=g.path(p,f);n=s.insert(()=>u,":first-child").attr("transform",`translate(${-h/2}, ${a/2})`),l&&n.attr("style",l)}else n=ut(s,h,a,c);return e&&n.attr("style",e),t.width=h,t.height=a,I(t,n),t.intersect=function(g){return A.polygon(t,c,g)},s}$(ve,"lean_left");async function De(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r}=await G(o,t,z(t)),h=Math.max(r.width+(t.padding??0),(t==null?void 0:t.width)??0),a=Math.max(r.height+(t.padding??0),(t==null?void 0:t.height)??0),c=[{x:-3*a/6,y:0},{x:h,y:0},{x:h+3*a/6,y:-a},{x:0,y:-a}],n,{cssStyles:l}=t;if(t.look==="handDrawn"){let g=S.svg(s),f=W(t,{}),p=q(c),u=g.path(p,f);n=s.insert(()=>u,":first-child").attr("transform",`translate(${-h/2}, ${a/2})`),l&&n.attr("style",l)}else n=ut(s,h,a,c);return e&&n.attr("style",e),t.width=h,t.height=a,I(t,n),t.intersect=function(g){return A.polygon(t,c,g)},s}$(De,"lean_right");function Pe(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.label="",t.labelStyle=i;let s=o.insert("g").attr("class",z(t)).attr("id",t.domId??t.id),{cssStyles:r}=t,h=Math.max(35,(t==null?void 0:t.width)??0),a=Math.max(35,(t==null?void 0:t.height)??0),c=7,n=[{x:h,y:0},{x:0,y:a+c/2},{x:h-2*c,y:a+c/2},{x:0,y:2*a},{x:h,y:a-c/2},{x:2*c,y:a-c/2}],l=S.svg(s),g=W(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let f=q(n),p=l.path(f,g),u=s.insert(()=>p,":first-child");return r&&t.look!=="handDrawn"&&u.selectAll("path").attr("style",r),e&&t.look!=="handDrawn"&&u.selectAll("path").attr("style",e),u.attr("transform",`translate(-${h/2},${-a})`),I(t,u),t.intersect=function(y){return F.info("lightningBolt intersect",t,y),A.polygon(t,n,y)},s}$(Pe,"lightningBolt");var La=$((o,t,i,e,s,r,h)=>[`M${o},${t+r}`,`a${s},${r} 0,0,0 ${i},0`,`a${s},${r} 0,0,0 ${-i},0`,`l0,${e}`,`a${s},${r} 0,0,0 ${i},0`,`l0,${-e}`,`M${o},${t+r+h}`,`a${s},${r} 0,0,0 ${i},0`].join(" "),"createCylinderPathD"),Wa=$((o,t,i,e,s,r,h)=>[`M${o},${t+r}`,`M${o+i},${t+r}`,`a${s},${r} 0,0,0 ${-i},0`,`l0,${e}`,`a${s},${r} 0,0,0 ${i},0`,`l0,${-e}`,`M${o},${t+r+h}`,`a${s},${r} 0,0,0 ${i},0`].join(" "),"createOuterCylinderPathD"),Ta=$((o,t,i,e,s,r)=>[`M${o-i/2},${-e/2}`,`a${s},${r} 0,0,0 ${i},0`].join(" "),"createInnerCylinderPathD");async function Be(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,label:h}=await G(o,t,z(t)),a=Math.max(r.width+(t.padding??0),t.width??0),c=a/2,n=c/(2.5+a/50),l=Math.max(r.height+n+(t.padding??0),t.height??0),g=l*.1,f,{cssStyles:p}=t;if(t.look==="handDrawn"){let u=S.svg(s),y=Wa(0,0,a,l,c,n,g),d=Ta(0,n,a,l,c,n),m=W(t,{}),x=u.path(y,m),b=u.path(d,m);s.insert(()=>b,":first-child").attr("class","line"),f=s.insert(()=>x,":first-child"),f.attr("class","basic label-container"),p&&f.attr("style",p)}else{let u=La(0,0,a,l,c,n,g);f=s.insert("path",":first-child").attr("d",u).attr("class","basic label-container").attr("style",U(p)).attr("style",e)}return f.attr("label-offset-y",n),f.attr("transform",`translate(${-a/2}, ${-(l/2+n)})`),I(t,f),h.attr("transform",`translate(${-(r.width/2)-(r.x-(r.left??0))}, ${-(r.height/2)+n-(r.y-(r.top??0))})`),t.intersect=function(u){let y=A.rect(t,u),d=y.x-(t.x??0);if(c!=0&&(Math.abs(d)<(t.width??0)/2||Math.abs(d)==(t.width??0)/2&&Math.abs(y.y-(t.y??0))>(t.height??0)/2-n)){let m=n*n*(1-d*d/(c*c));m>0&&(m=Math.sqrt(m)),m=n-m,u.y-(t.y??0)>0&&(m=-m),y.y+=m}return y},s}$(Be,"linedCylinder");async function Ce(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,label:h}=await G(o,t,z(t)),a=Math.max(r.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(r.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),n=c/4,l=c+n,{cssStyles:g}=t,f=S.svg(s),p=W(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=[{x:-a/2-a/2*.1,y:-l/2},{x:-a/2-a/2*.1,y:l/2},...pt(-a/2-a/2*.1,l/2,a/2+a/2*.1,l/2,n,.8),{x:a/2+a/2*.1,y:-l/2},{x:-a/2-a/2*.1,y:-l/2},{x:-a/2,y:-l/2},{x:-a/2,y:l/2*1.1},{x:-a/2,y:-l/2}],y=f.polygon(u.map(m=>[m.x,m.y]),p),d=s.insert(()=>y,":first-child");return d.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",g),e&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",e),d.attr("transform",`translate(0,${-n/2})`),h.attr("transform",`translate(${-a/2+(t.padding??0)+a/2*.1/2-(r.x-(r.left??0))},${-c/2+(t.padding??0)-n/2-(r.y-(r.top??0))})`),I(t,d),t.intersect=function(m){return A.polygon(t,u,m)},s}$(Ce,"linedWaveEdgedRect");async function Re(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,label:h}=await G(o,t,z(t)),a=Math.max(r.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(r.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),n=5,l=-a/2,g=-c/2,{cssStyles:f}=t,p=S.svg(s),u=W(t,{}),y=[{x:l-n,y:g+n},{x:l-n,y:g+c+n},{x:l+a-n,y:g+c+n},{x:l+a-n,y:g+c},{x:l+a,y:g+c},{x:l+a,y:g+c-n},{x:l+a+n,y:g+c-n},{x:l+a+n,y:g-n},{x:l+n,y:g-n},{x:l+n,y:g},{x:l,y:g},{x:l,y:g+n}],d=[{x:l,y:g+n},{x:l+a-n,y:g+n},{x:l+a-n,y:g+c},{x:l+a,y:g+c},{x:l+a,y:g},{x:l,y:g}];t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let m=q(y),x=p.path(m,u),b=q(d),M=p.path(b,{...u,fill:"none"}),w=s.insert(()=>M,":first-child");return w.insert(()=>x,":first-child"),w.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",f),e&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",e),h.attr("transform",`translate(${-(r.width/2)-n-(r.x-(r.left??0))}, ${-(r.height/2)+n-(r.y-(r.top??0))})`),I(t,w),t.intersect=function(v){return A.polygon(t,y,v)},s}$(Re,"multiRect");async function Ne(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,label:h}=await G(o,t,z(t)),a=Math.max(r.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(r.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),n=c/4,l=c+n,g=-a/2,f=-l/2,p=5,{cssStyles:u}=t,y=pt(g-p,f+l+p,g+a-p,f+l+p,n,.8),d=y==null?void 0:y[y.length-1],m=[{x:g-p,y:f+p},{x:g-p,y:f+l+p},...y,{x:g+a-p,y:d.y-p},{x:g+a,y:d.y-p},{x:g+a,y:d.y-2*p},{x:g+a+p,y:d.y-2*p},{x:g+a+p,y:f-p},{x:g+p,y:f-p},{x:g+p,y:f},{x:g,y:f},{x:g,y:f+p}],x=[{x:g,y:f+p},{x:g+a-p,y:f+p},{x:g+a-p,y:d.y-p},{x:g+a,y:d.y-p},{x:g+a,y:f},{x:g,y:f}],b=S.svg(s),M=W(t,{});t.look!=="handDrawn"&&(M.roughness=0,M.fillStyle="solid");let w=q(m),v=b.path(w,M),k=q(x),D=b.path(k,M),R=s.insert(()=>v,":first-child");return R.insert(()=>D),R.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&R.selectAll("path").attr("style",u),e&&t.look!=="handDrawn"&&R.selectAll("path").attr("style",e),R.attr("transform",`translate(0,${-n/2})`),h.attr("transform",`translate(${-(r.width/2)-p-(r.x-(r.left??0))}, ${-(r.height/2)+p-n/2-(r.y-(r.top??0))})`),I(t,R),t.intersect=function(L){return A.polygon(t,m,L)},s}$(Ne,"multiWaveEdgedRectangle");async function Ae(o,t,{config:{themeVariables:i}}){var x;let{labelStyles:e,nodeStyles:s}=H(t);t.labelStyle=e,t.useHtmlLabels||((x=dt().flowchart)==null?void 0:x.htmlLabels)!==!1||(t.centerLabel=!0);let{shapeSvg:h,bbox:a,label:c}=await G(o,t,z(t)),n=Math.max(a.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(a.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),g=-n/2,f=-l/2,{cssStyles:p}=t,u=S.svg(h),y=W(t,{fill:i.noteBkgColor,stroke:i.noteBorderColor});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let d=u.rectangle(g,f,n,l,y),m=h.insert(()=>d,":first-child");return m.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",p),s&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",s),c.attr("transform",`translate(${-a.width/2-(a.x-(a.left??0))}, ${-(a.height/2)-(a.y-(a.top??0))})`),I(t,m),t.intersect=function(b){return A.rect(t,b)},h}$(Ae,"note");var Ha=$((o,t,i)=>[`M${o+i/2},${t}`,`L${o+i},${t-i/2}`,`L${o+i/2},${t-i}`,`L${o},${t-i/2}`,"Z"].join(" "),"createDecisionBoxPathD");async function Le(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r}=await G(o,t,z(t)),h=r.width+t.padding,a=r.height+t.padding,c=h+a,n=.5,l=[{x:c/2,y:0},{x:c,y:-c/2},{x:c/2,y:-c},{x:0,y:-c/2}],g,{cssStyles:f}=t;if(t.look==="handDrawn"){let p=S.svg(s),u=W(t,{}),y=Ha(0,0,c),d=p.path(y,u);g=s.insert(()=>d,":first-child").attr("transform",`translate(${-c/2+n}, ${c/2})`),f&&g.attr("style",f)}else g=ut(s,c,c,l),g.attr("transform",`translate(${-c/2+n}, ${c/2})`);return e&&g.attr("style",e),I(t,g),t.calcIntersect=function(p,u){let y=p.width,d=[{x:y/2,y:0},{x:y,y:-y/2},{x:y/2,y:-y},{x:0,y:-y/2}],m=A.polygon(p,d,u);return{x:m.x-.5,y:m.y-.5}},t.intersect=function(p){return this.calcIntersect(t,p)},s}$(Le,"question");async function We(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,label:h}=await G(o,t,z(t)),a=Math.max(r.width+(t.padding??0),(t==null?void 0:t.width)??0),c=Math.max(r.height+(t.padding??0),(t==null?void 0:t.height)??0),n=-a/2,l=-c/2,g=l/2,f=[{x:n+g,y:l},{x:n,y:0},{x:n+g,y:-l},{x:-n,y:-l},{x:-n,y:l}],{cssStyles:p}=t,u=S.svg(s),y=W(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let d=q(f),m=u.path(d,y),x=s.insert(()=>m,":first-child");return x.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",p),e&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",e),x.attr("transform",`translate(${-g/2},0)`),h.attr("transform",`translate(${-g/2-r.width/2-(r.x-(r.left??0))}, ${-(r.height/2)-(r.y-(r.top??0))})`),I(t,x),t.intersect=function(b){return A.polygon(t,f,b)},s}$(We,"rect_left_inv_arrow");async function Te(o,t){var D,R;let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let s;t.cssClasses?s="node "+t.cssClasses:s="node default";let r=o.insert("g").attr("class",s).attr("id",t.domId||t.id),h=r.insert("g"),a=r.insert("g").attr("class","label").attr("style",e),c=t.description,n=t.label,l=a.node().appendChild(await ys(n,t.labelStyle,!0,!0)),g={width:0,height:0};if(J((R=(D=Z())==null?void 0:D.flowchart)==null?void 0:R.htmlLabels)){let L=l.children[0],C=Y(l);g=L.getBoundingClientRect(),C.attr("width",g.width),C.attr("height",g.height)}F.info("Text 2",c);let f=c||[],p=l.getBBox(),u=a.node().appendChild(await ys(f.join?f.join("<br/>"):f,t.labelStyle,!0,!0)),y=u.children[0],d=Y(u);g=y.getBoundingClientRect(),d.attr("width",g.width),d.attr("height",g.height);let m=(t.padding||0)/2;Y(u).attr("transform","translate( "+(g.width>p.width?0:(p.width-g.width)/2)+", "+(p.height+m+5)+")"),Y(l).attr("transform","translate( "+(g.width<p.width?0:-(p.width-g.width)/2)+", 0)"),g=a.node().getBBox(),a.attr("transform","translate("+-g.width/2+", "+(-g.height/2-m+3)+")");let x=g.width+(t.padding||0),b=g.height+(t.padding||0),M=-g.width/2-m,w=-g.height/2-m,v,k;if(t.look==="handDrawn"){let L=S.svg(r),C=W(t,{}),E=L.path(ft(M,w,x,b,t.rx||0),C),P=L.line(-g.width/2-m,-g.height/2-m+p.height+m,g.width/2+m,-g.height/2-m+p.height+m,C);k=r.insert(()=>(F.debug("Rough node insert CXC",E),P),":first-child"),v=r.insert(()=>(F.debug("Rough node insert CXC",E),E),":first-child")}else v=h.insert("rect",":first-child"),k=h.insert("line"),v.attr("class","outer title-state").attr("style",e).attr("x",-g.width/2-m).attr("y",-g.height/2-m).attr("width",g.width+(t.padding||0)).attr("height",g.height+(t.padding||0)),k.attr("class","divider").attr("x1",-g.width/2-m).attr("x2",g.width/2+m).attr("y1",-g.height/2-m+p.height+m).attr("y2",-g.height/2-m+p.height+m);return I(t,v),t.intersect=function(L){return A.rect(t,L)},r}$(Te,"rectWithTitle");function Rt(o,t,i,e,s,r,h){let c=(o+i)/2,n=(t+e)/2,l=Math.atan2(e-t,i-o),g=(i-o)/2,f=(e-t)/2,p=g/s,u=f/r,y=Math.sqrt(p**2+u**2);if(y>1)throw new Error("The given radii are too small to create an arc between the points.");let d=Math.sqrt(1-y**2),m=c+d*r*Math.sin(l)*(h?-1:1),x=n-d*s*Math.cos(l)*(h?-1:1),b=Math.atan2((t-x)/r,(o-m)/s),w=Math.atan2((e-x)/r,(i-m)/s)-b;h&&w<0&&(w+=2*Math.PI),!h&&w>0&&(w-=2*Math.PI);let v=[];for(let k=0;k<20;k++){let D=k/19,R=b+D*w,L=m+s*Math.cos(R),C=x+r*Math.sin(R);v.push({x:L,y:C})}return v}$(Rt,"generateArcPoints");async function He(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r}=await G(o,t,z(t)),h=(t==null?void 0:t.padding)??0,a=(t==null?void 0:t.padding)??0,c=(t!=null&&t.width?t==null?void 0:t.width:r.width)+h*2,n=(t!=null&&t.height?t==null?void 0:t.height:r.height)+a*2,l=t.radius||5,g=t.taper||5,{cssStyles:f}=t,p=S.svg(s),u=W(t,{});t.stroke&&(u.stroke=t.stroke),t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=[{x:-c/2+g,y:-n/2},{x:c/2-g,y:-n/2},...Rt(c/2-g,-n/2,c/2,-n/2+g,l,l,!0),{x:c/2,y:-n/2+g},{x:c/2,y:n/2-g},...Rt(c/2,n/2-g,c/2-g,n/2,l,l,!0),{x:c/2-g,y:n/2},{x:-c/2+g,y:n/2},...Rt(-c/2+g,n/2,-c/2,n/2-g,l,l,!0),{x:-c/2,y:n/2-g},{x:-c/2,y:-n/2+g},...Rt(-c/2,-n/2+g,-c/2+g,-n/2,l,l,!0)],d=q(y),m=p.path(d,u),x=s.insert(()=>m,":first-child");return x.attr("class","basic label-container outer-path"),f&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",f),e&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",e),I(t,x),t.intersect=function(b){return A.polygon(t,y,b)},s}$(He,"roundedRect");async function Ie(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,label:h}=await G(o,t,z(t)),a=(t==null?void 0:t.padding)??0,c=Math.max(r.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),n=Math.max(r.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),l=-r.width/2-a,g=-r.height/2-a,{cssStyles:f}=t,p=S.svg(s),u=W(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=[{x:l,y:g},{x:l+c+8,y:g},{x:l+c+8,y:g+n},{x:l-8,y:g+n},{x:l-8,y:g},{x:l,y:g},{x:l,y:g+n}],d=p.polygon(y.map(x=>[x.x,x.y]),u),m=s.insert(()=>d,":first-child");return m.attr("class","basic label-container").attr("style",U(f)),e&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",e),f&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",e),h.attr("transform",`translate(${-c/2+4+(t.padding??0)-(r.x-(r.left??0))},${-n/2+(t.padding??0)-(r.y-(r.top??0))})`),I(t,m),t.intersect=function(x){return A.rect(t,x)},s}$(Ie,"shadedProcess");async function Ee(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,label:h}=await G(o,t,z(t)),a=Math.max(r.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(r.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),n=-a/2,l=-c/2,{cssStyles:g}=t,f=S.svg(s),p=W(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=[{x:n,y:l},{x:n,y:l+c},{x:n+a,y:l+c},{x:n+a,y:l-c/2}],y=q(u),d=f.path(y,p),m=s.insert(()=>d,":first-child");return m.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",g),e&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",e),m.attr("transform",`translate(0, ${c/4})`),h.attr("transform",`translate(${-a/2+(t.padding??0)-(r.x-(r.left??0))}, ${-c/4+(t.padding??0)-(r.y-(r.top??0))})`),I(t,m),t.intersect=function(x){return A.polygon(t,u,x)},s}$(Ee,"slopedRect");async function Oe(o,t){let i={rx:0,ry:0,classes:"",labelPaddingX:t.labelPaddingX??((t==null?void 0:t.padding)||0)*2,labelPaddingY:((t==null?void 0:t.padding)||0)*1};return qt(o,t,i)}$(Oe,"squareRect");async function _e(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r}=await G(o,t,z(t)),h=r.height+t.padding,a=r.width+h/4+t.padding,c=h/2,{cssStyles:n}=t,l=S.svg(s),g=W(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let f=[{x:-a/2+c,y:-h/2},{x:a/2-c,y:-h/2},...At(-a/2+c,0,c,50,90,270),{x:a/2-c,y:h/2},...At(a/2-c,0,c,50,270,450)],p=q(f),u=l.path(p,g),y=s.insert(()=>u,":first-child");return y.attr("class","basic label-container outer-path"),n&&t.look!=="handDrawn"&&y.selectChildren("path").attr("style",n),e&&t.look!=="handDrawn"&&y.selectChildren("path").attr("style",e),I(t,y),t.intersect=function(d){return A.polygon(t,f,d)},s}$(_e,"stadium");async function ze(o,t){return qt(o,t,{rx:5,ry:5,classes:"flowchart-node"})}$(ze,"state");function je(o,t,{config:{themeVariables:i}}){let{labelStyles:e,nodeStyles:s}=H(t);t.labelStyle=e;let{cssStyles:r}=t,{lineColor:h,stateBorder:a,nodeBorder:c}=i,n=o.insert("g").attr("class","node default").attr("id",t.domId||t.id),l=S.svg(n),g=W(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let f=l.circle(0,0,14,{...g,stroke:h,strokeWidth:2}),p=a??c,u=l.circle(0,0,5,{...g,fill:p,stroke:p,strokeWidth:2,fillStyle:"solid"}),y=n.insert(()=>f,":first-child");return y.insert(()=>u),r&&y.selectAll("path").attr("style",r),s&&y.selectAll("path").attr("style",s),I(t,y),t.intersect=function(d){return A.circle(t,7,d)},n}$(je,"stateEnd");function Ge(o,t,{config:{themeVariables:i}}){let{lineColor:e}=i,s=o.insert("g").attr("class","node default").attr("id",t.domId||t.id),r;if(t.look==="handDrawn"){let a=S.svg(s).circle(0,0,14,Ps(e));r=s.insert(()=>a),r.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14)}else r=s.insert("circle",":first-child"),r.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14);return I(t,r),t.intersect=function(h){return A.circle(t,7,h)},s}$(Ge,"stateStart");async function qe(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r}=await G(o,t,z(t)),h=((t==null?void 0:t.padding)||0)/2,a=r.width+t.padding,c=r.height+t.padding,n=-r.width/2-h,l=-r.height/2-h,g=[{x:0,y:0},{x:a,y:0},{x:a,y:-c},{x:0,y:-c},{x:0,y:0},{x:-8,y:0},{x:a+8,y:0},{x:a+8,y:-c},{x:-8,y:-c},{x:-8,y:0}];if(t.look==="handDrawn"){let f=S.svg(s),p=W(t,{}),u=f.rectangle(n-8,l,a+16,c,p),y=f.line(n,l,n,l+c,p),d=f.line(n+a,l,n+a,l+c,p);s.insert(()=>y,":first-child"),s.insert(()=>d,":first-child");let m=s.insert(()=>u,":first-child"),{cssStyles:x}=t;m.attr("class","basic label-container").attr("style",U(x)),I(t,m)}else{let f=ut(s,a,c,g);e&&f.attr("style",e),I(t,f)}return t.intersect=function(f){return A.polygon(t,g,f)},s}$(qe,"subroutine");async function Fe(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r}=await G(o,t,z(t)),h=Math.max(r.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),a=Math.max(r.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=-h/2,n=-a/2,l=.2*a,g=.2*a,{cssStyles:f}=t,p=S.svg(s),u=W(t,{}),y=[{x:c-l/2,y:n},{x:c+h+l/2,y:n},{x:c+h+l/2,y:n+a},{x:c-l/2,y:n+a}],d=[{x:c+h-l/2,y:n+a},{x:c+h+l/2,y:n+a},{x:c+h+l/2,y:n+a-g}];t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let m=q(y),x=p.path(m,u),b=q(d),M=p.path(b,{...u,fillStyle:"solid"}),w=s.insert(()=>M,":first-child");return w.insert(()=>x,":first-child"),w.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",f),e&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",e),I(t,w),t.intersect=function(v){return A.polygon(t,y,v)},s}$(Fe,"taggedRect");async function Xe(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,label:h}=await G(o,t,z(t)),a=Math.max(r.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(r.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),n=c/4,l=.2*a,g=.2*c,f=c+n,{cssStyles:p}=t,u=S.svg(s),y=W(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let d=[{x:-a/2-a/2*.1,y:f/2},...pt(-a/2-a/2*.1,f/2,a/2+a/2*.1,f/2,n,.8),{x:a/2+a/2*.1,y:-f/2},{x:-a/2-a/2*.1,y:-f/2}],m=-a/2+a/2*.1,x=-f/2-g*.4,b=[{x:m+a-l,y:(x+c)*1.4},{x:m+a,y:x+c-g},{x:m+a,y:(x+c)*.9},...pt(m+a,(x+c)*1.3,m+a-l,(x+c)*1.5,-c*.03,.5)],M=q(d),w=u.path(M,y),v=q(b),k=u.path(v,{...y,fillStyle:"solid"}),D=s.insert(()=>k,":first-child");return D.insert(()=>w,":first-child"),D.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&D.selectAll("path").attr("style",p),e&&t.look!=="handDrawn"&&D.selectAll("path").attr("style",e),D.attr("transform",`translate(0,${-n/2})`),h.attr("transform",`translate(${-a/2+(t.padding??0)-(r.x-(r.left??0))},${-c/2+(t.padding??0)-n/2-(r.y-(r.top??0))})`),I(t,D),t.intersect=function(R){return A.polygon(t,d,R)},s}$(Xe,"taggedWaveEdgedRectangle");async function Ye(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r}=await G(o,t,z(t)),h=Math.max(r.width+t.padding,(t==null?void 0:t.width)||0),a=Math.max(r.height+t.padding,(t==null?void 0:t.height)||0),c=-h/2,n=-a/2,l=s.insert("rect",":first-child");return l.attr("class","text").attr("style",e).attr("rx",0).attr("ry",0).attr("x",c).attr("y",n).attr("width",h).attr("height",a),I(t,l),t.intersect=function(g){return A.rect(t,g)},s}$(Ye,"text");var Ia=$((o,t,i,e,s,r)=>`M${o},${t}
    a${s},${r} 0,0,1 0,${-e}
    l${i},0
    a${s},${r} 0,0,1 0,${e}
    M${i},${-e}
    a${s},${r} 0,0,0 0,${e}
    l${-i},0`,"createCylinderPathD"),Ea=$((o,t,i,e,s,r)=>[`M${o},${t}`,`M${o+i},${t}`,`a${s},${r} 0,0,0 0,${-e}`,`l${-i},0`,`a${s},${r} 0,0,0 0,${e}`,`l${i},0`].join(" "),"createOuterCylinderPathD"),Oa=$((o,t,i,e,s,r)=>[`M${o+i/2},${-e/2}`,`a${s},${r} 0,0,0 0,${e}`].join(" "),"createInnerCylinderPathD");async function Ve(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,label:h,halfPadding:a}=await G(o,t,z(t)),c=t.look==="neo"?a*2:a,n=r.height+c,l=n/2,g=l/(2.5+n/50),f=r.width+g+c,{cssStyles:p}=t,u;if(t.look==="handDrawn"){let y=S.svg(s),d=Ea(0,0,f,n,g,l),m=Oa(0,0,f,n,g,l),x=y.path(d,W(t,{})),b=y.path(m,W(t,{fill:"none"}));u=s.insert(()=>b,":first-child"),u=s.insert(()=>x,":first-child"),u.attr("class","basic label-container"),p&&u.attr("style",p)}else{let y=Ia(0,0,f,n,g,l);u=s.insert("path",":first-child").attr("d",y).attr("class","basic label-container").attr("style",U(p)).attr("style",e),u.attr("class","basic label-container"),p&&u.selectAll("path").attr("style",p),e&&u.selectAll("path").attr("style",e)}return u.attr("label-offset-x",g),u.attr("transform",`translate(${-f/2}, ${n/2} )`),h.attr("transform",`translate(${-(r.width/2)-g-(r.x-(r.left??0))}, ${-(r.height/2)-(r.y-(r.top??0))})`),I(t,u),t.intersect=function(y){let d=A.rect(t,y),m=d.y-(t.y??0);if(l!=0&&(Math.abs(m)<(t.height??0)/2||Math.abs(m)==(t.height??0)/2&&Math.abs(d.x-(t.x??0))>(t.width??0)/2-g)){let x=g*g*(1-m*m/(l*l));x!=0&&(x=Math.sqrt(Math.abs(x))),x=g-x,y.x-(t.x??0)>0&&(x=-x),d.x+=x}return d},s}$(Ve,"tiltedCylinder");async function Ze(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r}=await G(o,t,z(t)),h=r.width+t.padding,a=r.height+t.padding,c=[{x:-3*a/6,y:0},{x:h+3*a/6,y:0},{x:h,y:-a},{x:0,y:-a}],n,{cssStyles:l}=t;if(t.look==="handDrawn"){let g=S.svg(s),f=W(t,{}),p=q(c),u=g.path(p,f);n=s.insert(()=>u,":first-child").attr("transform",`translate(${-h/2}, ${a/2})`),l&&n.attr("style",l)}else n=ut(s,h,a,c);return e&&n.attr("style",e),t.width=h,t.height=a,I(t,n),t.intersect=function(g){return A.polygon(t,c,g)},s}$(Ze,"trapezoid");async function Qe(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r}=await G(o,t,z(t)),h=60,a=20,c=Math.max(h,r.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),n=Math.max(a,r.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),{cssStyles:l}=t,g=S.svg(s),f=W(t,{});t.look!=="handDrawn"&&(f.roughness=0,f.fillStyle="solid");let p=[{x:-c/2*.8,y:-n/2},{x:c/2*.8,y:-n/2},{x:c/2,y:-n/2*.6},{x:c/2,y:n/2},{x:-c/2,y:n/2},{x:-c/2,y:-n/2*.6}],u=q(p),y=g.path(u,f),d=s.insert(()=>y,":first-child");return d.attr("class","basic label-container"),l&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",l),e&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",e),I(t,d),t.intersect=function(m){return A.polygon(t,p,m)},s}$(Qe,"trapezoidalPentagon");async function Je(o,t){var x;let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,label:h}=await G(o,t,z(t)),a=J((x=Z().flowchart)==null?void 0:x.htmlLabels),c=r.width+(t.padding??0),n=c+r.height,l=c+r.height,g=[{x:0,y:0},{x:l,y:0},{x:l/2,y:-n}],{cssStyles:f}=t,p=S.svg(s),u=W(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=q(g),d=p.path(y,u),m=s.insert(()=>d,":first-child").attr("transform",`translate(${-n/2}, ${n/2})`);return f&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",f),e&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",e),t.width=c,t.height=n,I(t,m),h.attr("transform",`translate(${-r.width/2-(r.x-(r.left??0))}, ${n/2-(r.height+(t.padding??0)/(a?2:1)-(r.y-(r.top??0)))})`),t.intersect=function(b){return F.info("Triangle intersect",t,g,b),A.polygon(t,g,b)},s}$(Je,"triangle");async function Ke(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,label:h}=await G(o,t,z(t)),a=Math.max(r.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(r.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),n=c/8,l=c+n,{cssStyles:g}=t,p=70-a,u=p>0?p/2:0,y=S.svg(s),d=W(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");let m=[{x:-a/2-u,y:l/2},...pt(-a/2-u,l/2,a/2+u,l/2,n,.8),{x:a/2+u,y:-l/2},{x:-a/2-u,y:-l/2}],x=q(m),b=y.path(x,d),M=s.insert(()=>b,":first-child");return M.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",g),e&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",e),M.attr("transform",`translate(0,${-n/2})`),h.attr("transform",`translate(${-a/2+(t.padding??0)-(r.x-(r.left??0))},${-c/2+(t.padding??0)-n-(r.y-(r.top??0))})`),I(t,M),t.intersect=function(w){return A.polygon(t,m,w)},s}$(Ke,"waveEdgedRectangle");async function Ue(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r}=await G(o,t,z(t)),h=100,a=50,c=Math.max(r.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),n=Math.max(r.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),l=c/n,g=c,f=n;g>f*l?f=g/l:g=f*l,g=Math.max(g,h),f=Math.max(f,a);let p=Math.min(f*.2,f/4),u=f+p*2,{cssStyles:y}=t,d=S.svg(s),m=W(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");let x=[{x:-g/2,y:u/2},...pt(-g/2,u/2,g/2,u/2,p,1),{x:g/2,y:-u/2},...pt(g/2,-u/2,-g/2,-u/2,p,-1)],b=q(x),M=d.path(b,m),w=s.insert(()=>M,":first-child");return w.attr("class","basic label-container"),y&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",y),e&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",e),I(t,w),t.intersect=function(v){return A.polygon(t,x,v)},s}$(Ue,"waveRectangle");async function ta(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,label:h}=await G(o,t,z(t)),a=Math.max(r.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(r.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),n=5,l=-a/2,g=-c/2,{cssStyles:f}=t,p=S.svg(s),u=W(t,{}),y=[{x:l-n,y:g-n},{x:l-n,y:g+c},{x:l+a,y:g+c},{x:l+a,y:g-n}],d=`M${l-n},${g-n} L${l+a},${g-n} L${l+a},${g+c} L${l-n},${g+c} L${l-n},${g-n}
                M${l-n},${g} L${l+a},${g}
                M${l},${g-n} L${l},${g+c}`;t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let m=p.path(d,u),x=s.insert(()=>m,":first-child");return x.attr("transform",`translate(${n/2}, ${n/2})`),x.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",f),e&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",e),h.attr("transform",`translate(${-(r.width/2)+n/2-(r.x-(r.left??0))}, ${-(r.height/2)+n/2-(r.y-(r.top??0))})`),I(t,x),t.intersect=function(b){return A.polygon(t,y,b)},s}$(ta,"windowPane");async function bs(o,t){var Lt,ws,Ss,$s;let i=t;if(i.alias&&(t.label=i.alias),t.look==="handDrawn"){let{themeVariables:X}=dt(),{background:V}=X,et={...t,id:t.id+"-background",look:"default",cssStyles:["stroke: none",`fill: ${V}`]};await bs(o,et)}let e=dt();t.useHtmlLabels=e.htmlLabels;let s=((Lt=e.er)==null?void 0:Lt.diagramPadding)??10,r=((ws=e.er)==null?void 0:ws.entityPadding)??6,{cssStyles:h}=t,{labelStyles:a,nodeStyles:c}=H(t);if(i.attributes.length===0&&t.label){let X={rx:0,ry:0,labelPaddingX:s,labelPaddingY:s*1.5,classes:""};kt(t.label,e)+X.labelPaddingX*2<e.er.minEntityWidth&&(t.width=e.er.minEntityWidth);let V=await qt(o,t,X);if(!J(e.htmlLabels)){let et=V.select("text"),rt=(Ss=et.node())==null?void 0:Ss.getBBox();et.attr("transform",`translate(${-rt.width/2}, 0)`)}return V}e.htmlLabels||(s*=1.25,r*=1.25);let n=z(t);n||(n="node default");let l=o.insert("g").attr("class",n).attr("id",t.domId||t.id),g=await St(l,t.label??"",e,0,0,["name"],a);g.height+=r;let f=0,p=[],u=[],y=0,d=0,m=0,x=0,b=!0,M=!0;for(let X of i.attributes){let V=await St(l,X.type,e,0,f,["attribute-type"],a);y=Math.max(y,V.width+s);let et=await St(l,X.name,e,0,f,["attribute-name"],a);d=Math.max(d,et.width+s);let rt=await St(l,X.keys.join(),e,0,f,["attribute-keys"],a);m=Math.max(m,rt.width+s);let yt=await St(l,X.comment,e,0,f,["attribute-comment"],a);x=Math.max(x,yt.width+s);let ot=Math.max(V.height,et.height,rt.height,yt.height)+r;u.push({yOffset:f,rowHeight:ot}),f+=ot}let w=4;m<=s&&(b=!1,m=0,w--),x<=s&&(M=!1,x=0,w--);let v=l.node().getBBox();if(g.width+s*2-(y+d+m+x)>0){let X=g.width+s*2-(y+d+m+x);y+=X/w,d+=X/w,m>0&&(m+=X/w),x>0&&(x+=X/w)}let k=y+d+m+x,D=S.svg(l),R=W(t,{});t.look!=="handDrawn"&&(R.roughness=0,R.fillStyle="solid");let L=0;u.length>0&&(L=u.reduce((X,V)=>X+((V==null?void 0:V.rowHeight)??0),0));let C=Math.max(v.width+s*2,(t==null?void 0:t.width)||0,k),E=Math.max((L??0)+g.height,(t==null?void 0:t.height)||0),P=-C/2,B=-E/2;l.selectAll("g:not(:first-child)").each((X,V,et)=>{let rt=Y(et[V]),yt=rt.attr("transform"),ot=0,Ms=0;if(yt){let Xt=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(yt);Xt&&(ot=parseFloat(Xt[1]),Ms=parseFloat(Xt[2]),rt.attr("class").includes("attribute-name")?ot+=y:rt.attr("class").includes("attribute-keys")?ot+=y+d:rt.attr("class").includes("attribute-comment")&&(ot+=y+d+m))}rt.attr("transform",`translate(${P+s/2+ot}, ${Ms+B+g.height+r/2})`)}),l.select(".name").attr("transform","translate("+-g.width/2+", "+(B+r/2)+")");let T=D.rectangle(P,B,C,E,R),N=l.insert(()=>T,":first-child").attr("style",h.join("")),{themeVariables:O}=dt(),{rowEven:_,rowOdd:Q,nodeBorder:tt}=O;p.push(0);for(let[X,V]of u.entries()){let rt=(X+1)%2===0&&V.yOffset!==0,yt=D.rectangle(P,g.height+B+(V==null?void 0:V.yOffset),C,V==null?void 0:V.rowHeight,{...R,fill:rt?_:Q,stroke:tt});l.insert(()=>yt,"g.label").attr("style",h.join("")).attr("class",`row-rect-${rt?"even":"odd"}`)}let st=D.line(P,g.height+B,C+P,g.height+B,R);l.insert(()=>st).attr("class","divider"),st=D.line(y+P,g.height+B,y+P,E+B,R),l.insert(()=>st).attr("class","divider"),b&&(st=D.line(y+d+P,g.height+B,y+d+P,E+B,R),l.insert(()=>st).attr("class","divider")),M&&(st=D.line(y+d+m+P,g.height+B,y+d+m+P,E+B,R),l.insert(()=>st).attr("class","divider"));for(let X of p)st=D.line(P,g.height+B+X,C+P,g.height+B+X,R),l.insert(()=>st).attr("class","divider");if(I(t,N),c&&t.look!=="handDrawn"){let X=c.split(";"),V=($s=X==null?void 0:X.filter(et=>et.includes("stroke")))==null?void 0:$s.map(et=>`${et}`).join("; ");l.selectAll("path").attr("style",V??""),l.selectAll(".row-rect-even path").attr("style",c)}return t.intersect=function(X){return A.rect(t,X)},l}$(bs,"erBox");async function St(o,t,i,e=0,s=0,r=[],h=""){let a=o.insert("g").attr("class",`label ${r.join(" ")}`).attr("transform",`translate(${e}, ${s})`).attr("style",h);t!==Yt(t)&&(t=Yt(t),t=t.replaceAll("<","&lt;").replaceAll(">","&gt;"));let c=a.node().appendChild(await ht(a,t,{width:kt(t,i)+100,style:h,useHtmlLabels:i.htmlLabels},i));if(t.includes("&lt;")||t.includes("&gt;")){let l=c.children[0];for(l.textContent=l.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">");l.childNodes[0];)l=l.childNodes[0],l.textContent=l.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">")}let n=c.getBBox();if(J(i.htmlLabels)){let l=c.children[0];l.style.textAlign="start";let g=Y(c);n=l.getBoundingClientRect(),g.attr("width",n.width),g.attr("height",n.height)}return n}$(St,"addText");async function sa(o,t,i,e,s=i.class.padding??12){let r=e?0:3,h=o.insert("g").attr("class",z(t)).attr("id",t.domId||t.id),a=null,c=null,n=null,l=null,g=0,f=0,p=0;if(a=h.insert("g").attr("class","annotation-group text"),t.annotations.length>0){let x=t.annotations[0];await Nt(a,{text:`\xAB${x}\xBB`},0),g=a.node().getBBox().height}c=h.insert("g").attr("class","label-group text"),await Nt(c,t,0,["font-weight: bolder"]);let u=c.node().getBBox();f=u.height,n=h.insert("g").attr("class","members-group text");let y=0;for(let x of t.members){let b=await Nt(n,x,y,[x.parseClassifier()]);y+=b+r}p=n.node().getBBox().height,p<=0&&(p=s/2),l=h.insert("g").attr("class","methods-group text");let d=0;for(let x of t.methods){let b=await Nt(l,x,d,[x.parseClassifier()]);d+=b+r}let m=h.node().getBBox();if(a!==null){let x=a.node().getBBox();a.attr("transform",`translate(${-x.width/2})`)}return c.attr("transform",`translate(${-u.width/2}, ${g})`),m=h.node().getBBox(),n.attr("transform",`translate(0, ${g+f+s*2})`),m=h.node().getBBox(),l.attr("transform",`translate(0, ${g+f+(p?p+s*4:s*2)})`),m=h.node().getBBox(),{shapeSvg:h,bbox:m}}$(sa,"textHelper");async function Nt(o,t,i,e=[]){let s=o.insert("g").attr("class","label").attr("style",e.join("; ")),r=dt(),h="useHtmlLabels"in t?t.useHtmlLabels:J(r.htmlLabels)??!0,a="";"text"in t?a=t.text:a=t.label,!h&&a.startsWith("\\")&&(a=a.substring(1)),Vt(a)&&(h=!0);let c=await ht(s,Zt(xt(a)),{width:kt(a,r)+50,classes:"markdown-node-label",useHtmlLabels:h},r),n,l=1;if(h){let g=c.children[0],f=Y(c);l=g.innerHTML.split("<br>").length,g.innerHTML.includes("</math>")&&(l+=g.innerHTML.split("<mrow>").length-1);let p=g.getElementsByTagName("img");if(p){let u=a.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...p].map(y=>new Promise(d=>{function m(){var x;if(y.style.display="flex",y.style.flexDirection="column",u){let b=((x=r.fontSize)==null?void 0:x.toString())??window.getComputedStyle(document.body).fontSize,w=parseInt(b,10)*5+"px";y.style.minWidth=w,y.style.maxWidth=w}else y.style.width="100%";d(y)}$(m,"setupImage"),setTimeout(()=>{y.complete&&m()}),y.addEventListener("error",m),y.addEventListener("load",m)})))}n=g.getBoundingClientRect(),f.attr("width",n.width),f.attr("height",n.height)}else{e.includes("font-weight: bolder")&&Y(c).selectAll("tspan").attr("font-weight",""),l=c.children.length;let g=c.children[0];(c.textContent===""||c.textContent.includes("&gt"))&&(g.textContent=a[0]+a.substring(1).replaceAll("&gt;",">").replaceAll("&lt;","<").trim(),a[1]===" "&&(g.textContent=g.textContent[0]+" "+g.textContent.substring(1))),g.textContent==="undefined"&&(g.textContent=""),n=c.getBBox()}return s.attr("transform","translate(0,"+(-n.height/(2*l)+i)+")"),n.height}$(Nt,"addText");async function ea(o,t){var R,L;let i=Z(),e=i.class.padding??12,s=e,r=t.useHtmlLabels??J(i.htmlLabels)??!0,h=t;h.annotations=h.annotations??[],h.members=h.members??[],h.methods=h.methods??[];let{shapeSvg:a,bbox:c}=await sa(o,t,i,r,s),{labelStyles:n,nodeStyles:l}=H(t);t.labelStyle=n,t.cssStyles=h.styles||"";let g=((R=h.styles)==null?void 0:R.join(";"))||l||"";t.cssStyles||(t.cssStyles=g.replaceAll("!important","").split(";"));let f=h.members.length===0&&h.methods.length===0&&!((L=i.class)!=null&&L.hideEmptyMembersBox),p=S.svg(a),u=W(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=c.width,d=c.height;h.members.length===0&&h.methods.length===0?d+=s:h.members.length>0&&h.methods.length===0&&(d+=s*2);let m=-y/2,x=-d/2,b=p.rectangle(m-e,x-e-(f?e:h.members.length===0&&h.methods.length===0?-e/2:0),y+2*e,d+2*e+(f?e*2:h.members.length===0&&h.methods.length===0?-e:0),u),M=a.insert(()=>b,":first-child");M.attr("class","basic label-container");let w=M.node().getBBox();a.selectAll(".text").each((C,E,P)=>{var Q;let B=Y(P[E]),T=B.attr("transform"),N=0;if(T){let st=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(T);st&&(N=parseFloat(st[2]))}let O=N+x+e-(f?e:h.members.length===0&&h.methods.length===0?-e/2:0);r||(O-=4);let _=m;(B.attr("class").includes("label-group")||B.attr("class").includes("annotation-group"))&&(_=-((Q=B.node())==null?void 0:Q.getBBox().width)/2||0,a.selectAll("text").each(function(tt,st,Lt){window.getComputedStyle(Lt[st]).textAnchor==="middle"&&(_=0)})),B.attr("transform",`translate(${_}, ${O})`)});let v=a.select(".annotation-group").node().getBBox().height-(f?e/2:0)||0,k=a.select(".label-group").node().getBBox().height-(f?e/2:0)||0,D=a.select(".members-group").node().getBBox().height-(f?e/2:0)||0;if(h.members.length>0||h.methods.length>0||f){let C=p.line(w.x,v+k+x+e,w.x+w.width,v+k+x+e,u);a.insert(()=>C).attr("class","divider").attr("style",g)}if(f||h.members.length>0||h.methods.length>0){let C=p.line(w.x,v+k+D+x+s*2+e,w.x+w.width,v+k+D+x+e+s*2,u);a.insert(()=>C).attr("class","divider").attr("style",g)}if(h.look!=="handDrawn"&&a.selectAll("path").attr("style",g),M.select(":nth-child(2)").attr("style",g),a.selectAll(".divider").select("path").attr("style",g),t.labelStyle?a.selectAll("span").attr("style",t.labelStyle):a.selectAll("span").attr("style",g),!r){let C=RegExp(/color\s*:\s*([^;]*)/),E=C.exec(g);if(E){let P=E[0].replace("color","fill");a.selectAll("tspan").attr("style",P)}else if(n){let P=C.exec(n);if(P){let B=P[0].replace("color","fill");a.selectAll("tspan").attr("style",B)}}}return I(t,M),t.intersect=function(C){return A.rect(t,C)},a}$(ea,"classBox");async function aa(o,t){var v,k;let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let s=t,r=t,h=20,a=20,c="verifyMethod"in t,n=z(t),l=o.insert("g").attr("class",n).attr("id",t.domId??t.id),g;c?g=await nt(l,`&lt;&lt;${s.type}&gt;&gt;`,0,t.labelStyle):g=await nt(l,"&lt;&lt;Element&gt;&gt;",0,t.labelStyle);let f=g,p=await nt(l,s.name,f,t.labelStyle+"; font-weight: bold;");if(f+=p+a,c){let D=await nt(l,`${s.requirementId?`ID: ${s.requirementId}`:""}`,f,t.labelStyle);f+=D;let R=await nt(l,`${s.text?`Text: ${s.text}`:""}`,f,t.labelStyle);f+=R;let L=await nt(l,`${s.risk?`Risk: ${s.risk}`:""}`,f,t.labelStyle);f+=L,await nt(l,`${s.verifyMethod?`Verification: ${s.verifyMethod}`:""}`,f,t.labelStyle)}else{let D=await nt(l,`${r.type?`Type: ${r.type}`:""}`,f,t.labelStyle);f+=D,await nt(l,`${r.docRef?`Doc Ref: ${r.docRef}`:""}`,f,t.labelStyle)}let u=(((v=l.node())==null?void 0:v.getBBox().width)??200)+h,y=(((k=l.node())==null?void 0:k.getBBox().height)??200)+h,d=-u/2,m=-y/2,x=S.svg(l),b=W(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");let M=x.rectangle(d,m,u,y,b),w=l.insert(()=>M,":first-child");if(w.attr("class","basic label-container").attr("style",e),l.selectAll(".label").each((D,R,L)=>{let C=Y(L[R]),E=C.attr("transform"),P=0,B=0;if(E){let _=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(E);_&&(P=parseFloat(_[1]),B=parseFloat(_[2]))}let T=B-y/2,N=d+h/2;(R===0||R===1)&&(N=P),C.attr("transform",`translate(${N}, ${T+h})`)}),f>g+p+a){let D=x.line(d,m+g+p+a,d+u,m+g+p+a,b);l.insert(()=>D).attr("style",e)}return I(t,w),t.intersect=function(D){return A.rect(t,D)},l}$(aa,"requirementBox");async function nt(o,t,i,e=""){if(t==="")return 0;let s=o.insert("g").attr("class","label").attr("style",e),r=Z(),h=r.htmlLabels??!0,a=await ht(s,Zt(xt(t)),{width:kt(t,r)+50,classes:"markdown-node-label",useHtmlLabels:h,style:e},r),c;if(h){let n=a.children[0],l=Y(a);c=n.getBoundingClientRect(),l.attr("width",c.width),l.attr("height",c.height)}else{let n=a.children[0];for(let l of n.children)l.textContent=l.textContent.replaceAll("&gt;",">").replaceAll("&lt;","<"),e&&l.setAttribute("style",e);c=a.getBBox(),c.height+=6}return s.attr("transform",`translate(${-c.width/2},${-c.height/2+i})`),c.height}$(nt,"addText");var _a=$(o=>{switch(o){case"Very High":return"red";case"High":return"orange";case"Medium":return null;case"Low":return"blue";case"Very Low":return"lightblue"}},"colorFromPriority");async function ra(o,t,{config:i}){var E,P;let{labelStyles:e,nodeStyles:s}=H(t);t.labelStyle=e||"";let r=10,h=t.width;t.width=(t.width??200)-10;let{shapeSvg:a,bbox:c,label:n}=await G(o,t,z(t)),l=t.padding||10,g="",f;"ticket"in t&&t.ticket&&((E=i==null?void 0:i.kanban)!=null&&E.ticketBaseUrl)&&(g=(P=i==null?void 0:i.kanban)==null?void 0:P.ticketBaseUrl.replace("#TICKET#",t.ticket),f=a.insert("svg:a",":first-child").attr("class","kanban-ticket-link").attr("xlink:href",g).attr("target","_blank"));let p={useHtmlLabels:t.useHtmlLabels,labelStyle:t.labelStyle||"",width:t.width,img:t.img,padding:t.padding||8,centerLabel:!1},u,y;f?{label:u,bbox:y}=await us(f,"ticket"in t&&t.ticket||"",p):{label:u,bbox:y}=await us(a,"ticket"in t&&t.ticket||"",p);let{label:d,bbox:m}=await us(a,"assigned"in t&&t.assigned||"",p);t.width=h;let x=10,b=(t==null?void 0:t.width)||0,M=Math.max(y.height,m.height)/2,w=Math.max(c.height+x*2,(t==null?void 0:t.height)||0)+M,v=-b/2,k=-w/2;n.attr("transform","translate("+(l-b/2)+", "+(-M-c.height/2)+")"),u.attr("transform","translate("+(l-b/2)+", "+(-M+c.height/2)+")"),d.attr("transform","translate("+(l+b/2-m.width-2*r)+", "+(-M+c.height/2)+")");let D,{rx:R,ry:L}=t,{cssStyles:C}=t;if(t.look==="handDrawn"){let B=S.svg(a),T=W(t,{}),N=R||L?B.path(ft(v,k,b,w,R||0),T):B.rectangle(v,k,b,w,T);D=a.insert(()=>N,":first-child"),D.attr("class","basic label-container").attr("style",C||null)}else{D=a.insert("rect",":first-child"),D.attr("class","basic label-container __APA__").attr("style",s).attr("rx",R??5).attr("ry",L??5).attr("x",v).attr("y",k).attr("width",b).attr("height",w);let B="priority"in t&&t.priority;if(B){let T=a.append("line"),N=v+2,O=k+Math.floor((R??0)/2),_=k+w-Math.floor((R??0)/2);T.attr("x1",N).attr("y1",O).attr("x2",N).attr("y2",_).attr("stroke-width","4").attr("stroke",_a(B))}}return I(t,D),t.height=w,t.intersect=function(B){return A.rect(t,B)},a}$(ra,"kanbanItem");async function ia(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,halfPadding:h,label:a}=await G(o,t,z(t)),c=r.width+10*h,n=r.height+8*h,l=.15*c,{cssStyles:g}=t,f=r.width+20,p=r.height+20,u=Math.max(c,f),y=Math.max(n,p);a.attr("transform",`translate(${-r.width/2}, ${-r.height/2})`);let d,m=`M0 0 
    a${l},${l} 1 0,0 ${u*.25},${-1*y*.1}
    a${l},${l} 1 0,0 ${u*.25},0
    a${l},${l} 1 0,0 ${u*.25},0
    a${l},${l} 1 0,0 ${u*.25},${y*.1}

    a${l},${l} 1 0,0 ${u*.15},${y*.33}
    a${l*.8},${l*.8} 1 0,0 0,${y*.34}
    a${l},${l} 1 0,0 ${-1*u*.15},${y*.33}

    a${l},${l} 1 0,0 ${-1*u*.25},${y*.15}
    a${l},${l} 1 0,0 ${-1*u*.25},0
    a${l},${l} 1 0,0 ${-1*u*.25},0
    a${l},${l} 1 0,0 ${-1*u*.25},${-1*y*.15}

    a${l},${l} 1 0,0 ${-1*u*.1},${-1*y*.33}
    a${l*.8},${l*.8} 1 0,0 0,${-1*y*.34}
    a${l},${l} 1 0,0 ${u*.1},${-1*y*.33}
  H0 V0 Z`;if(t.look==="handDrawn"){let x=S.svg(s),b=W(t,{}),M=x.path(m,b);d=s.insert(()=>M,":first-child"),d.attr("class","basic label-container").attr("style",U(g))}else d=s.insert("path",":first-child").attr("class","basic label-container").attr("style",e).attr("d",m);return d.attr("transform",`translate(${-u/2}, ${-y/2})`),I(t,d),t.calcIntersect=function(x,b){return A.rect(x,b)},t.intersect=function(x){return F.info("Bang intersect",t,x),A.rect(t,x)},s}$(ia,"bang");async function na(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,halfPadding:h,label:a}=await G(o,t,z(t)),c=r.width+2*h,n=r.height+2*h,l=.15*c,g=.25*c,f=.35*c,p=.2*c,{cssStyles:u}=t,y,d=`M0 0 
    a${l},${l} 0 0,1 ${c*.25},${-1*c*.1}
    a${f},${f} 1 0,1 ${c*.4},${-1*c*.1}
    a${g},${g} 1 0,1 ${c*.35},${c*.2}

    a${l},${l} 1 0,1 ${c*.15},${n*.35}
    a${p},${p} 1 0,1 ${-1*c*.15},${n*.65}

    a${g},${l} 1 0,1 ${-1*c*.25},${c*.15}
    a${f},${f} 1 0,1 ${-1*c*.5},0
    a${l},${l} 1 0,1 ${-1*c*.25},${-1*c*.15}

    a${l},${l} 1 0,1 ${-1*c*.1},${-1*n*.35}
    a${p},${p} 1 0,1 ${c*.1},${-1*n*.65}
  H0 V0 Z`;if(t.look==="handDrawn"){let m=S.svg(s),x=W(t,{}),b=m.path(d,x);y=s.insert(()=>b,":first-child"),y.attr("class","basic label-container").attr("style",U(u))}else y=s.insert("path",":first-child").attr("class","basic label-container").attr("style",e).attr("d",d);return a.attr("transform",`translate(${-r.width/2}, ${-r.height/2})`),y.attr("transform",`translate(${-c/2}, ${-n/2})`),I(t,y),t.calcIntersect=function(m,x){return A.rect(m,x)},t.intersect=function(m){return F.info("Cloud intersect",t,m),A.rect(t,m)},s}$(na,"cloud");async function la(o,t){let{labelStyles:i,nodeStyles:e}=H(t);t.labelStyle=i;let{shapeSvg:s,bbox:r,halfPadding:h,label:a}=await G(o,t,z(t)),c=r.width+8*h,n=r.height+2*h,l=5,g=`
    M${-c/2} ${n/2-l}
    v${-n+2*l}
    q0,-${l} ${l},-${l}
    h${c-2*l}
    q${l},0 ${l},${l}
    v${n-2*l}
    q0,${l} -${l},${l}
    h${-c+2*l}
    q-${l},0 -${l},-${l}
    Z
  `,f=s.append("path").attr("id","node-"+t.id).attr("class","node-bkg node-"+t.type).attr("style",e).attr("d",g);return s.append("line").attr("class","node-line-").attr("x1",-c/2).attr("y1",n/2).attr("x2",c/2).attr("y2",n/2),a.attr("transform",`translate(${-r.width/2}, ${-r.height/2})`),s.append(()=>a.node()),I(t,f),t.calcIntersect=function(p,u){return A.rect(p,u)},t.intersect=function(p){return A.rect(t,p)},s}$(la,"defaultMindmapNode");async function ca(o,t){let i={padding:t.padding??0};return xs(o,t,i)}$(ca,"mindmapCircle");var za=[{semanticName:"Process",name:"Rectangle",shortName:"rect",description:"Standard process shape",aliases:["proc","process","rectangle"],internalAliases:["squareRect"],handler:Oe},{semanticName:"Event",name:"Rounded Rectangle",shortName:"rounded",description:"Represents an event",aliases:["event"],internalAliases:["roundedRect"],handler:He},{semanticName:"Terminal Point",name:"Stadium",shortName:"stadium",description:"Terminal point",aliases:["terminal","pill"],handler:_e},{semanticName:"Subprocess",name:"Framed Rectangle",shortName:"fr-rect",description:"Subprocess",aliases:["subprocess","subproc","framed-rectangle","subroutine"],handler:qe},{semanticName:"Database",name:"Cylinder",shortName:"cyl",description:"Database storage",aliases:["db","database","cylinder"],handler:oe},{semanticName:"Start",name:"Circle",shortName:"circle",description:"Starting point",aliases:["circ"],handler:xs},{semanticName:"Bang",name:"Bang",shortName:"bang",description:"Bang",aliases:["bang"],handler:ia},{semanticName:"Cloud",name:"Cloud",shortName:"cloud",description:"cloud",aliases:["cloud"],handler:na},{semanticName:"Decision",name:"Diamond",shortName:"diam",description:"Decision-making step",aliases:["decision","diamond","question"],handler:Le},{semanticName:"Prepare Conditional",name:"Hexagon",shortName:"hex",description:"Preparation or condition step",aliases:["hexagon","prepare"],handler:me},{semanticName:"Data Input/Output",name:"Lean Right",shortName:"lean-r",description:"Represents input or output",aliases:["lean-right","in-out"],internalAliases:["lean_right"],handler:De},{semanticName:"Data Input/Output",name:"Lean Left",shortName:"lean-l",description:"Represents output or input",aliases:["lean-left","out-in"],internalAliases:["lean_left"],handler:ve},{semanticName:"Priority Action",name:"Trapezoid Base Bottom",shortName:"trap-b",description:"Priority action",aliases:["priority","trapezoid-bottom","trapezoid"],handler:Ze},{semanticName:"Manual Operation",name:"Trapezoid Base Top",shortName:"trap-t",description:"Represents a manual task",aliases:["manual","trapezoid-top","inv-trapezoid"],internalAliases:["inv_trapezoid"],handler:Me},{semanticName:"Stop",name:"Double Circle",shortName:"dbl-circ",description:"Represents a stop point",aliases:["double-circle"],internalAliases:["doublecircle"],handler:ge},{semanticName:"Text Block",name:"Text Block",shortName:"text",description:"Text block",handler:Ye},{semanticName:"Card",name:"Notched Rectangle",shortName:"notch-rect",description:"Represents a card",aliases:["card","notched-rectangle"],handler:se},{semanticName:"Lined/Shaded Process",name:"Lined Rectangle",shortName:"lin-rect",description:"Lined process shape",aliases:["lined-rectangle","lined-process","lin-proc","shaded-process"],handler:Ie},{semanticName:"Start",name:"Small Circle",shortName:"sm-circ",description:"Small starting point",aliases:["start","small-circle"],internalAliases:["stateStart"],handler:Ge},{semanticName:"Stop",name:"Framed Circle",shortName:"fr-circ",description:"Stop point",aliases:["stop","framed-circle"],internalAliases:["stateEnd"],handler:je},{semanticName:"Fork/Join",name:"Filled Rectangle",shortName:"fork",description:"Fork or join in process flow",aliases:["join"],internalAliases:["forkJoin"],handler:ue},{semanticName:"Collate",name:"Hourglass",shortName:"hourglass",description:"Represents a collate operation",aliases:["hourglass","collate"],handler:de},{semanticName:"Comment",name:"Curly Brace",shortName:"brace",description:"Adds a comment",aliases:["comment","brace-l"],handler:ie},{semanticName:"Comment Right",name:"Curly Brace",shortName:"brace-r",description:"Adds a comment",handler:ne},{semanticName:"Comment with braces on both sides",name:"Curly Braces",shortName:"braces",description:"Adds a comment",handler:le},{semanticName:"Com Link",name:"Lightning Bolt",shortName:"bolt",description:"Communication link",aliases:["com-link","lightning-bolt"],handler:Pe},{semanticName:"Document",name:"Document",shortName:"doc",description:"Represents a document",aliases:["doc","document"],handler:Ke},{semanticName:"Delay",name:"Half-Rounded Rectangle",shortName:"delay",description:"Represents a delay",aliases:["half-rounded-rectangle"],handler:ye},{semanticName:"Direct Access Storage",name:"Horizontal Cylinder",shortName:"h-cyl",description:"Direct access storage",aliases:["das","horizontal-cylinder"],handler:Ve},{semanticName:"Disk Storage",name:"Lined Cylinder",shortName:"lin-cyl",description:"Disk storage",aliases:["disk","lined-cylinder"],handler:Be},{semanticName:"Display",name:"Curved Trapezoid",shortName:"curv-trap",description:"Represents a display",aliases:["curved-trapezoid","display"],handler:ce},{semanticName:"Divided Process",name:"Divided Rectangle",shortName:"div-rect",description:"Divided process shape",aliases:["div-proc","divided-rectangle","divided-process"],handler:he},{semanticName:"Extract",name:"Triangle",shortName:"tri",description:"Extraction process",aliases:["extract","triangle"],handler:Je},{semanticName:"Internal Storage",name:"Window Pane",shortName:"win-pane",description:"Internal storage",aliases:["internal-storage","window-pane"],handler:ta},{semanticName:"Junction",name:"Filled Circle",shortName:"f-circ",description:"Junction point",aliases:["junction","filled-circle"],handler:pe},{semanticName:"Loop Limit",name:"Trapezoidal Pentagon",shortName:"notch-pent",description:"Loop limit step",aliases:["loop-limit","notched-pentagon"],handler:Qe},{semanticName:"Manual File",name:"Flipped Triangle",shortName:"flip-tri",description:"Manual file operation",aliases:["manual-file","flipped-triangle"],handler:fe},{semanticName:"Manual Input",name:"Sloped Rectangle",shortName:"sl-rect",description:"Manual input step",aliases:["manual-input","sloped-rectangle"],handler:Ee},{semanticName:"Multi-Document",name:"Stacked Document",shortName:"docs",description:"Multiple documents",aliases:["documents","st-doc","stacked-document"],handler:Ne},{semanticName:"Multi-Process",name:"Stacked Rectangle",shortName:"st-rect",description:"Multiple processes",aliases:["procs","processes","stacked-rectangle"],handler:Re},{semanticName:"Stored Data",name:"Bow Tie Rectangle",shortName:"bow-rect",description:"Stored data",aliases:["stored-data","bow-tie-rectangle"],handler:te},{semanticName:"Summary",name:"Crossed Circle",shortName:"cross-circ",description:"Summary",aliases:["summary","crossed-circle"],handler:re},{semanticName:"Tagged Document",name:"Tagged Document",shortName:"tag-doc",description:"Tagged document",aliases:["tag-doc","tagged-document"],handler:Xe},{semanticName:"Tagged Process",name:"Tagged Rectangle",shortName:"tag-rect",description:"Tagged process",aliases:["tagged-rectangle","tag-proc","tagged-process"],handler:Fe},{semanticName:"Paper Tape",name:"Flag",shortName:"flag",description:"Paper tape",aliases:["paper-tape"],handler:Ue},{semanticName:"Odd",name:"Odd",shortName:"odd",description:"Odd shape",internalAliases:["rect_left_inv_arrow"],handler:We},{semanticName:"Lined Document",name:"Lined Document",shortName:"lin-doc",description:"Lined document",aliases:["lined-document"],handler:Ce}],ja=$(()=>{let t=[...Object.entries({state:ze,choice:ee,note:Ae,rectWithTitle:Te,labelRect:ke,iconSquare:Se,iconCircle:be,icon:xe,iconRounded:we,imageSquare:$e,anchor:Us,kanbanItem:ra,mindmapCircle:ca,defaultMindmapNode:la,classBox:ea,erBox:bs,requirementBox:aa}),...za.flatMap(i=>[i.shortName,..."aliases"in i?i.aliases:[],..."internalAliases"in i?i.internalAliases:[]].map(s=>[s,i.handler]))];return Object.fromEntries(t)},"generateShapeMap"),oa=ja();function Ga(o){return o in oa}$(Ga,"isValidShape");var Ft=new Map;async function qa(o,t,i){let e,s;t.shape==="rect"&&(t.rx&&t.ry?t.shape="roundedRect":t.shape="squareRect");let r=t.shape?oa[t.shape]:void 0;if(!r)throw new Error(`No such shape: ${t.shape}. Please check your syntax.`);if(t.link){let h;i.config.securityLevel==="sandbox"?h="_top":t.linkTarget&&(h=t.linkTarget||"_blank"),e=o.insert("svg:a").attr("xlink:href",t.link).attr("target",h??null),s=await r(e,t,i)}else s=await r(o,t,i),e=s;return t.tooltip&&s.attr("title",t.tooltip),Ft.set(t.id,e),t.haveCallback&&e.attr("class",e.attr("class")+" clickable"),e}$(qa,"insertNode");var yi=$((o,t)=>{Ft.set(t.id,o)},"setNodeElem"),mi=$(()=>{Ft.clear()},"clear"),di=$(o=>{let t=Ft.get(o.id);F.trace("Transforming node",o.diff,o,"translate("+(o.x-o.width/2-5)+", "+o.width/2+")");let i=8,e=o.diff||0;return o.clusterNode?t.attr("transform","translate("+(o.x+e-o.width/2)+", "+(o.y-o.height/2-i)+")"):t.attr("transform","translate("+o.x+", "+o.y+")"),e},"positionNode");export{S as a,G as b,I as c,ys as d,ar as e,rr as f,Ga as g,qa as h,yi as i,mi as j,di as k};
